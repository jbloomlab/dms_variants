<!DOCTYPE html>

<html lang="en" data-content_root="./">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Compute probabilities of escape &#8212; dms_variants 1.5.0 documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="_static/alabaster.css?v=420b4293" />
    <link rel="stylesheet" type="text/css" href="_static/plot_directive.css?v=7f9a90b1" />
    <link rel="stylesheet" type="text/css" href="_static/nbsphinx-code-cells.css" />
    <script src="_static/documentation_options.js?v=e0a75244"></script>
    <script src="_static/doctools.js?v=888ff710"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Parse barcodes" href="parsebarcodes_sim_data.html" />
    <link rel="prev" title="Libraries with secondary target genes" href="codonvariant_sim_data_multi_targets.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  

  
  

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="Compute-probabilities-of-escape">
<h1>Compute probabilities of escape<a class="headerlink" href="#Compute-probabilities-of-escape" title="Link to this heading">¶</a></h1>
<p>In some experiments that involve antibody selections, it is possible to spike in a “neutralization standard”, which is a set of variants known not to be affected by the antibody. In such cases, it is then possible to compute the probability of escape of each variant, which is just its change in frequency relative to the standard. For instance, if such experiments are done at enough concentrations, it is even possible to reconstruct a conventional neutralization curve.</p>
<p>This notebook illustrates how to use <code class="docutils literal notranslate"><span class="pre">dms_variants</span></code> to compute these probabilities of escape:</p>
<p>First, import Python modules:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">io</span>
<span class="kn">import</span> <span class="nn">textwrap</span>

<span class="kn">import</span> <span class="nn">altair</span> <span class="k">as</span> <span class="nn">alt</span>

<span class="kn">import</span> <span class="nn">dms_variants.codonvarianttable</span>
<span class="kn">import</span> <span class="nn">dms_variants.utils</span>

<span class="kn">import</span> <span class="nn">numpy</span>

<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
</pre></div>
</div>
</div>
<section id="Compute-escape-probabilities">
<h2>Compute escape probabilities<a class="headerlink" href="#Compute-escape-probabilities" title="Link to this heading">¶</a></h2>
<p>Read in the <code class="docutils literal notranslate"><span class="pre">CodonVariantTable</span></code>. These data correspond to snippets of the variant counts from a real experiment on the SARS-CoV-2 spike:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;spike.txt&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">spike_seq</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>

<span class="n">variants</span> <span class="o">=</span> <span class="n">dms_variants</span><span class="o">.</span><span class="n">codonvarianttable</span><span class="o">.</span><span class="n">CodonVariantTable</span><span class="o">.</span><span class="n">from_variant_count_df</span><span class="p">(</span>
    <span class="n">variant_count_df_file</span><span class="o">=</span><span class="s2">&quot;prob_escape_codon_variant_table.csv&quot;</span><span class="p">,</span>
    <span class="n">primary_target</span><span class="o">=</span><span class="s2">&quot;spike&quot;</span><span class="p">,</span>
    <span class="n">geneseq</span><span class="o">=</span><span class="n">spike_seq</span><span class="p">,</span>
    <span class="n">allowgaps</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<p>Set up a data frame giving the antibody / no-antibody sample pairings for each selection:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">selections_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span>
    <span class="n">io</span><span class="o">.</span><span class="n">StringIO</span><span class="p">(</span>
        <span class="n">textwrap</span><span class="o">.</span><span class="n">dedent</span><span class="p">(</span>
<span class="w">            </span><span class="sd">&quot;&quot;&quot;\</span>
<span class="sd">    library,antibody_sample,no-antibody_sample,antibody_concentration</span>
<span class="sd">    lib1,thaw-1_REGN10933_0.037_1,thaw-1_no-antibody_control_1,0.037</span>
<span class="sd">    lib1,thaw-1_REGN10933_0.15_1,thaw-1_no-antibody_control_1,0.15</span>
<span class="sd">    lib1,thaw-1_REGN10933_0.15_2,thaw-1_no-antibody_control_2,0.15</span>
<span class="sd">    lib1,thaw-1_REGN10933_0.59_1,thaw-1_no-antibody_control_1,0.59</span>
<span class="sd">    lib1,thaw-1_REGN10933_0.59_2,thaw-1_no-antibody_control_2,0.59</span>
<span class="sd">    lib1,thaw-2_279C_0.00088_1,thaw-2_no-antibody_control_1,0.00088</span>
<span class="sd">    lib1,thaw-2_279C_0.00088_2,thaw-2_no-antibody_control_2,0.00088</span>
<span class="sd">    lib1,thaw-2_279C_0.0035_1,thaw-2_no-antibody_control_1,0.0035</span>
<span class="sd">    lib1,thaw-2_279C_0.0035_2,thaw-2_no-antibody_control_2,0.0035</span>
<span class="sd">    lib1,thaw-2_279C_0.014_1,thaw-2_no-antibody_control_1,0.014</span>
<span class="sd">    lib1,thaw-2_279C_0.014_2,thaw-2_no-antibody_control_2,0.014</span>
<span class="sd">    lib2,thaw-1_REGN10933_0.037_1,thaw-1_no-antibody_control_1,0.037</span>
<span class="sd">    lib2,thaw-1_REGN10933_0.037_2,thaw-1_no-antibody_control_2,0.037</span>
<span class="sd">    lib2,thaw-1_REGN10933_0.15_1,thaw-1_no-antibody_control_1,0.15</span>
<span class="sd">    lib2,thaw-1_REGN10933_0.15_2,thaw-1_no-antibody_control_2,0.15</span>
<span class="sd">    lib2,thaw-1_REGN10933_0.59_1,thaw-1_no-antibody_control_1,0.59</span>
<span class="sd">    lib2,thaw-1_REGN10933_0.59_2,thaw-1_no-antibody_control_2,0.59</span>
<span class="sd">    &quot;&quot;&quot;</span>
        <span class="p">)</span>
    <span class="p">)</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<p>Now run <code class="docutils literal notranslate"><span class="pre">CodonVariantTable.prob_escape</span></code> using the above data frame to define which samples to pair in the comparisons:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">prob_escape</span><span class="p">,</span> <span class="n">neut_standard_fracs</span><span class="p">,</span> <span class="n">neutralization</span> <span class="o">=</span> <span class="n">variants</span><span class="o">.</span><span class="n">prob_escape</span><span class="p">(</span>
    <span class="n">selections_df</span><span class="o">=</span><span class="n">selections_df</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</section>
<section id="Fraction-of-reads-that-are-neutralization-standard">
<h2>Fraction of reads that are neutralization standard<a class="headerlink" href="#Fraction-of-reads-that-are-neutralization-standard" title="Link to this heading">¶</a></h2>
<p>First look at the returned <code class="docutils literal notranslate"><span class="pre">neut_standard_fracs</span></code> data frame, which gives the fraction of all reads corresponding to the neutralization standard for all samples:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">neut_standard_fracs</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>library</th>
      <th>antibody_sample</th>
      <th>no-antibody_sample</th>
      <th>antibody_concentration</th>
      <th>antibody_count</th>
      <th>antibody_frac</th>
      <th>no-antibody_count</th>
      <th>no-antibody_frac</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>lib1</td>
      <td>thaw-1_REGN10933_0.037_1</td>
      <td>thaw-1_no-antibody_control_1</td>
      <td>0.0370</td>
      <td>11107</td>
      <td>0.0210</td>
      <td>16475</td>
      <td>0.0098</td>
    </tr>
    <tr>
      <th>1</th>
      <td>lib1</td>
      <td>thaw-1_REGN10933_0.15_1</td>
      <td>thaw-1_no-antibody_control_1</td>
      <td>0.1500</td>
      <td>18045</td>
      <td>0.0220</td>
      <td>16475</td>
      <td>0.0098</td>
    </tr>
    <tr>
      <th>2</th>
      <td>lib1</td>
      <td>thaw-1_REGN10933_0.15_2</td>
      <td>thaw-1_no-antibody_control_2</td>
      <td>0.1500</td>
      <td>14283</td>
      <td>0.0371</td>
      <td>11343</td>
      <td>0.0103</td>
    </tr>
    <tr>
      <th>3</th>
      <td>lib1</td>
      <td>thaw-1_REGN10933_0.59_1</td>
      <td>thaw-1_no-antibody_control_1</td>
      <td>0.5900</td>
      <td>26027</td>
      <td>0.0636</td>
      <td>16475</td>
      <td>0.0098</td>
    </tr>
    <tr>
      <th>4</th>
      <td>lib1</td>
      <td>thaw-1_REGN10933_0.59_2</td>
      <td>thaw-1_no-antibody_control_2</td>
      <td>0.5900</td>
      <td>23240</td>
      <td>0.0510</td>
      <td>11343</td>
      <td>0.0103</td>
    </tr>
    <tr>
      <th>5</th>
      <td>lib1</td>
      <td>thaw-2_279C_0.00088_1</td>
      <td>thaw-2_no-antibody_control_1</td>
      <td>0.0009</td>
      <td>8231</td>
      <td>0.0157</td>
      <td>11134</td>
      <td>0.0157</td>
    </tr>
    <tr>
      <th>6</th>
      <td>lib1</td>
      <td>thaw-2_279C_0.00088_2</td>
      <td>thaw-2_no-antibody_control_2</td>
      <td>0.0009</td>
      <td>8763</td>
      <td>0.0177</td>
      <td>9002</td>
      <td>0.0147</td>
    </tr>
    <tr>
      <th>7</th>
      <td>lib1</td>
      <td>thaw-2_279C_0.0035_1</td>
      <td>thaw-2_no-antibody_control_1</td>
      <td>0.0035</td>
      <td>9298</td>
      <td>0.0200</td>
      <td>11134</td>
      <td>0.0157</td>
    </tr>
    <tr>
      <th>8</th>
      <td>lib1</td>
      <td>thaw-2_279C_0.0035_2</td>
      <td>thaw-2_no-antibody_control_2</td>
      <td>0.0035</td>
      <td>9394</td>
      <td>0.0231</td>
      <td>9002</td>
      <td>0.0147</td>
    </tr>
    <tr>
      <th>9</th>
      <td>lib1</td>
      <td>thaw-2_279C_0.014_1</td>
      <td>thaw-2_no-antibody_control_1</td>
      <td>0.0140</td>
      <td>67940</td>
      <td>0.1408</td>
      <td>11134</td>
      <td>0.0157</td>
    </tr>
    <tr>
      <th>10</th>
      <td>lib1</td>
      <td>thaw-2_279C_0.014_2</td>
      <td>thaw-2_no-antibody_control_2</td>
      <td>0.0140</td>
      <td>60115</td>
      <td>0.1545</td>
      <td>9002</td>
      <td>0.0147</td>
    </tr>
    <tr>
      <th>11</th>
      <td>lib2</td>
      <td>thaw-1_REGN10933_0.037_1</td>
      <td>thaw-1_no-antibody_control_1</td>
      <td>0.0370</td>
      <td>14003</td>
      <td>0.0152</td>
      <td>11144</td>
      <td>0.0103</td>
    </tr>
    <tr>
      <th>12</th>
      <td>lib2</td>
      <td>thaw-1_REGN10933_0.037_2</td>
      <td>thaw-1_no-antibody_control_2</td>
      <td>0.0370</td>
      <td>12780</td>
      <td>0.0233</td>
      <td>10877</td>
      <td>0.0088</td>
    </tr>
    <tr>
      <th>13</th>
      <td>lib2</td>
      <td>thaw-1_REGN10933_0.15_1</td>
      <td>thaw-1_no-antibody_control_1</td>
      <td>0.1500</td>
      <td>22879</td>
      <td>0.0271</td>
      <td>11144</td>
      <td>0.0103</td>
    </tr>
    <tr>
      <th>14</th>
      <td>lib2</td>
      <td>thaw-1_REGN10933_0.15_2</td>
      <td>thaw-1_no-antibody_control_2</td>
      <td>0.1500</td>
      <td>20040</td>
      <td>0.0263</td>
      <td>10877</td>
      <td>0.0088</td>
    </tr>
    <tr>
      <th>15</th>
      <td>lib2</td>
      <td>thaw-1_REGN10933_0.59_1</td>
      <td>thaw-1_no-antibody_control_1</td>
      <td>0.5900</td>
      <td>57699</td>
      <td>0.0760</td>
      <td>11144</td>
      <td>0.0103</td>
    </tr>
    <tr>
      <th>16</th>
      <td>lib2</td>
      <td>thaw-1_REGN10933_0.59_2</td>
      <td>thaw-1_no-antibody_control_2</td>
      <td>0.5900</td>
      <td>52409</td>
      <td>0.0671</td>
      <td>10877</td>
      <td>0.0088</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>Now plot the fraction of all reads corresponding to the neutralization standard for all samples, making an interactive <code class="docutils literal notranslate"><span class="pre">altair</span></code> plot where you can mouse over points for details and select which libraries to show with the drop down at the bottom. Note the plot uses a symlog scale:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># make tidy version of neut_standard_fracs</span>
<span class="n">melt_cols</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;antibody_frac&quot;</span><span class="p">,</span> <span class="s2">&quot;no-antibody_frac&quot;</span><span class="p">]</span>
<span class="n">neut_standard_fracs_tidy</span> <span class="o">=</span> <span class="n">neut_standard_fracs</span><span class="o">.</span><span class="n">melt</span><span class="p">(</span>
    <span class="n">id_vars</span><span class="o">=</span><span class="p">[</span><span class="n">c</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">neut_standard_fracs</span><span class="o">.</span><span class="n">columns</span> <span class="k">if</span> <span class="n">c</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">melt_cols</span><span class="p">],</span>
    <span class="n">value_vars</span><span class="o">=</span><span class="n">melt_cols</span><span class="p">,</span>
    <span class="n">value_name</span><span class="o">=</span><span class="s2">&quot;neut_standard_frac&quot;</span><span class="p">,</span>
    <span class="n">var_name</span><span class="o">=</span><span class="s2">&quot;sample_type&quot;</span><span class="p">,</span>
<span class="p">)</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span>
    <span class="n">sample_type</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="s2">&quot;sample_type&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;_frac&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">),</span>
    <span class="n">library_sample</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="s2">&quot;library&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span> <span class="o">+</span> <span class="n">x</span><span class="p">[</span><span class="s2">&quot;antibody_sample&quot;</span><span class="p">],</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># NBVAL_IGNORE_OUTPUT</span>

<span class="c1"># set up selections over other columns of interest, in this case just library:</span>
<span class="n">selections</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">alt</span><span class="o">.</span><span class="n">selection_point</span><span class="p">(</span>
        <span class="n">fields</span><span class="o">=</span><span class="p">[</span><span class="n">col</span><span class="p">],</span>
        <span class="n">bind</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">binding_select</span><span class="p">(</span>
            <span class="n">options</span><span class="o">=</span><span class="p">[</span><span class="kc">None</span><span class="p">]</span> <span class="o">+</span> <span class="n">neut_standard_fracs_tidy</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span>
            <span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;all&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">neut_standard_fracs_tidy</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()],</span>
            <span class="n">name</span><span class="o">=</span><span class="n">col</span><span class="p">,</span>
        <span class="p">),</span>
    <span class="p">)</span>
    <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;library&quot;</span><span class="p">]</span>
<span class="p">]</span>

<span class="n">neut_standard_fracs_chart</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">neut_standard_fracs_tidy</span><span class="p">)</span>
    <span class="o">.</span><span class="n">encode</span><span class="p">(</span>
        <span class="n">x</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">X</span><span class="p">(</span>
            <span class="s2">&quot;neut_standard_frac&quot;</span><span class="p">,</span>
            <span class="n">title</span><span class="o">=</span><span class="s2">&quot;neutralization standard fraction&quot;</span><span class="p">,</span>
            <span class="n">scale</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">Scale</span><span class="p">(</span><span class="nb">type</span><span class="o">=</span><span class="s2">&quot;symlog&quot;</span><span class="p">,</span> <span class="n">constant</span><span class="o">=</span><span class="mf">0.02</span><span class="p">,</span> <span class="n">domainMax</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
        <span class="p">),</span>
        <span class="n">y</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">Y</span><span class="p">(</span><span class="s2">&quot;library_sample&quot;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="kc">None</span><span class="p">),</span>
        <span class="n">color</span><span class="o">=</span><span class="s2">&quot;sample_type&quot;</span><span class="p">,</span>
        <span class="n">shape</span><span class="o">=</span><span class="s2">&quot;sample_type&quot;</span><span class="p">,</span>
        <span class="n">tooltip</span><span class="o">=</span><span class="p">[</span>
            <span class="n">alt</span><span class="o">.</span><span class="n">Tooltip</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s2">&quot;.2g&quot;</span><span class="p">)</span> <span class="k">if</span> <span class="n">c</span> <span class="o">==</span> <span class="s2">&quot;neut_standard_frac&quot;</span> <span class="k">else</span> <span class="n">c</span>
            <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">neut_standard_fracs_tidy</span><span class="o">.</span><span class="n">columns</span>
        <span class="p">],</span>
    <span class="p">)</span>
    <span class="o">.</span><span class="n">mark_point</span><span class="p">()</span>
    <span class="o">.</span><span class="n">properties</span><span class="p">(</span><span class="n">width</span><span class="o">=</span><span class="mi">275</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">Step</span><span class="p">(</span><span class="mi">14</span><span class="p">))</span>
    <span class="o">.</span><span class="n">add_params</span><span class="p">(</span><span class="o">*</span><span class="n">selections</span><span class="p">)</span>
    <span class="o">.</span><span class="n">configure_axis</span><span class="p">(</span><span class="n">labelLimit</span><span class="o">=</span><span class="mi">500</span><span class="p">)</span>
<span class="p">)</span>
<span class="k">for</span> <span class="n">selection</span> <span class="ow">in</span> <span class="n">selections</span><span class="p">:</span>
    <span class="n">neut_standard_fracs_chart</span> <span class="o">=</span> <span class="n">neut_standard_fracs_chart</span><span class="o">.</span><span class="n">transform_filter</span><span class="p">(</span><span class="n">selection</span><span class="p">)</span>

<span class="n">neut_standard_fracs_chart</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div id="altair-viz-7477d297b72d4ab0a0ed6548f784d054"></div>
<script type="text/javascript">
  var VEGA_DEBUG = (typeof VEGA_DEBUG == "undefined") ? {} : VEGA_DEBUG;
  (function(spec, embedOpt){
    let outputDiv = document.currentScript.previousElementSibling;
    if (outputDiv.id !== "altair-viz-7477d297b72d4ab0a0ed6548f784d054") {
      outputDiv = document.getElementById("altair-viz-7477d297b72d4ab0a0ed6548f784d054");
    }
    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm/vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm/vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm/vega-lite@5.6.1?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm/vega-embed@6?noext",
    };

    function maybeLoadScript(lib, version) {
      var key = `${lib.replace("-", "")}_version`;
      return (VEGA_DEBUG[key] == version) ?
        Promise.resolve(paths[lib]) :
        new Promise(function(resolve, reject) {
          var s = document.createElement('script');
          document.getElementsByTagName("head")[0].appendChild(s);
          s.async = true;
          s.onload = () => {
            VEGA_DEBUG[key] = version;
            return resolve(paths[lib]);
          };
          s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
          s.src = paths[lib];
        });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      require(["vega-embed"], displayChart, err => showError(`Error loading script: ${err.message}`));
    } else {
      maybeLoadScript("vega", "5")
        .then(() => maybeLoadScript("vega-lite", "5.6.1"))
        .then(() => maybeLoadScript("vega-embed", "6"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"config": {"view": {"continuousWidth": 300, "continuousHeight": 300}, "axis": {"labelLimit": 500}}, "data": {"name": "data-52a5cb86d32341fd5be91b6bb0a7b855"}, "mark": {"type": "point"}, "encoding": {"color": {"field": "sample_type", "type": "nominal"}, "shape": {"field": "sample_type", "type": "nominal"}, "tooltip": [{"field": "library", "type": "nominal"}, {"field": "antibody_sample", "type": "nominal"}, {"field": "no-antibody_sample", "type": "nominal"}, {"field": "antibody_concentration", "type": "quantitative"}, {"field": "antibody_count", "type": "quantitative"}, {"field": "no-antibody_count", "type": "quantitative"}, {"field": "sample_type", "type": "nominal"}, {"field": "neut_standard_frac", "format": ".2g", "type": "quantitative"}, {"field": "library_sample", "type": "nominal"}], "x": {"field": "neut_standard_frac", "scale": {"constant": 0.02, "domainMax": 1, "type": "symlog"}, "title": "neutralization standard fraction", "type": "quantitative"}, "y": {"field": "library_sample", "title": null, "type": "nominal"}}, "height": {"step": 14}, "params": [{"name": "param_1", "select": {"type": "point", "fields": ["library"]}, "bind": {"input": "select", "options": [null, "lib1", "lib2"], "labels": ["all", "lib1", "lib2"], "name": "library"}}], "transform": [{"filter": {"param": "param_1"}}], "width": 275, "$schema": "https://vega.github.io/schema/vega-lite/v5.6.1.json", "datasets": {"data-52a5cb86d32341fd5be91b6bb0a7b855": [{"library": "lib1", "antibody_sample": "thaw-1_REGN10933_0.037_1", "no-antibody_sample": "thaw-1_no-antibody_control_1", "antibody_concentration": 0.037, "antibody_count": 11107, "no-antibody_count": 16475, "sample_type": "antibody", "neut_standard_frac": 0.02100280995548698, "library_sample": "lib1 thaw-1_REGN10933_0.037_1"}, {"library": "lib1", "antibody_sample": "thaw-1_REGN10933_0.15_1", "no-antibody_sample": "thaw-1_no-antibody_control_1", "antibody_concentration": 0.15, "antibody_count": 18045, "no-antibody_count": 16475, "sample_type": "antibody", "neut_standard_frac": 0.021955145558539148, "library_sample": "lib1 thaw-1_REGN10933_0.15_1"}, {"library": "lib1", "antibody_sample": "thaw-1_REGN10933_0.15_2", "no-antibody_sample": "thaw-1_no-antibody_control_2", "antibody_concentration": 0.15, "antibody_count": 14283, "no-antibody_count": 11343, "sample_type": "antibody", "neut_standard_frac": 0.03711682587861086, "library_sample": "lib1 thaw-1_REGN10933_0.15_2"}, {"library": "lib1", "antibody_sample": "thaw-1_REGN10933_0.59_1", "no-antibody_sample": "thaw-1_no-antibody_control_1", "antibody_concentration": 0.59, "antibody_count": 26027, "no-antibody_count": 16475, "sample_type": "antibody", "neut_standard_frac": 0.06355629030722007, "library_sample": "lib1 thaw-1_REGN10933_0.59_1"}, {"library": "lib1", "antibody_sample": "thaw-1_REGN10933_0.59_2", "no-antibody_sample": "thaw-1_no-antibody_control_2", "antibody_concentration": 0.59, "antibody_count": 23240, "no-antibody_count": 11343, "sample_type": "antibody", "neut_standard_frac": 0.051002269205953486, "library_sample": "lib1 thaw-1_REGN10933_0.59_2"}, {"library": "lib1", "antibody_sample": "thaw-2_279C_0.00088_1", "no-antibody_sample": "thaw-2_no-antibody_control_1", "antibody_concentration": 0.00088, "antibody_count": 8231, "no-antibody_count": 11134, "sample_type": "antibody", "neut_standard_frac": 0.015716983545954657, "library_sample": "lib1 thaw-2_279C_0.00088_1"}, {"library": "lib1", "antibody_sample": "thaw-2_279C_0.00088_2", "no-antibody_sample": "thaw-2_no-antibody_control_2", "antibody_concentration": 0.00088, "antibody_count": 8763, "no-antibody_count": 9002, "sample_type": "antibody", "neut_standard_frac": 0.017672113030536476, "library_sample": "lib1 thaw-2_279C_0.00088_2"}, {"library": "lib1", "antibody_sample": "thaw-2_279C_0.0035_1", "no-antibody_sample": "thaw-2_no-antibody_control_1", "antibody_concentration": 0.0035, "antibody_count": 9298, "no-antibody_count": 11134, "sample_type": "antibody", "neut_standard_frac": 0.02003546825203576, "library_sample": "lib1 thaw-2_279C_0.0035_1"}, {"library": "lib1", "antibody_sample": "thaw-2_279C_0.0035_2", "no-antibody_sample": "thaw-2_no-antibody_control_2", "antibody_concentration": 0.0035, "antibody_count": 9394, "no-antibody_count": 9002, "sample_type": "antibody", "neut_standard_frac": 0.02311174531319195, "library_sample": "lib1 thaw-2_279C_0.0035_2"}, {"library": "lib1", "antibody_sample": "thaw-2_279C_0.014_1", "no-antibody_sample": "thaw-2_no-antibody_control_1", "antibody_concentration": 0.014, "antibody_count": 67940, "no-antibody_count": 11134, "sample_type": "antibody", "neut_standard_frac": 0.14080041116870143, "library_sample": "lib1 thaw-2_279C_0.014_1"}, {"library": "lib1", "antibody_sample": "thaw-2_279C_0.014_2", "no-antibody_sample": "thaw-2_no-antibody_control_2", "antibody_concentration": 0.014, "antibody_count": 60115, "no-antibody_count": 9002, "sample_type": "antibody", "neut_standard_frac": 0.1545190028942593, "library_sample": "lib1 thaw-2_279C_0.014_2"}, {"library": "lib2", "antibody_sample": "thaw-1_REGN10933_0.037_1", "no-antibody_sample": "thaw-1_no-antibody_control_1", "antibody_concentration": 0.037, "antibody_count": 14003, "no-antibody_count": 11144, "sample_type": "antibody", "neut_standard_frac": 0.015206321868413137, "library_sample": "lib2 thaw-1_REGN10933_0.037_1"}, {"library": "lib2", "antibody_sample": "thaw-1_REGN10933_0.037_2", "no-antibody_sample": "thaw-1_no-antibody_control_2", "antibody_concentration": 0.037, "antibody_count": 12780, "no-antibody_count": 10877, "sample_type": "antibody", "neut_standard_frac": 0.02326144370202782, "library_sample": "lib2 thaw-1_REGN10933_0.037_2"}, {"library": "lib2", "antibody_sample": "thaw-1_REGN10933_0.15_1", "no-antibody_sample": "thaw-1_no-antibody_control_1", "antibody_concentration": 0.15, "antibody_count": 22879, "no-antibody_count": 11144, "sample_type": "antibody", "neut_standard_frac": 0.02706110423120277, "library_sample": "lib2 thaw-1_REGN10933_0.15_1"}, {"library": "lib2", "antibody_sample": "thaw-1_REGN10933_0.15_2", "no-antibody_sample": "thaw-1_no-antibody_control_2", "antibody_concentration": 0.15, "antibody_count": 20040, "no-antibody_count": 10877, "sample_type": "antibody", "neut_standard_frac": 0.0263007312758217, "library_sample": "lib2 thaw-1_REGN10933_0.15_2"}, {"library": "lib2", "antibody_sample": "thaw-1_REGN10933_0.59_1", "no-antibody_sample": "thaw-1_no-antibody_control_1", "antibody_concentration": 0.59, "antibody_count": 57699, "no-antibody_count": 11144, "sample_type": "antibody", "neut_standard_frac": 0.07597541882669272, "library_sample": "lib2 thaw-1_REGN10933_0.59_1"}, {"library": "lib2", "antibody_sample": "thaw-1_REGN10933_0.59_2", "no-antibody_sample": "thaw-1_no-antibody_control_2", "antibody_concentration": 0.59, "antibody_count": 52409, "no-antibody_count": 10877, "sample_type": "antibody", "neut_standard_frac": 0.06711479012301412, "library_sample": "lib2 thaw-1_REGN10933_0.59_2"}, {"library": "lib1", "antibody_sample": "thaw-1_REGN10933_0.037_1", "no-antibody_sample": "thaw-1_no-antibody_control_1", "antibody_concentration": 0.037, "antibody_count": 11107, "no-antibody_count": 16475, "sample_type": "no-antibody", "neut_standard_frac": 0.009766887081150234, "library_sample": "lib1 thaw-1_REGN10933_0.037_1"}, {"library": "lib1", "antibody_sample": "thaw-1_REGN10933_0.15_1", "no-antibody_sample": "thaw-1_no-antibody_control_1", "antibody_concentration": 0.15, "antibody_count": 18045, "no-antibody_count": 16475, "sample_type": "no-antibody", "neut_standard_frac": 0.009766887081150234, "library_sample": "lib1 thaw-1_REGN10933_0.15_1"}, {"library": "lib1", "antibody_sample": "thaw-1_REGN10933_0.15_2", "no-antibody_sample": "thaw-1_no-antibody_control_2", "antibody_concentration": 0.15, "antibody_count": 14283, "no-antibody_count": 11343, "sample_type": "no-antibody", "neut_standard_frac": 0.010271190952876395, "library_sample": "lib1 thaw-1_REGN10933_0.15_2"}, {"library": "lib1", "antibody_sample": "thaw-1_REGN10933_0.59_1", "no-antibody_sample": "thaw-1_no-antibody_control_1", "antibody_concentration": 0.59, "antibody_count": 26027, "no-antibody_count": 16475, "sample_type": "no-antibody", "neut_standard_frac": 0.009766887081150234, "library_sample": "lib1 thaw-1_REGN10933_0.59_1"}, {"library": "lib1", "antibody_sample": "thaw-1_REGN10933_0.59_2", "no-antibody_sample": "thaw-1_no-antibody_control_2", "antibody_concentration": 0.59, "antibody_count": 23240, "no-antibody_count": 11343, "sample_type": "no-antibody", "neut_standard_frac": 0.010271190952876395, "library_sample": "lib1 thaw-1_REGN10933_0.59_2"}, {"library": "lib1", "antibody_sample": "thaw-2_279C_0.00088_1", "no-antibody_sample": "thaw-2_no-antibody_control_1", "antibody_concentration": 0.00088, "antibody_count": 8231, "no-antibody_count": 11134, "sample_type": "no-antibody", "neut_standard_frac": 0.01568255157677675, "library_sample": "lib1 thaw-2_279C_0.00088_1"}, {"library": "lib1", "antibody_sample": "thaw-2_279C_0.00088_2", "no-antibody_sample": "thaw-2_no-antibody_control_2", "antibody_concentration": 0.00088, "antibody_count": 8763, "no-antibody_count": 9002, "sample_type": "no-antibody", "neut_standard_frac": 0.014682999233391508, "library_sample": "lib1 thaw-2_279C_0.00088_2"}, {"library": "lib1", "antibody_sample": "thaw-2_279C_0.0035_1", "no-antibody_sample": "thaw-2_no-antibody_control_1", "antibody_concentration": 0.0035, "antibody_count": 9298, "no-antibody_count": 11134, "sample_type": "no-antibody", "neut_standard_frac": 0.01568255157677675, "library_sample": "lib1 thaw-2_279C_0.0035_1"}, {"library": "lib1", "antibody_sample": "thaw-2_279C_0.0035_2", "no-antibody_sample": "thaw-2_no-antibody_control_2", "antibody_concentration": 0.0035, "antibody_count": 9394, "no-antibody_count": 9002, "sample_type": "no-antibody", "neut_standard_frac": 0.014682999233391508, "library_sample": "lib1 thaw-2_279C_0.0035_2"}, {"library": "lib1", "antibody_sample": "thaw-2_279C_0.014_1", "no-antibody_sample": "thaw-2_no-antibody_control_1", "antibody_concentration": 0.014, "antibody_count": 67940, "no-antibody_count": 11134, "sample_type": "no-antibody", "neut_standard_frac": 0.01568255157677675, "library_sample": "lib1 thaw-2_279C_0.014_1"}, {"library": "lib1", "antibody_sample": "thaw-2_279C_0.014_2", "no-antibody_sample": "thaw-2_no-antibody_control_2", "antibody_concentration": 0.014, "antibody_count": 60115, "no-antibody_count": 9002, "sample_type": "no-antibody", "neut_standard_frac": 0.014682999233391508, "library_sample": "lib1 thaw-2_279C_0.014_2"}, {"library": "lib2", "antibody_sample": "thaw-1_REGN10933_0.037_1", "no-antibody_sample": "thaw-1_no-antibody_control_1", "antibody_concentration": 0.037, "antibody_count": 14003, "no-antibody_count": 11144, "sample_type": "no-antibody", "neut_standard_frac": 0.010339599813694218, "library_sample": "lib2 thaw-1_REGN10933_0.037_1"}, {"library": "lib2", "antibody_sample": "thaw-1_REGN10933_0.037_2", "no-antibody_sample": "thaw-1_no-antibody_control_2", "antibody_concentration": 0.037, "antibody_count": 12780, "no-antibody_count": 10877, "sample_type": "no-antibody", "neut_standard_frac": 0.008816232177261626, "library_sample": "lib2 thaw-1_REGN10933_0.037_2"}, {"library": "lib2", "antibody_sample": "thaw-1_REGN10933_0.15_1", "no-antibody_sample": "thaw-1_no-antibody_control_1", "antibody_concentration": 0.15, "antibody_count": 22879, "no-antibody_count": 11144, "sample_type": "no-antibody", "neut_standard_frac": 0.010339599813694218, "library_sample": "lib2 thaw-1_REGN10933_0.15_1"}, {"library": "lib2", "antibody_sample": "thaw-1_REGN10933_0.15_2", "no-antibody_sample": "thaw-1_no-antibody_control_2", "antibody_concentration": 0.15, "antibody_count": 20040, "no-antibody_count": 10877, "sample_type": "no-antibody", "neut_standard_frac": 0.008816232177261626, "library_sample": "lib2 thaw-1_REGN10933_0.15_2"}, {"library": "lib2", "antibody_sample": "thaw-1_REGN10933_0.59_1", "no-antibody_sample": "thaw-1_no-antibody_control_1", "antibody_concentration": 0.59, "antibody_count": 57699, "no-antibody_count": 11144, "sample_type": "no-antibody", "neut_standard_frac": 0.010339599813694218, "library_sample": "lib2 thaw-1_REGN10933_0.59_1"}, {"library": "lib2", "antibody_sample": "thaw-1_REGN10933_0.59_2", "no-antibody_sample": "thaw-1_no-antibody_control_2", "antibody_concentration": 0.59, "antibody_count": 52409, "no-antibody_count": 10877, "sample_type": "no-antibody", "neut_standard_frac": 0.008816232177261626, "library_sample": "lib2 thaw-1_REGN10933_0.59_2"}]}}, {"mode": "vega-lite"});
</script></div>
</div>
</section>
<section id="Neutralization-averaged-over-all-variants-with-given-number-of-mutations">
<h2>Neutralization averaged over all variants with given number of mutations<a class="headerlink" href="#Neutralization-averaged-over-all-variants-with-given-number-of-mutations" title="Link to this heading">¶</a></h2>
<p>Now look at <code class="docutils literal notranslate"><span class="pre">neutralization</span></code>, which gives the extent of neutralization averages over all variants with each number of amino-acid mutations:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">neutralization</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>library</th>
      <th>antibody_sample</th>
      <th>no-antibody_sample</th>
      <th>n_aa_substitutions</th>
      <th>antibody_neut_standard_count</th>
      <th>no-antibody_neut_standard_count</th>
      <th>antibody_count</th>
      <th>no-antibody_count</th>
      <th>prob_escape_uncensored</th>
      <th>prob_escape</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>lib1</td>
      <td>thaw-1_REGN10933_0.037_1</td>
      <td>thaw-1_no-antibody_control_1</td>
      <td>0</td>
      <td>11107</td>
      <td>16475</td>
      <td>42343</td>
      <td>140698</td>
      <td>0.446</td>
      <td>0.446</td>
    </tr>
    <tr>
      <th>1</th>
      <td>lib1</td>
      <td>thaw-1_REGN10933_0.037_1</td>
      <td>thaw-1_no-antibody_control_1</td>
      <td>1</td>
      <td>11107</td>
      <td>16475</td>
      <td>102466</td>
      <td>340357</td>
      <td>0.447</td>
      <td>0.447</td>
    </tr>
    <tr>
      <th>2</th>
      <td>lib1</td>
      <td>thaw-1_REGN10933_0.037_1</td>
      <td>thaw-1_no-antibody_control_1</td>
      <td>2</td>
      <td>11107</td>
      <td>16475</td>
      <td>124509</td>
      <td>404439</td>
      <td>0.457</td>
      <td>0.457</td>
    </tr>
    <tr>
      <th>3</th>
      <td>lib1</td>
      <td>thaw-1_REGN10933_0.037_1</td>
      <td>thaw-1_no-antibody_control_1</td>
      <td>3</td>
      <td>11107</td>
      <td>16475</td>
      <td>106742</td>
      <td>342394</td>
      <td>0.462</td>
      <td>0.462</td>
    </tr>
    <tr>
      <th>4</th>
      <td>lib1</td>
      <td>thaw-1_REGN10933_0.037_1</td>
      <td>thaw-1_no-antibody_control_1</td>
      <td>4</td>
      <td>11107</td>
      <td>16475</td>
      <td>141667</td>
      <td>442459</td>
      <td>0.475</td>
      <td>0.475</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>80</th>
      <td>lib2</td>
      <td>thaw-1_REGN10933_0.59_2</td>
      <td>thaw-1_no-antibody_control_2</td>
      <td>0</td>
      <td>52409</td>
      <td>10877</td>
      <td>70691</td>
      <td>174569</td>
      <td>0.084</td>
      <td>0.084</td>
    </tr>
    <tr>
      <th>81</th>
      <td>lib2</td>
      <td>thaw-1_REGN10933_0.59_2</td>
      <td>thaw-1_no-antibody_control_2</td>
      <td>1</td>
      <td>52409</td>
      <td>10877</td>
      <td>179056</td>
      <td>361718</td>
      <td>0.103</td>
      <td>0.103</td>
    </tr>
    <tr>
      <th>82</th>
      <td>lib2</td>
      <td>thaw-1_REGN10933_0.59_2</td>
      <td>thaw-1_no-antibody_control_2</td>
      <td>2</td>
      <td>52409</td>
      <td>10877</td>
      <td>201992</td>
      <td>331201</td>
      <td>0.127</td>
      <td>0.127</td>
    </tr>
    <tr>
      <th>83</th>
      <td>lib2</td>
      <td>thaw-1_REGN10933_0.59_2</td>
      <td>thaw-1_no-antibody_control_2</td>
      <td>3</td>
      <td>52409</td>
      <td>10877</td>
      <td>141530</td>
      <td>219133</td>
      <td>0.134</td>
      <td>0.134</td>
    </tr>
    <tr>
      <th>84</th>
      <td>lib2</td>
      <td>thaw-1_REGN10933_0.59_2</td>
      <td>thaw-1_no-antibody_control_2</td>
      <td>4</td>
      <td>52409</td>
      <td>10877</td>
      <td>135208</td>
      <td>136249</td>
      <td>0.206</td>
      <td>0.206</td>
    </tr>
  </tbody>
</table>
<p>85 rows × 10 columns</p>
</div></div>
</div>
<p>Now plot neutralization. First, get the neutralization data ready to plot by melting, and doing a few other transformations:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cols_to_melt</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;prob_escape&quot;</span><span class="p">,</span> <span class="s2">&quot;prob_escape_uncensored&quot;</span><span class="p">]</span>
<span class="n">neutralization_to_plot</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">neutralization</span><span class="o">.</span><span class="n">melt</span><span class="p">(</span>
        <span class="n">id_vars</span><span class="o">=</span><span class="p">[</span><span class="n">c</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">neutralization</span><span class="o">.</span><span class="n">columns</span> <span class="k">if</span> <span class="n">c</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">cols_to_melt</span><span class="p">],</span>
        <span class="n">var_name</span><span class="o">=</span><span class="s2">&quot;censored&quot;</span><span class="p">,</span>
        <span class="n">value_name</span><span class="o">=</span><span class="s2">&quot;fraction not neutralized&quot;</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="o">.</span><span class="n">assign</span><span class="p">(</span>
        <span class="n">library_sample</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="s2">&quot;library&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span> <span class="o">+</span> <span class="n">x</span><span class="p">[</span><span class="s2">&quot;antibody_sample&quot;</span><span class="p">],</span>
        <span class="n">censored</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="s2">&quot;censored&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;prob_escape&quot;</span><span class="p">,</span>
        <span class="n">n_aa_substitutions</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="p">(</span>
            <span class="n">x</span><span class="p">[</span><span class="s2">&quot;n_aa_substitutions&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">map</span><span class="p">(</span>
                <span class="k">lambda</span> <span class="n">n</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;&gt;</span><span class="si">{</span><span class="n">n</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">if</span> <span class="n">n</span> <span class="o">==</span> <span class="n">x</span><span class="p">[</span><span class="s2">&quot;n_aa_substitutions&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="k">else</span> <span class="nb">str</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
            <span class="p">)</span>
        <span class="p">),</span>
    <span class="p">)</span>
    <span class="o">.</span><span class="n">rename</span><span class="p">(</span>
        <span class="n">columns</span><span class="o">=</span><span class="p">{</span>
            <span class="n">c</span><span class="p">:</span> <span class="n">c</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">,</span> <span class="s2">&quot; &quot;</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">neutralization</span><span class="o">.</span><span class="n">columns</span>
            <span class="k">if</span> <span class="n">c</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;count&quot;</span><span class="p">)</span>
        <span class="p">}</span>
    <span class="p">)</span>
    <span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">selections_df</span><span class="p">,</span> <span class="n">validate</span><span class="o">=</span><span class="s2">&quot;many_to_one&quot;</span><span class="p">)</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<p>Now make the plot. You can mouseover points for details, click on the legend to get values for a specific number of amino-acid substitutions, and use the drop-down to show censored (to [0, 1]) values or raw values, and subset which data to show:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># NBVAL_SKIP</span>

<span class="n">censored_selection</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">selection_point</span><span class="p">(</span>
    <span class="n">fields</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;censored&quot;</span><span class="p">],</span>
    <span class="n">value</span><span class="o">=</span><span class="p">[{</span><span class="s2">&quot;censored&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">}],</span>
    <span class="n">bind</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">binding_select</span><span class="p">(</span>
        <span class="n">options</span><span class="o">=</span><span class="p">[</span><span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">],</span>
        <span class="n">name</span><span class="o">=</span><span class="s2">&quot;censored to be between 0 and 1&quot;</span><span class="p">,</span>
    <span class="p">),</span>
<span class="p">)</span>

<span class="n">n_aa_substitutions_selection</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">selection_point</span><span class="p">(</span>
    <span class="n">fields</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;n_aa_substitutions&quot;</span><span class="p">],</span>
    <span class="n">bind</span><span class="o">=</span><span class="s2">&quot;legend&quot;</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">neutralization_chart</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">neutralization_to_plot</span><span class="p">)</span>
    <span class="o">.</span><span class="n">encode</span><span class="p">(</span>
        <span class="n">x</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">X</span><span class="p">(</span><span class="s2">&quot;fraction not neutralized&quot;</span><span class="p">),</span>
        <span class="n">y</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">Y</span><span class="p">(</span><span class="s2">&quot;library_sample&quot;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="kc">None</span><span class="p">),</span>
        <span class="n">color</span><span class="o">=</span><span class="s2">&quot;n_aa_substitutions:N&quot;</span><span class="p">,</span>
        <span class="n">opacity</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">condition</span><span class="p">(</span>
            <span class="n">n_aa_substitutions_selection</span><span class="p">,</span> <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="mf">0.7</span><span class="p">),</span> <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="p">),</span>
        <span class="n">tooltip</span><span class="o">=</span><span class="p">[</span>
            <span class="p">(</span>
                <span class="n">alt</span><span class="o">.</span><span class="n">Tooltip</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s2">&quot;.3g&quot;</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">c</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;_count&quot;</span><span class="p">)</span>
                <span class="ow">or</span> <span class="n">c</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;fraction&quot;</span><span class="p">)</span>
                <span class="ow">or</span> <span class="n">c</span> <span class="o">==</span> <span class="s2">&quot;antibody_concentration&quot;</span>
                <span class="k">else</span> <span class="n">c</span>
            <span class="p">)</span>
            <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">neutralization_to_plot</span><span class="o">.</span><span class="n">columns</span>
            <span class="k">if</span> <span class="n">c</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;library_sample&quot;</span><span class="p">]</span>
        <span class="p">],</span>
    <span class="p">)</span>
    <span class="o">.</span><span class="n">mark_point</span><span class="p">(</span><span class="n">filled</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
    <span class="o">.</span><span class="n">properties</span><span class="p">(</span><span class="n">width</span><span class="o">=</span><span class="mi">275</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">Step</span><span class="p">(</span><span class="mi">14</span><span class="p">))</span>
    <span class="o">.</span><span class="n">add_params</span><span class="p">(</span><span class="n">censored_selection</span><span class="p">,</span> <span class="n">n_aa_substitutions_selection</span><span class="p">,</span> <span class="o">*</span><span class="n">selections</span><span class="p">)</span>
    <span class="o">.</span><span class="n">transform_filter</span><span class="p">(</span><span class="n">censored_selection</span><span class="p">)</span>
    <span class="o">.</span><span class="n">configure_axis</span><span class="p">(</span><span class="n">labelLimit</span><span class="o">=</span><span class="mi">500</span><span class="p">)</span>
<span class="p">)</span>
<span class="k">for</span> <span class="n">selection</span> <span class="ow">in</span> <span class="n">selections</span><span class="p">:</span>
    <span class="n">neutralization_chart</span> <span class="o">=</span> <span class="n">neutralization_chart</span><span class="o">.</span><span class="n">transform_filter</span><span class="p">(</span><span class="n">selection</span><span class="p">)</span>

<span class="n">neutralization_chart</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div id="altair-viz-226be42baf514fd5a87a2c305fb2e89d"></div>
<script type="text/javascript">
  var VEGA_DEBUG = (typeof VEGA_DEBUG == "undefined") ? {} : VEGA_DEBUG;
  (function(spec, embedOpt){
    let outputDiv = document.currentScript.previousElementSibling;
    if (outputDiv.id !== "altair-viz-226be42baf514fd5a87a2c305fb2e89d") {
      outputDiv = document.getElementById("altair-viz-226be42baf514fd5a87a2c305fb2e89d");
    }
    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm/vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm/vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm/vega-lite@5.6.1?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm/vega-embed@6?noext",
    };

    function maybeLoadScript(lib, version) {
      var key = `${lib.replace("-", "")}_version`;
      return (VEGA_DEBUG[key] == version) ?
        Promise.resolve(paths[lib]) :
        new Promise(function(resolve, reject) {
          var s = document.createElement('script');
          document.getElementsByTagName("head")[0].appendChild(s);
          s.async = true;
          s.onload = () => {
            VEGA_DEBUG[key] = version;
            return resolve(paths[lib]);
          };
          s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
          s.src = paths[lib];
        });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      require(["vega-embed"], displayChart, err => showError(`Error loading script: ${err.message}`));
    } else {
      maybeLoadScript("vega", "5")
        .then(() => maybeLoadScript("vega-lite", "5.6.1"))
        .then(() => maybeLoadScript("vega-embed", "6"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"config": {"view": {"continuousWidth": 300, "continuousHeight": 300}, "axis": {"labelLimit": 500}}, "data": {"name": "data-d9a4521f849a7e9a0df67475a4afde98"}, "mark": {"type": "point", "filled": true, "size": 50}, "encoding": {"color": {"field": "n_aa_substitutions", "type": "nominal"}, "opacity": {"condition": {"param": "param_3", "value": 0.7}, "value": 0}, "tooltip": [{"field": "library", "type": "nominal"}, {"field": "antibody_sample", "type": "nominal"}, {"field": "no-antibody_sample", "type": "nominal"}, {"field": "n_aa_substitutions", "type": "nominal"}, {"field": "antibody neut standard count", "type": "quantitative"}, {"field": "no-antibody neut standard count", "type": "quantitative"}, {"field": "antibody count", "type": "quantitative"}, {"field": "no-antibody count", "type": "quantitative"}, {"field": "censored", "type": "nominal"}, {"field": "fraction not neutralized", "format": ".3g", "type": "quantitative"}, {"field": "antibody_concentration", "format": ".3g", "type": "quantitative"}], "x": {"field": "fraction not neutralized", "type": "quantitative"}, "y": {"field": "library_sample", "title": null, "type": "nominal"}}, "height": {"step": 14}, "params": [{"name": "param_2", "select": {"type": "point", "fields": ["censored"]}, "bind": {"input": "select", "options": [true, false], "name": "censored to be between 0 and 1"}, "value": [{"censored": true}]}, {"name": "param_3", "select": {"type": "point", "fields": ["n_aa_substitutions"]}, "bind": "legend"}, {"name": "param_1", "select": {"type": "point", "fields": ["library"]}, "bind": {"input": "select", "options": [null, "lib1", "lib2"], "labels": ["all", "lib1", "lib2"], "name": "library"}}], "transform": [{"filter": {"param": "param_2"}}, {"filter": {"param": "param_1"}}], "width": 275, "$schema": "https://vega.github.io/schema/vega-lite/v5.6.1.json", "datasets": {"data-d9a4521f849a7e9a0df67475a4afde98": [{"library": "lib1", "antibody_sample": "thaw-1_REGN10933_0.037_1", "no-antibody_sample": "thaw-1_no-antibody_control_1", "n_aa_substitutions": "0", "antibody neut standard count": 11107, "no-antibody neut standard count": 16475, "antibody count": 42343, "no-antibody count": 140698, "censored": false, "fraction not neutralized": 0.44639811482128305, "library_sample": "lib1 thaw-1_REGN10933_0.037_1", "antibody_concentration": 0.037}, {"library": "lib1", "antibody_sample": "thaw-1_REGN10933_0.037_1", "no-antibody_sample": "thaw-1_no-antibody_control_1", "n_aa_substitutions": "1", "antibody neut standard count": 11107, "no-antibody neut standard count": 16475, "antibody count": 102466, "no-antibody count": 340357, "censored": false, "fraction not neutralized": 0.4465537566375033, "library_sample": "lib1 thaw-1_REGN10933_0.037_1", "antibody_concentration": 0.037}, {"library": "lib1", "antibody_sample": "thaw-1_REGN10933_0.037_1", "no-antibody_sample": "thaw-1_no-antibody_control_1", "n_aa_substitutions": "2", "antibody neut standard count": 11107, "no-antibody neut standard count": 16475, "antibody count": 124509, "no-antibody count": 404439, "censored": false, "fraction not neutralized": 0.45664254151937456, "library_sample": "lib1 thaw-1_REGN10933_0.037_1", "antibody_concentration": 0.037}, {"library": "lib1", "antibody_sample": "thaw-1_REGN10933_0.037_1", "no-antibody_sample": "thaw-1_no-antibody_control_1", "n_aa_substitutions": "3", "antibody neut standard count": 11107, "no-antibody neut standard count": 16475, "antibody count": 106742, "no-antibody count": 342394, "censored": false, "fraction not neutralized": 0.4624213120107265, "library_sample": "lib1 thaw-1_REGN10933_0.037_1", "antibody_concentration": 0.037}, {"library": "lib1", "antibody_sample": "thaw-1_REGN10933_0.037_1", "no-antibody_sample": "thaw-1_no-antibody_control_1", "n_aa_substitutions": ">3", "antibody neut standard count": 11107, "no-antibody neut standard count": 16475, "antibody count": 141667, "no-antibody count": 442459, "censored": false, "fraction not neutralized": 0.47492421673597945, "library_sample": "lib1 thaw-1_REGN10933_0.037_1", "antibody_concentration": 0.037}, {"library": "lib1", "antibody_sample": "thaw-1_REGN10933_0.037_1", "no-antibody_sample": "thaw-1_no-antibody_control_1", "n_aa_substitutions": "0", "antibody neut standard count": 11107, "no-antibody neut standard count": 16475, "antibody count": 42343, "no-antibody count": 140698, "censored": true, "fraction not neutralized": 0.44639811482128305, "library_sample": "lib1 thaw-1_REGN10933_0.037_1", "antibody_concentration": 0.037}, {"library": "lib1", "antibody_sample": "thaw-1_REGN10933_0.037_1", "no-antibody_sample": "thaw-1_no-antibody_control_1", "n_aa_substitutions": "1", "antibody neut standard count": 11107, "no-antibody neut standard count": 16475, "antibody count": 102466, "no-antibody count": 340357, "censored": true, "fraction not neutralized": 0.4465537566375033, "library_sample": "lib1 thaw-1_REGN10933_0.037_1", "antibody_concentration": 0.037}, {"library": "lib1", "antibody_sample": "thaw-1_REGN10933_0.037_1", "no-antibody_sample": "thaw-1_no-antibody_control_1", "n_aa_substitutions": "2", "antibody neut standard count": 11107, "no-antibody neut standard count": 16475, "antibody count": 124509, "no-antibody count": 404439, "censored": true, "fraction not neutralized": 0.45664254151937456, "library_sample": "lib1 thaw-1_REGN10933_0.037_1", "antibody_concentration": 0.037}, {"library": "lib1", "antibody_sample": "thaw-1_REGN10933_0.037_1", "no-antibody_sample": "thaw-1_no-antibody_control_1", "n_aa_substitutions": "3", "antibody neut standard count": 11107, "no-antibody neut standard count": 16475, "antibody count": 106742, "no-antibody count": 342394, "censored": true, "fraction not neutralized": 0.4624213120107265, "library_sample": "lib1 thaw-1_REGN10933_0.037_1", "antibody_concentration": 0.037}, {"library": "lib1", "antibody_sample": "thaw-1_REGN10933_0.037_1", "no-antibody_sample": "thaw-1_no-antibody_control_1", "n_aa_substitutions": ">3", "antibody neut standard count": 11107, "no-antibody neut standard count": 16475, "antibody count": 141667, "no-antibody count": 442459, "censored": true, "fraction not neutralized": 0.47492421673597945, "library_sample": "lib1 thaw-1_REGN10933_0.037_1", "antibody_concentration": 0.037}, {"library": "lib1", "antibody_sample": "thaw-1_REGN10933_0.15_1", "no-antibody_sample": "thaw-1_no-antibody_control_1", "n_aa_substitutions": "0", "antibody neut standard count": 18045, "no-antibody neut standard count": 16475, "antibody count": 62094, "no-antibody count": 140698, "censored": false, "fraction not neutralized": 0.4029305996500266, "library_sample": "lib1 thaw-1_REGN10933_0.15_1", "antibody_concentration": 0.15}, {"library": "lib1", "antibody_sample": "thaw-1_REGN10933_0.15_1", "no-antibody_sample": "thaw-1_no-antibody_control_1", "n_aa_substitutions": "1", "antibody neut standard count": 18045, "no-antibody neut standard count": 16475, "antibody count": 156650, "no-antibody count": 340357, "censored": false, "fraction not neutralized": 0.4202079349289638, "library_sample": "lib1 thaw-1_REGN10933_0.15_1", "antibody_concentration": 0.15}, {"library": "lib1", "antibody_sample": "thaw-1_REGN10933_0.15_1", "no-antibody_sample": "thaw-1_no-antibody_control_1", "n_aa_substitutions": "2", "antibody neut standard count": 18045, "no-antibody neut standard count": 16475, "antibody count": 186235, "no-antibody count": 404439, "censored": false, "fraction not neutralized": 0.4204136538515555, "library_sample": "lib1 thaw-1_REGN10933_0.15_1", "antibody_concentration": 0.15}, {"library": "lib1", "antibody_sample": "thaw-1_REGN10933_0.15_1", "no-antibody_sample": "thaw-1_no-antibody_control_1", "n_aa_substitutions": "3", "antibody neut standard count": 18045, "no-antibody neut standard count": 16475, "antibody count": 167800, "no-antibody count": 342394, "censored": false, "fraction not neutralized": 0.4474395275242652, "library_sample": "lib1 thaw-1_REGN10933_0.15_1", "antibody_concentration": 0.15}, {"library": "lib1", "antibody_sample": "thaw-1_REGN10933_0.15_1", "no-antibody_sample": "thaw-1_no-antibody_control_1", "n_aa_substitutions": ">3", "antibody neut standard count": 18045, "no-antibody neut standard count": 16475, "antibody count": 231079, "no-antibody count": 442459, "censored": false, "fraction not neutralized": 0.47682166825587013, "library_sample": "lib1 thaw-1_REGN10933_0.15_1", "antibody_concentration": 0.15}, {"library": "lib1", "antibody_sample": "thaw-1_REGN10933_0.15_1", "no-antibody_sample": "thaw-1_no-antibody_control_1", "n_aa_substitutions": "0", "antibody neut standard count": 18045, "no-antibody neut standard count": 16475, "antibody count": 62094, "no-antibody count": 140698, "censored": true, "fraction not neutralized": 0.4029305996500266, "library_sample": "lib1 thaw-1_REGN10933_0.15_1", "antibody_concentration": 0.15}, {"library": "lib1", "antibody_sample": "thaw-1_REGN10933_0.15_1", "no-antibody_sample": "thaw-1_no-antibody_control_1", "n_aa_substitutions": "1", "antibody neut standard count": 18045, "no-antibody neut standard count": 16475, "antibody count": 156650, "no-antibody count": 340357, "censored": true, "fraction not neutralized": 0.4202079349289638, "library_sample": "lib1 thaw-1_REGN10933_0.15_1", "antibody_concentration": 0.15}, {"library": "lib1", "antibody_sample": "thaw-1_REGN10933_0.15_1", "no-antibody_sample": "thaw-1_no-antibody_control_1", "n_aa_substitutions": "2", "antibody neut standard count": 18045, "no-antibody neut standard count": 16475, "antibody count": 186235, "no-antibody count": 404439, "censored": true, "fraction not neutralized": 0.4204136538515555, "library_sample": "lib1 thaw-1_REGN10933_0.15_1", "antibody_concentration": 0.15}, {"library": "lib1", "antibody_sample": "thaw-1_REGN10933_0.15_1", "no-antibody_sample": "thaw-1_no-antibody_control_1", "n_aa_substitutions": "3", "antibody neut standard count": 18045, "no-antibody neut standard count": 16475, "antibody count": 167800, "no-antibody count": 342394, "censored": true, "fraction not neutralized": 0.4474395275242652, "library_sample": "lib1 thaw-1_REGN10933_0.15_1", "antibody_concentration": 0.15}, {"library": "lib1", "antibody_sample": "thaw-1_REGN10933_0.15_1", "no-antibody_sample": "thaw-1_no-antibody_control_1", "n_aa_substitutions": ">3", "antibody neut standard count": 18045, "no-antibody neut standard count": 16475, "antibody count": 231079, "no-antibody count": 442459, "censored": true, "fraction not neutralized": 0.47682166825587013, "library_sample": "lib1 thaw-1_REGN10933_0.15_1", "antibody_concentration": 0.15}, {"library": "lib1", "antibody_sample": "thaw-1_REGN10933_0.15_2", "no-antibody_sample": "thaw-1_no-antibody_control_2", "n_aa_substitutions": "0", "antibody neut standard count": 14283, "no-antibody neut standard count": 11343, "antibody count": 25266, "no-antibody count": 92678, "censored": false, "fraction not neutralized": 0.2165052014622846, "library_sample": "lib1 thaw-1_REGN10933_0.15_2", "antibody_concentration": 0.15}, {"library": "lib1", "antibody_sample": "thaw-1_REGN10933_0.15_2", "no-antibody_sample": "thaw-1_no-antibody_control_2", "n_aa_substitutions": "1", "antibody neut standard count": 14283, "no-antibody neut standard count": 11343, "antibody count": 67873, "no-antibody count": 228267, "censored": false, "fraction not neutralized": 0.2361361130851322, "library_sample": "lib1 thaw-1_REGN10933_0.15_2", "antibody_concentration": 0.15}, {"library": "lib1", "antibody_sample": "thaw-1_REGN10933_0.15_2", "no-antibody_sample": "thaw-1_no-antibody_control_2", "n_aa_substitutions": "2", "antibody neut standard count": 14283, "no-antibody neut standard count": 11343, "antibody count": 84023, "no-antibody count": 256858, "censored": false, "fraction not neutralized": 0.25978470792537733, "library_sample": "lib1 thaw-1_REGN10933_0.15_2", "antibody_concentration": 0.15}, {"library": "lib1", "antibody_sample": "thaw-1_REGN10933_0.15_2", "no-antibody_sample": "thaw-1_no-antibody_control_2", "n_aa_substitutions": "3", "antibody neut standard count": 14283, "no-antibody neut standard count": 11343, "antibody count": 78907, "no-antibody count": 224147, "censored": false, "fraction not neutralized": 0.2795703417495863, "library_sample": "lib1 thaw-1_REGN10933_0.15_2", "antibody_concentration": 0.15}, {"library": "lib1", "antibody_sample": "thaw-1_REGN10933_0.15_2", "no-antibody_sample": "thaw-1_no-antibody_control_2", "n_aa_substitutions": ">3", "antibody neut standard count": 14283, "no-antibody neut standard count": 11343, "antibody count": 114460, "no-antibody count": 291058, "censored": false, "fraction not neutralized": 0.31230770339434605, "library_sample": "lib1 thaw-1_REGN10933_0.15_2", "antibody_concentration": 0.15}, {"library": "lib1", "antibody_sample": "thaw-1_REGN10933_0.15_2", "no-antibody_sample": "thaw-1_no-antibody_control_2", "n_aa_substitutions": "0", "antibody neut standard count": 14283, "no-antibody neut standard count": 11343, "antibody count": 25266, "no-antibody count": 92678, "censored": true, "fraction not neutralized": 0.2165052014622846, "library_sample": "lib1 thaw-1_REGN10933_0.15_2", "antibody_concentration": 0.15}, {"library": "lib1", "antibody_sample": "thaw-1_REGN10933_0.15_2", "no-antibody_sample": "thaw-1_no-antibody_control_2", "n_aa_substitutions": "1", "antibody neut standard count": 14283, "no-antibody neut standard count": 11343, "antibody count": 67873, "no-antibody count": 228267, "censored": true, "fraction not neutralized": 0.2361361130851322, "library_sample": "lib1 thaw-1_REGN10933_0.15_2", "antibody_concentration": 0.15}, {"library": "lib1", "antibody_sample": "thaw-1_REGN10933_0.15_2", "no-antibody_sample": "thaw-1_no-antibody_control_2", "n_aa_substitutions": "2", "antibody neut standard count": 14283, "no-antibody neut standard count": 11343, "antibody count": 84023, "no-antibody count": 256858, "censored": true, "fraction not neutralized": 0.25978470792537733, "library_sample": "lib1 thaw-1_REGN10933_0.15_2", "antibody_concentration": 0.15}, {"library": "lib1", "antibody_sample": "thaw-1_REGN10933_0.15_2", "no-antibody_sample": "thaw-1_no-antibody_control_2", "n_aa_substitutions": "3", "antibody neut standard count": 14283, "no-antibody neut standard count": 11343, "antibody count": 78907, "no-antibody count": 224147, "censored": true, "fraction not neutralized": 0.2795703417495863, "library_sample": "lib1 thaw-1_REGN10933_0.15_2", "antibody_concentration": 0.15}, {"library": "lib1", "antibody_sample": "thaw-1_REGN10933_0.15_2", "no-antibody_sample": "thaw-1_no-antibody_control_2", "n_aa_substitutions": ">3", "antibody neut standard count": 14283, "no-antibody neut standard count": 11343, "antibody count": 114460, "no-antibody count": 291058, "censored": true, "fraction not neutralized": 0.31230770339434605, "library_sample": "lib1 thaw-1_REGN10933_0.15_2", "antibody_concentration": 0.15}, {"library": "lib1", "antibody_sample": "thaw-1_REGN10933_0.59_1", "no-antibody_sample": "thaw-1_no-antibody_control_1", "n_aa_substitutions": "0", "antibody neut standard count": 26027, "no-antibody neut standard count": 16475, "antibody count": 19889, "no-antibody count": 140698, "censored": false, "fraction not neutralized": 0.08948007406440657, "library_sample": "lib1 thaw-1_REGN10933_0.59_1", "antibody_concentration": 0.59}, {"library": "lib1", "antibody_sample": "thaw-1_REGN10933_0.59_1", "no-antibody_sample": "thaw-1_no-antibody_control_1", "n_aa_substitutions": "1", "antibody neut standard count": 26027, "no-antibody neut standard count": 16475, "antibody count": 56247, "no-antibody count": 340357, "censored": false, "fraction not neutralized": 0.10460826232374869, "library_sample": "lib1 thaw-1_REGN10933_0.59_1", "antibody_concentration": 0.59}, {"library": "lib1", "antibody_sample": "thaw-1_REGN10933_0.59_1", "no-antibody_sample": "thaw-1_no-antibody_control_1", "n_aa_substitutions": "2", "antibody neut standard count": 26027, "no-antibody neut standard count": 16475, "antibody count": 79311, "no-antibody count": 404439, "censored": false, "fraction not neutralized": 0.12413141586114577, "library_sample": "lib1 thaw-1_REGN10933_0.59_1", "antibody_concentration": 0.59}, {"library": "lib1", "antibody_sample": "thaw-1_REGN10933_0.59_1", "no-antibody_sample": "thaw-1_no-antibody_control_1", "n_aa_substitutions": "3", "antibody neut standard count": 26027, "no-antibody neut standard count": 16475, "antibody count": 89972, "no-antibody count": 342394, "censored": false, "fraction not neutralized": 0.1663345777807858, "library_sample": "lib1 thaw-1_REGN10933_0.59_1", "antibody_concentration": 0.59}, {"library": "lib1", "antibody_sample": "thaw-1_REGN10933_0.59_1", "no-antibody_sample": "thaw-1_no-antibody_control_1", "n_aa_substitutions": ">3", "antibody neut standard count": 26027, "no-antibody neut standard count": 16475, "antibody count": 138065, "no-antibody count": 442459, "censored": false, "fraction not neutralized": 0.19752036295745504, "library_sample": "lib1 thaw-1_REGN10933_0.59_1", "antibody_concentration": 0.59}, {"library": "lib1", "antibody_sample": "thaw-1_REGN10933_0.59_1", "no-antibody_sample": "thaw-1_no-antibody_control_1", "n_aa_substitutions": "0", "antibody neut standard count": 26027, "no-antibody neut standard count": 16475, "antibody count": 19889, "no-antibody count": 140698, "censored": true, "fraction not neutralized": 0.08948007406440657, "library_sample": "lib1 thaw-1_REGN10933_0.59_1", "antibody_concentration": 0.59}, {"library": "lib1", "antibody_sample": "thaw-1_REGN10933_0.59_1", "no-antibody_sample": "thaw-1_no-antibody_control_1", "n_aa_substitutions": "1", "antibody neut standard count": 26027, "no-antibody neut standard count": 16475, "antibody count": 56247, "no-antibody count": 340357, "censored": true, "fraction not neutralized": 0.10460826232374869, "library_sample": "lib1 thaw-1_REGN10933_0.59_1", "antibody_concentration": 0.59}, {"library": "lib1", "antibody_sample": "thaw-1_REGN10933_0.59_1", "no-antibody_sample": "thaw-1_no-antibody_control_1", "n_aa_substitutions": "2", "antibody neut standard count": 26027, "no-antibody neut standard count": 16475, "antibody count": 79311, "no-antibody count": 404439, "censored": true, "fraction not neutralized": 0.12413141586114577, "library_sample": "lib1 thaw-1_REGN10933_0.59_1", "antibody_concentration": 0.59}, {"library": "lib1", "antibody_sample": "thaw-1_REGN10933_0.59_1", "no-antibody_sample": "thaw-1_no-antibody_control_1", "n_aa_substitutions": "3", "antibody neut standard count": 26027, "no-antibody neut standard count": 16475, "antibody count": 89972, "no-antibody count": 342394, "censored": true, "fraction not neutralized": 0.1663345777807858, "library_sample": "lib1 thaw-1_REGN10933_0.59_1", "antibody_concentration": 0.59}, {"library": "lib1", "antibody_sample": "thaw-1_REGN10933_0.59_1", "no-antibody_sample": "thaw-1_no-antibody_control_1", "n_aa_substitutions": ">3", "antibody neut standard count": 26027, "no-antibody neut standard count": 16475, "antibody count": 138065, "no-antibody count": 442459, "censored": true, "fraction not neutralized": 0.19752036295745504, "library_sample": "lib1 thaw-1_REGN10933_0.59_1", "antibody_concentration": 0.59}, {"library": "lib1", "antibody_sample": "thaw-1_REGN10933_0.59_2", "no-antibody_sample": "thaw-1_no-antibody_control_2", "n_aa_substitutions": "0", "antibody neut standard count": 23240, "no-antibody neut standard count": 11343, "antibody count": 23211, "no-antibody count": 92678, "censored": false, "fraction not neutralized": 0.12223878001299932, "library_sample": "lib1 thaw-1_REGN10933_0.59_2", "antibody_concentration": 0.59}, {"library": "lib1", "antibody_sample": "thaw-1_REGN10933_0.59_2", "no-antibody_sample": "thaw-1_no-antibody_control_2", "n_aa_substitutions": "1", "antibody neut standard count": 23240, "no-antibody neut standard count": 11343, "antibody count": 68425, "no-antibody count": 228267, "censored": false, "fraction not neutralized": 0.1463064535870882, "library_sample": "lib1 thaw-1_REGN10933_0.59_2", "antibody_concentration": 0.59}, {"library": "lib1", "antibody_sample": "thaw-1_REGN10933_0.59_2", "no-antibody_sample": "thaw-1_no-antibody_control_2", "n_aa_substitutions": "2", "antibody neut standard count": 23240, "no-antibody neut standard count": 11343, "antibody count": 89879, "no-antibody count": 256858, "censored": false, "fraction not neutralized": 0.1707878390491185, "library_sample": "lib1 thaw-1_REGN10933_0.59_2", "antibody_concentration": 0.59}, {"library": "lib1", "antibody_sample": "thaw-1_REGN10933_0.59_2", "no-antibody_sample": "thaw-1_no-antibody_control_2", "n_aa_substitutions": "3", "antibody neut standard count": 23240, "no-antibody neut standard count": 11343, "antibody count": 100727, "no-antibody count": 224147, "censored": false, "fraction not neutralized": 0.21933340313067692, "library_sample": "lib1 thaw-1_REGN10933_0.59_2", "antibody_concentration": 0.59}, {"library": "lib1", "antibody_sample": "thaw-1_REGN10933_0.59_2", "no-antibody_sample": "thaw-1_no-antibody_control_2", "n_aa_substitutions": ">3", "antibody neut standard count": 23240, "no-antibody neut standard count": 11343, "antibody count": 150184, "no-antibody count": 291058, "censored": false, "fraction not neutralized": 0.2518465087232526, "library_sample": "lib1 thaw-1_REGN10933_0.59_2", "antibody_concentration": 0.59}, {"library": "lib1", "antibody_sample": "thaw-1_REGN10933_0.59_2", "no-antibody_sample": "thaw-1_no-antibody_control_2", "n_aa_substitutions": "0", "antibody neut standard count": 23240, "no-antibody neut standard count": 11343, "antibody count": 23211, "no-antibody count": 92678, "censored": true, "fraction not neutralized": 0.12223878001299932, "library_sample": "lib1 thaw-1_REGN10933_0.59_2", "antibody_concentration": 0.59}, {"library": "lib1", "antibody_sample": "thaw-1_REGN10933_0.59_2", "no-antibody_sample": "thaw-1_no-antibody_control_2", "n_aa_substitutions": "1", "antibody neut standard count": 23240, "no-antibody neut standard count": 11343, "antibody count": 68425, "no-antibody count": 228267, "censored": true, "fraction not neutralized": 0.1463064535870882, "library_sample": "lib1 thaw-1_REGN10933_0.59_2", "antibody_concentration": 0.59}, {"library": "lib1", "antibody_sample": "thaw-1_REGN10933_0.59_2", "no-antibody_sample": "thaw-1_no-antibody_control_2", "n_aa_substitutions": "2", "antibody neut standard count": 23240, "no-antibody neut standard count": 11343, "antibody count": 89879, "no-antibody count": 256858, "censored": true, "fraction not neutralized": 0.1707878390491185, "library_sample": "lib1 thaw-1_REGN10933_0.59_2", "antibody_concentration": 0.59}, {"library": "lib1", "antibody_sample": "thaw-1_REGN10933_0.59_2", "no-antibody_sample": "thaw-1_no-antibody_control_2", "n_aa_substitutions": "3", "antibody neut standard count": 23240, "no-antibody neut standard count": 11343, "antibody count": 100727, "no-antibody count": 224147, "censored": true, "fraction not neutralized": 0.21933340313067692, "library_sample": "lib1 thaw-1_REGN10933_0.59_2", "antibody_concentration": 0.59}, {"library": "lib1", "antibody_sample": "thaw-1_REGN10933_0.59_2", "no-antibody_sample": "thaw-1_no-antibody_control_2", "n_aa_substitutions": ">3", "antibody neut standard count": 23240, "no-antibody neut standard count": 11343, "antibody count": 150184, "no-antibody count": 291058, "censored": true, "fraction not neutralized": 0.2518465087232526, "library_sample": "lib1 thaw-1_REGN10933_0.59_2", "antibody_concentration": 0.59}, {"library": "lib1", "antibody_sample": "thaw-2_279C_0.00088_1", "no-antibody_sample": "thaw-2_no-antibody_control_1", "n_aa_substitutions": "0", "antibody neut standard count": 8231, "no-antibody neut standard count": 11134, "antibody count": 50804, "no-antibody count": 70060, "censored": false, "fraction not neutralized": 0.9809037382713736, "library_sample": "lib1 thaw-2_279C_0.00088_1", "antibody_concentration": 0.00088}, {"library": "lib1", "antibody_sample": "thaw-2_279C_0.00088_1", "no-antibody_sample": "thaw-2_no-antibody_control_1", "n_aa_substitutions": "1", "antibody neut standard count": 8231, "no-antibody neut standard count": 11134, "antibody count": 116272, "no-antibody count": 160117, "censored": false, "fraction not neutralized": 0.9822822892372151, "library_sample": "lib1 thaw-2_279C_0.00088_1", "antibody_concentration": 0.00088}, {"library": "lib1", "antibody_sample": "thaw-2_279C_0.00088_1", "no-antibody_sample": "thaw-2_no-antibody_control_1", "n_aa_substitutions": "2", "antibody neut standard count": 8231, "no-antibody neut standard count": 11134, "antibody count": 123860, "no-antibody count": 167901, "censored": false, "fraction not neutralized": 0.9978756110040318, "library_sample": "lib1 thaw-2_279C_0.00088_1", "antibody_concentration": 0.00088}, {"library": "lib1", "antibody_sample": "thaw-2_279C_0.00088_1", "no-antibody_sample": "thaw-2_no-antibody_control_1", "n_aa_substitutions": "3", "antibody neut standard count": 8231, "no-antibody neut standard count": 11134, "antibody count": 101551, "no-antibody count": 136776, "censored": false, "fraction not neutralized": 1.0043218723822913, "library_sample": "lib1 thaw-2_279C_0.00088_1", "antibody_concentration": 0.00088}, {"library": "lib1", "antibody_sample": "thaw-2_279C_0.00088_1", "no-antibody_sample": "thaw-2_no-antibody_control_1", "n_aa_substitutions": ">3", "antibody neut standard count": 8231, "no-antibody neut standard count": 11134, "antibody count": 122983, "no-antibody count": 163973, "censored": false, "fraction not neutralized": 1.014545095325487, "library_sample": "lib1 thaw-2_279C_0.00088_1", "antibody_concentration": 0.00088}, {"library": "lib1", "antibody_sample": "thaw-2_279C_0.00088_1", "no-antibody_sample": "thaw-2_no-antibody_control_1", "n_aa_substitutions": "0", "antibody neut standard count": 8231, "no-antibody neut standard count": 11134, "antibody count": 50804, "no-antibody count": 70060, "censored": true, "fraction not neutralized": 0.9809037382713736, "library_sample": "lib1 thaw-2_279C_0.00088_1", "antibody_concentration": 0.00088}, {"library": "lib1", "antibody_sample": "thaw-2_279C_0.00088_1", "no-antibody_sample": "thaw-2_no-antibody_control_1", "n_aa_substitutions": "1", "antibody neut standard count": 8231, "no-antibody neut standard count": 11134, "antibody count": 116272, "no-antibody count": 160117, "censored": true, "fraction not neutralized": 0.9822822892372151, "library_sample": "lib1 thaw-2_279C_0.00088_1", "antibody_concentration": 0.00088}, {"library": "lib1", "antibody_sample": "thaw-2_279C_0.00088_1", "no-antibody_sample": "thaw-2_no-antibody_control_1", "n_aa_substitutions": "2", "antibody neut standard count": 8231, "no-antibody neut standard count": 11134, "antibody count": 123860, "no-antibody count": 167901, "censored": true, "fraction not neutralized": 0.9978756110040318, "library_sample": "lib1 thaw-2_279C_0.00088_1", "antibody_concentration": 0.00088}, {"library": "lib1", "antibody_sample": "thaw-2_279C_0.00088_1", "no-antibody_sample": "thaw-2_no-antibody_control_1", "n_aa_substitutions": "3", "antibody neut standard count": 8231, "no-antibody neut standard count": 11134, "antibody count": 101551, "no-antibody count": 136776, "censored": true, "fraction not neutralized": 1.0, "library_sample": "lib1 thaw-2_279C_0.00088_1", "antibody_concentration": 0.00088}, {"library": "lib1", "antibody_sample": "thaw-2_279C_0.00088_1", "no-antibody_sample": "thaw-2_no-antibody_control_1", "n_aa_substitutions": ">3", "antibody neut standard count": 8231, "no-antibody neut standard count": 11134, "antibody count": 122983, "no-antibody count": 163973, "censored": true, "fraction not neutralized": 1.0, "library_sample": "lib1 thaw-2_279C_0.00088_1", "antibody_concentration": 0.00088}, {"library": "lib1", "antibody_sample": "thaw-2_279C_0.00088_2", "no-antibody_sample": "thaw-2_no-antibody_control_2", "n_aa_substitutions": "0", "antibody neut standard count": 8763, "no-antibody neut standard count": 9002, "antibody count": 48852, "no-antibody count": 60104, "censored": false, "fraction not neutralized": 0.8349590368820029, "library_sample": "lib1 thaw-2_279C_0.00088_2", "antibody_concentration": 0.00088}, {"library": "lib1", "antibody_sample": "thaw-2_279C_0.00088_2", "no-antibody_sample": "thaw-2_no-antibody_control_2", "n_aa_substitutions": "1", "antibody neut standard count": 8763, "no-antibody neut standard count": 9002, "antibody count": 108902, "no-antibody count": 137935, "censored": false, "fraction not neutralized": 0.8110498968538655, "library_sample": "lib1 thaw-2_279C_0.00088_2", "antibody_concentration": 0.00088}, {"library": "lib1", "antibody_sample": "thaw-2_279C_0.00088_2", "no-antibody_sample": "thaw-2_no-antibody_control_2", "n_aa_substitutions": "2", "antibody neut standard count": 8763, "no-antibody neut standard count": 9002, "antibody count": 117866, "no-antibody count": 146080, "censored": false, "fraction not neutralized": 0.8288653446689563, "library_sample": "lib1 thaw-2_279C_0.00088_2", "antibody_concentration": 0.00088}, {"library": "lib1", "antibody_sample": "thaw-2_279C_0.00088_2", "no-antibody_sample": "thaw-2_no-antibody_control_2", "n_aa_substitutions": "3", "antibody neut standard count": 8763, "no-antibody neut standard count": 9002, "antibody count": 96009, "no-antibody count": 119608, "censored": false, "fraction not neutralized": 0.824589717028611, "library_sample": "lib1 thaw-2_279C_0.00088_2", "antibody_concentration": 0.00088}, {"library": "lib1", "antibody_sample": "thaw-2_279C_0.00088_2", "no-antibody_sample": "thaw-2_no-antibody_control_2", "n_aa_substitutions": ">3", "antibody neut standard count": 8763, "no-antibody neut standard count": 9002, "antibody count": 115474, "no-antibody count": 140361, "censored": false, "fraction not neutralized": 0.845130846204407, "library_sample": "lib1 thaw-2_279C_0.00088_2", "antibody_concentration": 0.00088}, {"library": "lib1", "antibody_sample": "thaw-2_279C_0.00088_2", "no-antibody_sample": "thaw-2_no-antibody_control_2", "n_aa_substitutions": "0", "antibody neut standard count": 8763, "no-antibody neut standard count": 9002, "antibody count": 48852, "no-antibody count": 60104, "censored": true, "fraction not neutralized": 0.8349590368820029, "library_sample": "lib1 thaw-2_279C_0.00088_2", "antibody_concentration": 0.00088}, {"library": "lib1", "antibody_sample": "thaw-2_279C_0.00088_2", "no-antibody_sample": "thaw-2_no-antibody_control_2", "n_aa_substitutions": "1", "antibody neut standard count": 8763, "no-antibody neut standard count": 9002, "antibody count": 108902, "no-antibody count": 137935, "censored": true, "fraction not neutralized": 0.8110498968538655, "library_sample": "lib1 thaw-2_279C_0.00088_2", "antibody_concentration": 0.00088}, {"library": "lib1", "antibody_sample": "thaw-2_279C_0.00088_2", "no-antibody_sample": "thaw-2_no-antibody_control_2", "n_aa_substitutions": "2", "antibody neut standard count": 8763, "no-antibody neut standard count": 9002, "antibody count": 117866, "no-antibody count": 146080, "censored": true, "fraction not neutralized": 0.8288653446689563, "library_sample": "lib1 thaw-2_279C_0.00088_2", "antibody_concentration": 0.00088}, {"library": "lib1", "antibody_sample": "thaw-2_279C_0.00088_2", "no-antibody_sample": "thaw-2_no-antibody_control_2", "n_aa_substitutions": "3", "antibody neut standard count": 8763, "no-antibody neut standard count": 9002, "antibody count": 96009, "no-antibody count": 119608, "censored": true, "fraction not neutralized": 0.824589717028611, "library_sample": "lib1 thaw-2_279C_0.00088_2", "antibody_concentration": 0.00088}, {"library": "lib1", "antibody_sample": "thaw-2_279C_0.00088_2", "no-antibody_sample": "thaw-2_no-antibody_control_2", "n_aa_substitutions": ">3", "antibody neut standard count": 8763, "no-antibody neut standard count": 9002, "antibody count": 115474, "no-antibody count": 140361, "censored": true, "fraction not neutralized": 0.845130846204407, "library_sample": "lib1 thaw-2_279C_0.00088_2", "antibody_concentration": 0.00088}, {"library": "lib1", "antibody_sample": "thaw-2_279C_0.0035_1", "no-antibody_sample": "thaw-2_no-antibody_control_1", "n_aa_substitutions": "0", "antibody neut standard count": 9298, "no-antibody neut standard count": 11134, "antibody count": 43948, "no-antibody count": 70060, "censored": false, "fraction not neutralized": 0.7511568948644762, "library_sample": "lib1 thaw-2_279C_0.0035_1", "antibody_concentration": 0.0035}, {"library": "lib1", "antibody_sample": "thaw-2_279C_0.0035_1", "no-antibody_sample": "thaw-2_no-antibody_control_1", "n_aa_substitutions": "1", "antibody neut standard count": 9298, "no-antibody neut standard count": 11134, "antibody count": 101277, "no-antibody count": 160117, "censored": false, "fraction not neutralized": 0.7574170182955844, "library_sample": "lib1 thaw-2_279C_0.0035_1", "antibody_concentration": 0.0035}, {"library": "lib1", "antibody_sample": "thaw-2_279C_0.0035_1", "no-antibody_sample": "thaw-2_no-antibody_control_1", "n_aa_substitutions": "2", "antibody neut standard count": 9298, "no-antibody neut standard count": 11134, "antibody count": 110420, "no-antibody count": 167901, "censored": false, "fraction not neutralized": 0.7875101049807529, "library_sample": "lib1 thaw-2_279C_0.0035_1", "antibody_concentration": 0.0035}, {"library": "lib1", "antibody_sample": "thaw-2_279C_0.0035_1", "no-antibody_sample": "thaw-2_no-antibody_control_1", "n_aa_substitutions": "3", "antibody neut standard count": 9298, "no-antibody neut standard count": 11134, "antibody count": 89376, "no-antibody count": 136776, "censored": false, "fraction not neutralized": 0.7824789992515848, "library_sample": "lib1 thaw-2_279C_0.0035_1", "antibody_concentration": 0.0035}, {"library": "lib1", "antibody_sample": "thaw-2_279C_0.0035_1", "no-antibody_sample": "thaw-2_no-antibody_control_1", "n_aa_substitutions": ">3", "antibody neut standard count": 9298, "no-antibody neut standard count": 11134, "antibody count": 109758, "no-antibody count": 163973, "censored": false, "fraction not neutralized": 0.8015405854116314, "library_sample": "lib1 thaw-2_279C_0.0035_1", "antibody_concentration": 0.0035}, {"library": "lib1", "antibody_sample": "thaw-2_279C_0.0035_1", "no-antibody_sample": "thaw-2_no-antibody_control_1", "n_aa_substitutions": "0", "antibody neut standard count": 9298, "no-antibody neut standard count": 11134, "antibody count": 43948, "no-antibody count": 70060, "censored": true, "fraction not neutralized": 0.7511568948644762, "library_sample": "lib1 thaw-2_279C_0.0035_1", "antibody_concentration": 0.0035}, {"library": "lib1", "antibody_sample": "thaw-2_279C_0.0035_1", "no-antibody_sample": "thaw-2_no-antibody_control_1", "n_aa_substitutions": "1", "antibody neut standard count": 9298, "no-antibody neut standard count": 11134, "antibody count": 101277, "no-antibody count": 160117, "censored": true, "fraction not neutralized": 0.7574170182955844, "library_sample": "lib1 thaw-2_279C_0.0035_1", "antibody_concentration": 0.0035}, {"library": "lib1", "antibody_sample": "thaw-2_279C_0.0035_1", "no-antibody_sample": "thaw-2_no-antibody_control_1", "n_aa_substitutions": "2", "antibody neut standard count": 9298, "no-antibody neut standard count": 11134, "antibody count": 110420, "no-antibody count": 167901, "censored": true, "fraction not neutralized": 0.7875101049807529, "library_sample": "lib1 thaw-2_279C_0.0035_1", "antibody_concentration": 0.0035}, {"library": "lib1", "antibody_sample": "thaw-2_279C_0.0035_1", "no-antibody_sample": "thaw-2_no-antibody_control_1", "n_aa_substitutions": "3", "antibody neut standard count": 9298, "no-antibody neut standard count": 11134, "antibody count": 89376, "no-antibody count": 136776, "censored": true, "fraction not neutralized": 0.7824789992515848, "library_sample": "lib1 thaw-2_279C_0.0035_1", "antibody_concentration": 0.0035}, {"library": "lib1", "antibody_sample": "thaw-2_279C_0.0035_1", "no-antibody_sample": "thaw-2_no-antibody_control_1", "n_aa_substitutions": ">3", "antibody neut standard count": 9298, "no-antibody neut standard count": 11134, "antibody count": 109758, "no-antibody count": 163973, "censored": true, "fraction not neutralized": 0.8015405854116314, "library_sample": "lib1 thaw-2_279C_0.0035_1", "antibody_concentration": 0.0035}, {"library": "lib1", "antibody_sample": "thaw-2_279C_0.0035_2", "no-antibody_sample": "thaw-2_no-antibody_control_2", "n_aa_substitutions": "0", "antibody neut standard count": 9394, "no-antibody neut standard count": 9002, "antibody count": 37931, "no-antibody count": 60104, "censored": false, "fraction not neutralized": 0.6047548630560481, "library_sample": "lib1 thaw-2_279C_0.0035_2", "antibody_concentration": 0.0035}, {"library": "lib1", "antibody_sample": "thaw-2_279C_0.0035_2", "no-antibody_sample": "thaw-2_no-antibody_control_2", "n_aa_substitutions": "1", "antibody neut standard count": 9394, "no-antibody neut standard count": 9002, "antibody count": 88567, "no-antibody count": 137935, "censored": false, "fraction not neutralized": 0.6152985728336913, "library_sample": "lib1 thaw-2_279C_0.0035_2", "antibody_concentration": 0.0035}, {"library": "lib1", "antibody_sample": "thaw-2_279C_0.0035_2", "no-antibody_sample": "thaw-2_no-antibody_control_2", "n_aa_substitutions": "2", "antibody neut standard count": 9394, "no-antibody neut standard count": 9002, "antibody count": 96307, "no-antibody count": 146080, "censored": false, "fraction not neutralized": 0.6317649782166195, "library_sample": "lib1 thaw-2_279C_0.0035_2", "antibody_concentration": 0.0035}, {"library": "lib1", "antibody_sample": "thaw-2_279C_0.0035_2", "no-antibody_sample": "thaw-2_no-antibody_control_2", "n_aa_substitutions": "3", "antibody neut standard count": 9394, "no-antibody neut standard count": 9002, "antibody count": 79663, "no-antibody count": 119608, "censored": false, "fraction not neutralized": 0.638241267723944, "library_sample": "lib1 thaw-2_279C_0.0035_2", "antibody_concentration": 0.0035}, {"library": "lib1", "antibody_sample": "thaw-2_279C_0.0035_2", "no-antibody_sample": "thaw-2_no-antibody_control_2", "n_aa_substitutions": ">3", "antibody neut standard count": 9394, "no-antibody neut standard count": 9002, "antibody count": 94598, "no-antibody count": 140361, "censored": false, "fraction not neutralized": 0.6458385340224103, "library_sample": "lib1 thaw-2_279C_0.0035_2", "antibody_concentration": 0.0035}, {"library": "lib1", "antibody_sample": "thaw-2_279C_0.0035_2", "no-antibody_sample": "thaw-2_no-antibody_control_2", "n_aa_substitutions": "0", "antibody neut standard count": 9394, "no-antibody neut standard count": 9002, "antibody count": 37931, "no-antibody count": 60104, "censored": true, "fraction not neutralized": 0.6047548630560481, "library_sample": "lib1 thaw-2_279C_0.0035_2", "antibody_concentration": 0.0035}, {"library": "lib1", "antibody_sample": "thaw-2_279C_0.0035_2", "no-antibody_sample": "thaw-2_no-antibody_control_2", "n_aa_substitutions": "1", "antibody neut standard count": 9394, "no-antibody neut standard count": 9002, "antibody count": 88567, "no-antibody count": 137935, "censored": true, "fraction not neutralized": 0.6152985728336913, "library_sample": "lib1 thaw-2_279C_0.0035_2", "antibody_concentration": 0.0035}, {"library": "lib1", "antibody_sample": "thaw-2_279C_0.0035_2", "no-antibody_sample": "thaw-2_no-antibody_control_2", "n_aa_substitutions": "2", "antibody neut standard count": 9394, "no-antibody neut standard count": 9002, "antibody count": 96307, "no-antibody count": 146080, "censored": true, "fraction not neutralized": 0.6317649782166195, "library_sample": "lib1 thaw-2_279C_0.0035_2", "antibody_concentration": 0.0035}, {"library": "lib1", "antibody_sample": "thaw-2_279C_0.0035_2", "no-antibody_sample": "thaw-2_no-antibody_control_2", "n_aa_substitutions": "3", "antibody neut standard count": 9394, "no-antibody neut standard count": 9002, "antibody count": 79663, "no-antibody count": 119608, "censored": true, "fraction not neutralized": 0.638241267723944, "library_sample": "lib1 thaw-2_279C_0.0035_2", "antibody_concentration": 0.0035}, {"library": "lib1", "antibody_sample": "thaw-2_279C_0.0035_2", "no-antibody_sample": "thaw-2_no-antibody_control_2", "n_aa_substitutions": ">3", "antibody neut standard count": 9394, "no-antibody neut standard count": 9002, "antibody count": 94598, "no-antibody count": 140361, "censored": true, "fraction not neutralized": 0.6458385340224103, "library_sample": "lib1 thaw-2_279C_0.0035_2", "antibody_concentration": 0.0035}, {"library": "lib1", "antibody_sample": "thaw-2_279C_0.014_1", "no-antibody_sample": "thaw-2_no-antibody_control_1", "n_aa_substitutions": "0", "antibody neut standard count": 67940, "no-antibody neut standard count": 11134, "antibody count": 22880, "no-antibody count": 70060, "censored": false, "fraction not neutralized": 0.05351944012663858, "library_sample": "lib1 thaw-2_279C_0.014_1", "antibody_concentration": 0.014}, {"library": "lib1", "antibody_sample": "thaw-2_279C_0.014_1", "no-antibody_sample": "thaw-2_no-antibody_control_1", "n_aa_substitutions": "1", "antibody neut standard count": 67940, "no-antibody neut standard count": 11134, "antibody count": 64919, "no-antibody count": 160117, "censored": false, "fraction not neutralized": 0.0664446550969171, "library_sample": "lib1 thaw-2_279C_0.014_1", "antibody_concentration": 0.014}, {"library": "lib1", "antibody_sample": "thaw-2_279C_0.014_1", "no-antibody_sample": "thaw-2_no-antibody_control_1", "n_aa_substitutions": "2", "antibody neut standard count": 67940, "no-antibody neut standard count": 11134, "antibody count": 86016, "no-antibody count": 167901, "censored": false, "fraction not neutralized": 0.08395597979988408, "library_sample": "lib1 thaw-2_279C_0.014_1", "antibody_concentration": 0.014}, {"library": "lib1", "antibody_sample": "thaw-2_279C_0.014_1", "no-antibody_sample": "thaw-2_no-antibody_control_1", "n_aa_substitutions": "3", "antibody neut standard count": 67940, "no-antibody neut standard count": 11134, "antibody count": 90541, "no-antibody count": 136776, "censored": false, "fraction not neutralized": 0.10848284410159359, "library_sample": "lib1 thaw-2_279C_0.014_1", "antibody_concentration": 0.014}, {"library": "lib1", "antibody_sample": "thaw-2_279C_0.014_1", "no-antibody_sample": "thaw-2_no-antibody_control_1", "n_aa_substitutions": ">3", "antibody neut standard count": 67940, "no-antibody neut standard count": 11134, "antibody count": 150231, "no-antibody count": 163973, "censored": false, "fraction not neutralized": 0.15014569690827403, "library_sample": "lib1 thaw-2_279C_0.014_1", "antibody_concentration": 0.014}, {"library": "lib1", "antibody_sample": "thaw-2_279C_0.014_1", "no-antibody_sample": "thaw-2_no-antibody_control_1", "n_aa_substitutions": "0", "antibody neut standard count": 67940, "no-antibody neut standard count": 11134, "antibody count": 22880, "no-antibody count": 70060, "censored": true, "fraction not neutralized": 0.05351944012663858, "library_sample": "lib1 thaw-2_279C_0.014_1", "antibody_concentration": 0.014}, {"library": "lib1", "antibody_sample": "thaw-2_279C_0.014_1", "no-antibody_sample": "thaw-2_no-antibody_control_1", "n_aa_substitutions": "1", "antibody neut standard count": 67940, "no-antibody neut standard count": 11134, "antibody count": 64919, "no-antibody count": 160117, "censored": true, "fraction not neutralized": 0.0664446550969171, "library_sample": "lib1 thaw-2_279C_0.014_1", "antibody_concentration": 0.014}, {"library": "lib1", "antibody_sample": "thaw-2_279C_0.014_1", "no-antibody_sample": "thaw-2_no-antibody_control_1", "n_aa_substitutions": "2", "antibody neut standard count": 67940, "no-antibody neut standard count": 11134, "antibody count": 86016, "no-antibody count": 167901, "censored": true, "fraction not neutralized": 0.08395597979988408, "library_sample": "lib1 thaw-2_279C_0.014_1", "antibody_concentration": 0.014}, {"library": "lib1", "antibody_sample": "thaw-2_279C_0.014_1", "no-antibody_sample": "thaw-2_no-antibody_control_1", "n_aa_substitutions": "3", "antibody neut standard count": 67940, "no-antibody neut standard count": 11134, "antibody count": 90541, "no-antibody count": 136776, "censored": true, "fraction not neutralized": 0.10848284410159359, "library_sample": "lib1 thaw-2_279C_0.014_1", "antibody_concentration": 0.014}, {"library": "lib1", "antibody_sample": "thaw-2_279C_0.014_1", "no-antibody_sample": "thaw-2_no-antibody_control_1", "n_aa_substitutions": ">3", "antibody neut standard count": 67940, "no-antibody neut standard count": 11134, "antibody count": 150231, "no-antibody count": 163973, "censored": true, "fraction not neutralized": 0.15014569690827403, "library_sample": "lib1 thaw-2_279C_0.014_1", "antibody_concentration": 0.014}, {"library": "lib1", "antibody_sample": "thaw-2_279C_0.014_2", "no-antibody_sample": "thaw-2_no-antibody_control_2", "n_aa_substitutions": "0", "antibody neut standard count": 60115, "no-antibody neut standard count": 9002, "antibody count": 17063, "no-antibody count": 60104, "censored": false, "fraction not neutralized": 0.04251167061348839, "library_sample": "lib1 thaw-2_279C_0.014_2", "antibody_concentration": 0.014}, {"library": "lib1", "antibody_sample": "thaw-2_279C_0.014_2", "no-antibody_sample": "thaw-2_no-antibody_control_2", "n_aa_substitutions": "1", "antibody neut standard count": 60115, "no-antibody neut standard count": 9002, "antibody count": 50973, "no-antibody count": 137935, "censored": false, "fraction not neutralized": 0.055337797851419984, "library_sample": "lib1 thaw-2_279C_0.014_2", "antibody_concentration": 0.014}, {"library": "lib1", "antibody_sample": "thaw-2_279C_0.014_2", "no-antibody_sample": "thaw-2_no-antibody_control_2", "n_aa_substitutions": "2", "antibody neut standard count": 60115, "no-antibody neut standard count": 9002, "antibody count": 69456, "no-antibody count": 146080, "censored": false, "fraction not neutralized": 0.07119920845396817, "library_sample": "lib1 thaw-2_279C_0.014_2", "antibody_concentration": 0.014}, {"library": "lib1", "antibody_sample": "thaw-2_279C_0.014_2", "no-antibody_sample": "thaw-2_no-antibody_control_2", "n_aa_substitutions": "3", "antibody neut standard count": 60115, "no-antibody neut standard count": 9002, "antibody count": 67261, "no-antibody count": 119608, "censored": false, "fraction not neutralized": 0.08420914319722951, "library_sample": "lib1 thaw-2_279C_0.014_2", "antibody_concentration": 0.014}, {"library": "lib1", "antibody_sample": "thaw-2_279C_0.014_2", "no-antibody_sample": "thaw-2_no-antibody_control_2", "n_aa_substitutions": ">3", "antibody neut standard count": 60115, "no-antibody neut standard count": 9002, "antibody count": 124178, "no-antibody count": 140361, "censored": false, "fraction not neutralized": 0.13248123388690544, "library_sample": "lib1 thaw-2_279C_0.014_2", "antibody_concentration": 0.014}, {"library": "lib1", "antibody_sample": "thaw-2_279C_0.014_2", "no-antibody_sample": "thaw-2_no-antibody_control_2", "n_aa_substitutions": "0", "antibody neut standard count": 60115, "no-antibody neut standard count": 9002, "antibody count": 17063, "no-antibody count": 60104, "censored": true, "fraction not neutralized": 0.04251167061348839, "library_sample": "lib1 thaw-2_279C_0.014_2", "antibody_concentration": 0.014}, {"library": "lib1", "antibody_sample": "thaw-2_279C_0.014_2", "no-antibody_sample": "thaw-2_no-antibody_control_2", "n_aa_substitutions": "1", "antibody neut standard count": 60115, "no-antibody neut standard count": 9002, "antibody count": 50973, "no-antibody count": 137935, "censored": true, "fraction not neutralized": 0.055337797851419984, "library_sample": "lib1 thaw-2_279C_0.014_2", "antibody_concentration": 0.014}, {"library": "lib1", "antibody_sample": "thaw-2_279C_0.014_2", "no-antibody_sample": "thaw-2_no-antibody_control_2", "n_aa_substitutions": "2", "antibody neut standard count": 60115, "no-antibody neut standard count": 9002, "antibody count": 69456, "no-antibody count": 146080, "censored": true, "fraction not neutralized": 0.07119920845396817, "library_sample": "lib1 thaw-2_279C_0.014_2", "antibody_concentration": 0.014}, {"library": "lib1", "antibody_sample": "thaw-2_279C_0.014_2", "no-antibody_sample": "thaw-2_no-antibody_control_2", "n_aa_substitutions": "3", "antibody neut standard count": 60115, "no-antibody neut standard count": 9002, "antibody count": 67261, "no-antibody count": 119608, "censored": true, "fraction not neutralized": 0.08420914319722951, "library_sample": "lib1 thaw-2_279C_0.014_2", "antibody_concentration": 0.014}, {"library": "lib1", "antibody_sample": "thaw-2_279C_0.014_2", "no-antibody_sample": "thaw-2_no-antibody_control_2", "n_aa_substitutions": ">3", "antibody neut standard count": 60115, "no-antibody neut standard count": 9002, "antibody count": 124178, "no-antibody count": 140361, "censored": true, "fraction not neutralized": 0.13248123388690544, "library_sample": "lib1 thaw-2_279C_0.014_2", "antibody_concentration": 0.014}, {"library": "lib2", "antibody_sample": "thaw-1_REGN10933_0.037_1", "no-antibody_sample": "thaw-1_no-antibody_control_1", "n_aa_substitutions": "0", "antibody neut standard count": 14003, "no-antibody neut standard count": 11144, "antibody count": 121386, "no-antibody count": 150802, "censored": false, "fraction not neutralized": 0.6405920044323223, "library_sample": "lib2 thaw-1_REGN10933_0.037_1", "antibody_concentration": 0.037}, {"library": "lib2", "antibody_sample": "thaw-1_REGN10933_0.037_1", "no-antibody_sample": "thaw-1_no-antibody_control_1", "n_aa_substitutions": "1", "antibody neut standard count": 14003, "no-antibody neut standard count": 11144, "antibody count": 267010, "no-antibody count": 319332, "censored": false, "fraction not neutralized": 0.6654341734628982, "library_sample": "lib2 thaw-1_REGN10933_0.037_1", "antibody_concentration": 0.037}, {"library": "lib2", "antibody_sample": "thaw-1_REGN10933_0.037_1", "no-antibody_sample": "thaw-1_no-antibody_control_1", "n_aa_substitutions": "2", "antibody neut standard count": 14003, "no-antibody neut standard count": 11144, "antibody count": 244521, "no-antibody count": 283629, "censored": false, "fraction not neutralized": 0.6860970374654622, "library_sample": "lib2 thaw-1_REGN10933_0.037_1", "antibody_concentration": 0.037}, {"library": "lib2", "antibody_sample": "thaw-1_REGN10933_0.037_1", "no-antibody_sample": "thaw-1_no-antibody_control_1", "n_aa_substitutions": "3", "antibody neut standard count": 14003, "no-antibody neut standard count": 11144, "antibody count": 162512, "no-antibody count": 189903, "censored": false, "fraction not neutralized": 0.6810415740388874, "library_sample": "lib2 thaw-1_REGN10933_0.037_1", "antibody_concentration": 0.037}, {"library": "lib2", "antibody_sample": "thaw-1_REGN10933_0.037_1", "no-antibody_sample": "thaw-1_no-antibody_control_1", "n_aa_substitutions": ">3", "antibody neut standard count": 14003, "no-antibody neut standard count": 11144, "antibody count": 111435, "no-antibody count": 122988, "censored": false, "fraction not neutralized": 0.7210724334491779, "library_sample": "lib2 thaw-1_REGN10933_0.037_1", "antibody_concentration": 0.037}, {"library": "lib2", "antibody_sample": "thaw-1_REGN10933_0.037_1", "no-antibody_sample": "thaw-1_no-antibody_control_1", "n_aa_substitutions": "0", "antibody neut standard count": 14003, "no-antibody neut standard count": 11144, "antibody count": 121386, "no-antibody count": 150802, "censored": true, "fraction not neutralized": 0.6405920044323223, "library_sample": "lib2 thaw-1_REGN10933_0.037_1", "antibody_concentration": 0.037}, {"library": "lib2", "antibody_sample": "thaw-1_REGN10933_0.037_1", "no-antibody_sample": "thaw-1_no-antibody_control_1", "n_aa_substitutions": "1", "antibody neut standard count": 14003, "no-antibody neut standard count": 11144, "antibody count": 267010, "no-antibody count": 319332, "censored": true, "fraction not neutralized": 0.6654341734628982, "library_sample": "lib2 thaw-1_REGN10933_0.037_1", "antibody_concentration": 0.037}, {"library": "lib2", "antibody_sample": "thaw-1_REGN10933_0.037_1", "no-antibody_sample": "thaw-1_no-antibody_control_1", "n_aa_substitutions": "2", "antibody neut standard count": 14003, "no-antibody neut standard count": 11144, "antibody count": 244521, "no-antibody count": 283629, "censored": true, "fraction not neutralized": 0.6860970374654622, "library_sample": "lib2 thaw-1_REGN10933_0.037_1", "antibody_concentration": 0.037}, {"library": "lib2", "antibody_sample": "thaw-1_REGN10933_0.037_1", "no-antibody_sample": "thaw-1_no-antibody_control_1", "n_aa_substitutions": "3", "antibody neut standard count": 14003, "no-antibody neut standard count": 11144, "antibody count": 162512, "no-antibody count": 189903, "censored": true, "fraction not neutralized": 0.6810415740388874, "library_sample": "lib2 thaw-1_REGN10933_0.037_1", "antibody_concentration": 0.037}, {"library": "lib2", "antibody_sample": "thaw-1_REGN10933_0.037_1", "no-antibody_sample": "thaw-1_no-antibody_control_1", "n_aa_substitutions": ">3", "antibody neut standard count": 14003, "no-antibody neut standard count": 11144, "antibody count": 111435, "no-antibody count": 122988, "censored": true, "fraction not neutralized": 0.7210724334491779, "library_sample": "lib2 thaw-1_REGN10933_0.037_1", "antibody_concentration": 0.037}, {"library": "lib2", "antibody_sample": "thaw-1_REGN10933_0.037_2", "no-antibody_sample": "thaw-1_no-antibody_control_2", "n_aa_substitutions": "0", "antibody neut standard count": 12780, "no-antibody neut standard count": 10877, "antibody count": 69252, "no-antibody count": 174569, "censored": false, "fraction not neutralized": 0.3376318986234562, "library_sample": "lib2 thaw-1_REGN10933_0.037_2", "antibody_concentration": 0.037}, {"library": "lib2", "antibody_sample": "thaw-1_REGN10933_0.037_2", "no-antibody_sample": "thaw-1_no-antibody_control_2", "n_aa_substitutions": "1", "antibody neut standard count": 12780, "no-antibody neut standard count": 10877, "antibody count": 144770, "no-antibody count": 361718, "censored": false, "fraction not neutralized": 0.3406330068847847, "library_sample": "lib2 thaw-1_REGN10933_0.037_2", "antibody_concentration": 0.037}, {"library": "lib2", "antibody_sample": "thaw-1_REGN10933_0.037_2", "no-antibody_sample": "thaw-1_no-antibody_control_2", "n_aa_substitutions": "2", "antibody neut standard count": 12780, "no-antibody neut standard count": 10877, "antibody count": 140781, "no-antibody count": 331201, "censored": false, "fraction not neutralized": 0.3617684432951393, "library_sample": "lib2 thaw-1_REGN10933_0.037_2", "antibody_concentration": 0.037}, {"library": "lib2", "antibody_sample": "thaw-1_REGN10933_0.037_2", "no-antibody_sample": "thaw-1_no-antibody_control_2", "n_aa_substitutions": "3", "antibody neut standard count": 12780, "no-antibody neut standard count": 10877, "antibody count": 106721, "no-antibody count": 219133, "censored": false, "fraction not neutralized": 0.41449603101172927, "library_sample": "lib2 thaw-1_REGN10933_0.037_2", "antibody_concentration": 0.037}, {"library": "lib2", "antibody_sample": "thaw-1_REGN10933_0.037_2", "no-antibody_sample": "thaw-1_no-antibody_control_2", "n_aa_substitutions": ">3", "antibody neut standard count": 12780, "no-antibody neut standard count": 10877, "antibody count": 75103, "no-antibody count": 136249, "censored": false, "fraction not neutralized": 0.4691397548383035, "library_sample": "lib2 thaw-1_REGN10933_0.037_2", "antibody_concentration": 0.037}, {"library": "lib2", "antibody_sample": "thaw-1_REGN10933_0.037_2", "no-antibody_sample": "thaw-1_no-antibody_control_2", "n_aa_substitutions": "0", "antibody neut standard count": 12780, "no-antibody neut standard count": 10877, "antibody count": 69252, "no-antibody count": 174569, "censored": true, "fraction not neutralized": 0.3376318986234562, "library_sample": "lib2 thaw-1_REGN10933_0.037_2", "antibody_concentration": 0.037}, {"library": "lib2", "antibody_sample": "thaw-1_REGN10933_0.037_2", "no-antibody_sample": "thaw-1_no-antibody_control_2", "n_aa_substitutions": "1", "antibody neut standard count": 12780, "no-antibody neut standard count": 10877, "antibody count": 144770, "no-antibody count": 361718, "censored": true, "fraction not neutralized": 0.3406330068847847, "library_sample": "lib2 thaw-1_REGN10933_0.037_2", "antibody_concentration": 0.037}, {"library": "lib2", "antibody_sample": "thaw-1_REGN10933_0.037_2", "no-antibody_sample": "thaw-1_no-antibody_control_2", "n_aa_substitutions": "2", "antibody neut standard count": 12780, "no-antibody neut standard count": 10877, "antibody count": 140781, "no-antibody count": 331201, "censored": true, "fraction not neutralized": 0.3617684432951393, "library_sample": "lib2 thaw-1_REGN10933_0.037_2", "antibody_concentration": 0.037}, {"library": "lib2", "antibody_sample": "thaw-1_REGN10933_0.037_2", "no-antibody_sample": "thaw-1_no-antibody_control_2", "n_aa_substitutions": "3", "antibody neut standard count": 12780, "no-antibody neut standard count": 10877, "antibody count": 106721, "no-antibody count": 219133, "censored": true, "fraction not neutralized": 0.41449603101172927, "library_sample": "lib2 thaw-1_REGN10933_0.037_2", "antibody_concentration": 0.037}, {"library": "lib2", "antibody_sample": "thaw-1_REGN10933_0.037_2", "no-antibody_sample": "thaw-1_no-antibody_control_2", "n_aa_substitutions": ">3", "antibody neut standard count": 12780, "no-antibody neut standard count": 10877, "antibody count": 75103, "no-antibody count": 136249, "censored": true, "fraction not neutralized": 0.4691397548383035, "library_sample": "lib2 thaw-1_REGN10933_0.037_2", "antibody_concentration": 0.037}, {"library": "lib2", "antibody_sample": "thaw-1_REGN10933_0.15_1", "no-antibody_sample": "thaw-1_no-antibody_control_1", "n_aa_substitutions": "0", "antibody neut standard count": 22879, "no-antibody neut standard count": 11144, "antibody count": 105518, "no-antibody count": 150802, "censored": false, "fraction not neutralized": 0.34081877779061115, "library_sample": "lib2 thaw-1_REGN10933_0.15_1", "antibody_concentration": 0.15}, {"library": "lib2", "antibody_sample": "thaw-1_REGN10933_0.15_1", "no-antibody_sample": "thaw-1_no-antibody_control_1", "n_aa_substitutions": "1", "antibody neut standard count": 22879, "no-antibody neut standard count": 11144, "antibody count": 227139, "no-antibody count": 319332, "censored": false, "fraction not neutralized": 0.34646018546012974, "library_sample": "lib2 thaw-1_REGN10933_0.15_1", "antibody_concentration": 0.15}, {"library": "lib2", "antibody_sample": "thaw-1_REGN10933_0.15_1", "no-antibody_sample": "thaw-1_no-antibody_control_1", "n_aa_substitutions": "2", "antibody neut standard count": 22879, "no-antibody neut standard count": 11144, "antibody count": 224786, "no-antibody count": 283629, "censored": false, "fraction not neutralized": 0.38603145221490215, "library_sample": "lib2 thaw-1_REGN10933_0.15_1", "antibody_concentration": 0.15}, {"library": "lib2", "antibody_sample": "thaw-1_REGN10933_0.15_1", "no-antibody_sample": "thaw-1_no-antibody_control_1", "n_aa_substitutions": "3", "antibody neut standard count": 22879, "no-antibody neut standard count": 11144, "antibody count": 156451, "no-antibody count": 189903, "censored": false, "fraction not neutralized": 0.4012828349021588, "library_sample": "lib2 thaw-1_REGN10933_0.15_1", "antibody_concentration": 0.15}, {"library": "lib2", "antibody_sample": "thaw-1_REGN10933_0.15_1", "no-antibody_sample": "thaw-1_no-antibody_control_1", "n_aa_substitutions": ">3", "antibody neut standard count": 22879, "no-antibody neut standard count": 11144, "antibody count": 108684, "no-antibody count": 122988, "censored": false, "fraction not neutralized": 0.4304343674746719, "library_sample": "lib2 thaw-1_REGN10933_0.15_1", "antibody_concentration": 0.15}, {"library": "lib2", "antibody_sample": "thaw-1_REGN10933_0.15_1", "no-antibody_sample": "thaw-1_no-antibody_control_1", "n_aa_substitutions": "0", "antibody neut standard count": 22879, "no-antibody neut standard count": 11144, "antibody count": 105518, "no-antibody count": 150802, "censored": true, "fraction not neutralized": 0.34081877779061115, "library_sample": "lib2 thaw-1_REGN10933_0.15_1", "antibody_concentration": 0.15}, {"library": "lib2", "antibody_sample": "thaw-1_REGN10933_0.15_1", "no-antibody_sample": "thaw-1_no-antibody_control_1", "n_aa_substitutions": "1", "antibody neut standard count": 22879, "no-antibody neut standard count": 11144, "antibody count": 227139, "no-antibody count": 319332, "censored": true, "fraction not neutralized": 0.34646018546012974, "library_sample": "lib2 thaw-1_REGN10933_0.15_1", "antibody_concentration": 0.15}, {"library": "lib2", "antibody_sample": "thaw-1_REGN10933_0.15_1", "no-antibody_sample": "thaw-1_no-antibody_control_1", "n_aa_substitutions": "2", "antibody neut standard count": 22879, "no-antibody neut standard count": 11144, "antibody count": 224786, "no-antibody count": 283629, "censored": true, "fraction not neutralized": 0.38603145221490215, "library_sample": "lib2 thaw-1_REGN10933_0.15_1", "antibody_concentration": 0.15}, {"library": "lib2", "antibody_sample": "thaw-1_REGN10933_0.15_1", "no-antibody_sample": "thaw-1_no-antibody_control_1", "n_aa_substitutions": "3", "antibody neut standard count": 22879, "no-antibody neut standard count": 11144, "antibody count": 156451, "no-antibody count": 189903, "censored": true, "fraction not neutralized": 0.4012828349021588, "library_sample": "lib2 thaw-1_REGN10933_0.15_1", "antibody_concentration": 0.15}, {"library": "lib2", "antibody_sample": "thaw-1_REGN10933_0.15_1", "no-antibody_sample": "thaw-1_no-antibody_control_1", "n_aa_substitutions": ">3", "antibody neut standard count": 22879, "no-antibody neut standard count": 11144, "antibody count": 108684, "no-antibody count": 122988, "censored": true, "fraction not neutralized": 0.4304343674746719, "library_sample": "lib2 thaw-1_REGN10933_0.15_1", "antibody_concentration": 0.15}, {"library": "lib2", "antibody_sample": "thaw-1_REGN10933_0.15_2", "no-antibody_sample": "thaw-1_no-antibody_control_2", "n_aa_substitutions": "0", "antibody neut standard count": 20040, "no-antibody neut standard count": 10877, "antibody count": 101205, "no-antibody count": 174569, "censored": false, "fraction not neutralized": 0.3146634184386299, "library_sample": "lib2 thaw-1_REGN10933_0.15_2", "antibody_concentration": 0.15}, {"library": "lib2", "antibody_sample": "thaw-1_REGN10933_0.15_2", "no-antibody_sample": "thaw-1_no-antibody_control_2", "n_aa_substitutions": "1", "antibody neut standard count": 20040, "no-antibody neut standard count": 10877, "antibody count": 205185, "no-antibody count": 361718, "censored": false, "fraction not neutralized": 0.30788384319832574, "library_sample": "lib2 thaw-1_REGN10933_0.15_2", "antibody_concentration": 0.15}, {"library": "lib2", "antibody_sample": "thaw-1_REGN10933_0.15_2", "no-antibody_sample": "thaw-1_no-antibody_control_2", "n_aa_substitutions": "2", "antibody neut standard count": 20040, "no-antibody neut standard count": 10877, "antibody count": 202587, "no-antibody count": 331201, "censored": false, "fraction not neutralized": 0.3319948487420134, "library_sample": "lib2 thaw-1_REGN10933_0.15_2", "antibody_concentration": 0.15}, {"library": "lib2", "antibody_sample": "thaw-1_REGN10933_0.15_2", "no-antibody_sample": "thaw-1_no-antibody_control_2", "n_aa_substitutions": "3", "antibody neut standard count": 20040, "no-antibody neut standard count": 10877, "antibody count": 134660, "no-antibody count": 219133, "censored": false, "fraction not neutralized": 0.3335356321168181, "library_sample": "lib2 thaw-1_REGN10933_0.15_2", "antibody_concentration": 0.15}, {"library": "lib2", "antibody_sample": "thaw-1_REGN10933_0.15_2", "no-antibody_sample": "thaw-1_no-antibody_control_2", "n_aa_substitutions": ">3", "antibody neut standard count": 20040, "no-antibody neut standard count": 10877, "antibody count": 98279, "no-antibody count": 136249, "censored": false, "fraction not neutralized": 0.3915063556510346, "library_sample": "lib2 thaw-1_REGN10933_0.15_2", "antibody_concentration": 0.15}, {"library": "lib2", "antibody_sample": "thaw-1_REGN10933_0.15_2", "no-antibody_sample": "thaw-1_no-antibody_control_2", "n_aa_substitutions": "0", "antibody neut standard count": 20040, "no-antibody neut standard count": 10877, "antibody count": 101205, "no-antibody count": 174569, "censored": true, "fraction not neutralized": 0.3146634184386299, "library_sample": "lib2 thaw-1_REGN10933_0.15_2", "antibody_concentration": 0.15}, {"library": "lib2", "antibody_sample": "thaw-1_REGN10933_0.15_2", "no-antibody_sample": "thaw-1_no-antibody_control_2", "n_aa_substitutions": "1", "antibody neut standard count": 20040, "no-antibody neut standard count": 10877, "antibody count": 205185, "no-antibody count": 361718, "censored": true, "fraction not neutralized": 0.30788384319832574, "library_sample": "lib2 thaw-1_REGN10933_0.15_2", "antibody_concentration": 0.15}, {"library": "lib2", "antibody_sample": "thaw-1_REGN10933_0.15_2", "no-antibody_sample": "thaw-1_no-antibody_control_2", "n_aa_substitutions": "2", "antibody neut standard count": 20040, "no-antibody neut standard count": 10877, "antibody count": 202587, "no-antibody count": 331201, "censored": true, "fraction not neutralized": 0.3319948487420134, "library_sample": "lib2 thaw-1_REGN10933_0.15_2", "antibody_concentration": 0.15}, {"library": "lib2", "antibody_sample": "thaw-1_REGN10933_0.15_2", "no-antibody_sample": "thaw-1_no-antibody_control_2", "n_aa_substitutions": "3", "antibody neut standard count": 20040, "no-antibody neut standard count": 10877, "antibody count": 134660, "no-antibody count": 219133, "censored": true, "fraction not neutralized": 0.3335356321168181, "library_sample": "lib2 thaw-1_REGN10933_0.15_2", "antibody_concentration": 0.15}, {"library": "lib2", "antibody_sample": "thaw-1_REGN10933_0.15_2", "no-antibody_sample": "thaw-1_no-antibody_control_2", "n_aa_substitutions": ">3", "antibody neut standard count": 20040, "no-antibody neut standard count": 10877, "antibody count": 98279, "no-antibody count": 136249, "censored": true, "fraction not neutralized": 0.3915063556510346, "library_sample": "lib2 thaw-1_REGN10933_0.15_2", "antibody_concentration": 0.15}, {"library": "lib2", "antibody_sample": "thaw-1_REGN10933_0.59_1", "no-antibody_sample": "thaw-1_no-antibody_control_1", "n_aa_substitutions": "0", "antibody neut standard count": 57699, "no-antibody neut standard count": 11144, "antibody count": 74318, "no-antibody count": 150802, "censored": false, "fraction not neutralized": 0.09518307463271658, "library_sample": "lib2 thaw-1_REGN10933_0.59_1", "antibody_concentration": 0.59}, {"library": "lib2", "antibody_sample": "thaw-1_REGN10933_0.59_1", "no-antibody_sample": "thaw-1_no-antibody_control_1", "n_aa_substitutions": "1", "antibody neut standard count": 57699, "no-antibody neut standard count": 11144, "antibody count": 173340, "no-antibody count": 319332, "censored": false, "fraction not neutralized": 0.10484052047324502, "library_sample": "lib2 thaw-1_REGN10933_0.59_1", "antibody_concentration": 0.59}, {"library": "lib2", "antibody_sample": "thaw-1_REGN10933_0.59_1", "no-antibody_sample": "thaw-1_no-antibody_control_1", "n_aa_substitutions": "2", "antibody neut standard count": 57699, "no-antibody neut standard count": 11144, "antibody count": 183505, "no-antibody count": 283629, "censored": false, "fraction not neutralized": 0.12495973208317888, "library_sample": "lib2 thaw-1_REGN10933_0.59_1", "antibody_concentration": 0.59}, {"library": "lib2", "antibody_sample": "thaw-1_REGN10933_0.59_1", "no-antibody_sample": "thaw-1_no-antibody_control_1", "n_aa_substitutions": "3", "antibody neut standard count": 57699, "no-antibody neut standard count": 11144, "antibody count": 144675, "no-antibody count": 189903, "censored": false, "fraction not neutralized": 0.1471412640251833, "library_sample": "lib2 thaw-1_REGN10933_0.59_1", "antibody_concentration": 0.59}, {"library": "lib2", "antibody_sample": "thaw-1_REGN10933_0.59_1", "no-antibody_sample": "thaw-1_no-antibody_control_1", "n_aa_substitutions": ">3", "antibody neut standard count": 57699, "no-antibody neut standard count": 11144, "antibody count": 125906, "no-antibody count": 122988, "censored": false, "fraction not neutralized": 0.19772268739437646, "library_sample": "lib2 thaw-1_REGN10933_0.59_1", "antibody_concentration": 0.59}, {"library": "lib2", "antibody_sample": "thaw-1_REGN10933_0.59_1", "no-antibody_sample": "thaw-1_no-antibody_control_1", "n_aa_substitutions": "0", "antibody neut standard count": 57699, "no-antibody neut standard count": 11144, "antibody count": 74318, "no-antibody count": 150802, "censored": true, "fraction not neutralized": 0.09518307463271658, "library_sample": "lib2 thaw-1_REGN10933_0.59_1", "antibody_concentration": 0.59}, {"library": "lib2", "antibody_sample": "thaw-1_REGN10933_0.59_1", "no-antibody_sample": "thaw-1_no-antibody_control_1", "n_aa_substitutions": "1", "antibody neut standard count": 57699, "no-antibody neut standard count": 11144, "antibody count": 173340, "no-antibody count": 319332, "censored": true, "fraction not neutralized": 0.10484052047324502, "library_sample": "lib2 thaw-1_REGN10933_0.59_1", "antibody_concentration": 0.59}, {"library": "lib2", "antibody_sample": "thaw-1_REGN10933_0.59_1", "no-antibody_sample": "thaw-1_no-antibody_control_1", "n_aa_substitutions": "2", "antibody neut standard count": 57699, "no-antibody neut standard count": 11144, "antibody count": 183505, "no-antibody count": 283629, "censored": true, "fraction not neutralized": 0.12495973208317888, "library_sample": "lib2 thaw-1_REGN10933_0.59_1", "antibody_concentration": 0.59}, {"library": "lib2", "antibody_sample": "thaw-1_REGN10933_0.59_1", "no-antibody_sample": "thaw-1_no-antibody_control_1", "n_aa_substitutions": "3", "antibody neut standard count": 57699, "no-antibody neut standard count": 11144, "antibody count": 144675, "no-antibody count": 189903, "censored": true, "fraction not neutralized": 0.1471412640251833, "library_sample": "lib2 thaw-1_REGN10933_0.59_1", "antibody_concentration": 0.59}, {"library": "lib2", "antibody_sample": "thaw-1_REGN10933_0.59_1", "no-antibody_sample": "thaw-1_no-antibody_control_1", "n_aa_substitutions": ">3", "antibody neut standard count": 57699, "no-antibody neut standard count": 11144, "antibody count": 125906, "no-antibody count": 122988, "censored": true, "fraction not neutralized": 0.19772268739437646, "library_sample": "lib2 thaw-1_REGN10933_0.59_1", "antibody_concentration": 0.59}, {"library": "lib2", "antibody_sample": "thaw-1_REGN10933_0.59_2", "no-antibody_sample": "thaw-1_no-antibody_control_2", "n_aa_substitutions": "0", "antibody neut standard count": 52409, "no-antibody neut standard count": 10877, "antibody count": 70691, "no-antibody count": 174569, "censored": false, "fraction not neutralized": 0.08404275035563254, "library_sample": "lib2 thaw-1_REGN10933_0.59_2", "antibody_concentration": 0.59}, {"library": "lib2", "antibody_sample": "thaw-1_REGN10933_0.59_2", "no-antibody_sample": "thaw-1_no-antibody_control_2", "n_aa_substitutions": "1", "antibody neut standard count": 52409, "no-antibody neut standard count": 10877, "antibody count": 179056, "no-antibody count": 361718, "censored": false, "fraction not neutralized": 0.10273584867979824, "library_sample": "lib2 thaw-1_REGN10933_0.59_2", "antibody_concentration": 0.59}, {"library": "lib2", "antibody_sample": "thaw-1_REGN10933_0.59_2", "no-antibody_sample": "thaw-1_no-antibody_control_2", "n_aa_substitutions": "2", "antibody neut standard count": 52409, "no-antibody neut standard count": 10877, "antibody count": 201992, "no-antibody count": 331201, "censored": false, "fraction not neutralized": 0.1265743731718183, "library_sample": "lib2 thaw-1_REGN10933_0.59_2", "antibody_concentration": 0.59}, {"library": "lib2", "antibody_sample": "thaw-1_REGN10933_0.59_2", "no-antibody_sample": "thaw-1_no-antibody_control_2", "n_aa_substitutions": "3", "antibody neut standard count": 52409, "no-antibody neut standard count": 10877, "antibody count": 141530, "no-antibody count": 219133, "censored": false, "fraction not neutralized": 0.1340429501522916, "library_sample": "lib2 thaw-1_REGN10933_0.59_2", "antibody_concentration": 0.59}, {"library": "lib2", "antibody_sample": "thaw-1_REGN10933_0.59_2", "no-antibody_sample": "thaw-1_no-antibody_control_2", "n_aa_substitutions": ">3", "antibody neut standard count": 52409, "no-antibody neut standard count": 10877, "antibody count": 135208, "no-antibody count": 136249, "censored": false, "fraction not neutralized": 0.20595499090797922, "library_sample": "lib2 thaw-1_REGN10933_0.59_2", "antibody_concentration": 0.59}, {"library": "lib2", "antibody_sample": "thaw-1_REGN10933_0.59_2", "no-antibody_sample": "thaw-1_no-antibody_control_2", "n_aa_substitutions": "0", "antibody neut standard count": 52409, "no-antibody neut standard count": 10877, "antibody count": 70691, "no-antibody count": 174569, "censored": true, "fraction not neutralized": 0.08404275035563254, "library_sample": "lib2 thaw-1_REGN10933_0.59_2", "antibody_concentration": 0.59}, {"library": "lib2", "antibody_sample": "thaw-1_REGN10933_0.59_2", "no-antibody_sample": "thaw-1_no-antibody_control_2", "n_aa_substitutions": "1", "antibody neut standard count": 52409, "no-antibody neut standard count": 10877, "antibody count": 179056, "no-antibody count": 361718, "censored": true, "fraction not neutralized": 0.10273584867979824, "library_sample": "lib2 thaw-1_REGN10933_0.59_2", "antibody_concentration": 0.59}, {"library": "lib2", "antibody_sample": "thaw-1_REGN10933_0.59_2", "no-antibody_sample": "thaw-1_no-antibody_control_2", "n_aa_substitutions": "2", "antibody neut standard count": 52409, "no-antibody neut standard count": 10877, "antibody count": 201992, "no-antibody count": 331201, "censored": true, "fraction not neutralized": 0.1265743731718183, "library_sample": "lib2 thaw-1_REGN10933_0.59_2", "antibody_concentration": 0.59}, {"library": "lib2", "antibody_sample": "thaw-1_REGN10933_0.59_2", "no-antibody_sample": "thaw-1_no-antibody_control_2", "n_aa_substitutions": "3", "antibody neut standard count": 52409, "no-antibody neut standard count": 10877, "antibody count": 141530, "no-antibody count": 219133, "censored": true, "fraction not neutralized": 0.1340429501522916, "library_sample": "lib2 thaw-1_REGN10933_0.59_2", "antibody_concentration": 0.59}, {"library": "lib2", "antibody_sample": "thaw-1_REGN10933_0.59_2", "no-antibody_sample": "thaw-1_no-antibody_control_2", "n_aa_substitutions": ">3", "antibody neut standard count": 52409, "no-antibody neut standard count": 10877, "antibody count": 135208, "no-antibody count": 136249, "censored": true, "fraction not neutralized": 0.20595499090797922, "library_sample": "lib2 thaw-1_REGN10933_0.59_2", "antibody_concentration": 0.59}]}}, {"mode": "vega-lite"});
</script></div>
</div>
</section>
<section id="Variant-level-probabilities-of-escape">
<h2>Variant-level probabilities of escape<a class="headerlink" href="#Variant-level-probabilities-of-escape" title="Link to this heading">¶</a></h2>
<p>Now we examine the variant-level probabilities of escape.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">prob_escape</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>library</th>
      <th>antibody_sample</th>
      <th>no-antibody_sample</th>
      <th>codon_substitutions</th>
      <th>n_codon_substitutions</th>
      <th>aa_substitutions</th>
      <th>n_aa_substitutions</th>
      <th>barcode</th>
      <th>prob_escape</th>
      <th>prob_escape_uncensored</th>
      <th>antibody_count</th>
      <th>no-antibody_count</th>
      <th>antibody_neut_standard_count</th>
      <th>no-antibody_neut_standard_count</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>lib1</td>
      <td>thaw-1_REGN10933_0.037_1</td>
      <td>thaw-1_no-antibody_control_1</td>
      <td>AAG180AGG CAT653CAG</td>
      <td>2</td>
      <td>K180R H653Q</td>
      <td>2</td>
      <td>AACTCAAAATCCTTAG</td>
      <td>0.510</td>
      <td>0.510</td>
      <td>1794</td>
      <td>5218</td>
      <td>11107</td>
      <td>16475</td>
    </tr>
    <tr>
      <th>1</th>
      <td>lib1</td>
      <td>thaw-1_REGN10933_0.037_1</td>
      <td>thaw-1_no-antibody_control_1</td>
      <td>CAC146CAG TCC151--- GCT417GCA AGC475ATC ACC111...</td>
      <td>6</td>
      <td>H146Q S151- S475I I1208T</td>
      <td>4</td>
      <td>AAGGTCCCGGAGTAAC</td>
      <td>0.628</td>
      <td>0.628</td>
      <td>1733</td>
      <td>4094</td>
      <td>11107</td>
      <td>16475</td>
    </tr>
    <tr>
      <th>2</th>
      <td>lib1</td>
      <td>thaw-1_REGN10933_0.037_1</td>
      <td>thaw-1_no-antibody_control_1</td>
      <td>AGA450AAG TTG580AAC AGC744AGT CAG955AAG</td>
      <td>4</td>
      <td>R450K L580N Q955K</td>
      <td>3</td>
      <td>AAAGCTGGAGTACGTA</td>
      <td>0.593</td>
      <td>0.593</td>
      <td>1428</td>
      <td>3574</td>
      <td>11107</td>
      <td>16475</td>
    </tr>
    <tr>
      <th>3</th>
      <td>lib1</td>
      <td>thaw-1_REGN10933_0.037_1</td>
      <td>thaw-1_no-antibody_control_1</td>
      <td>AGC98CAC GTG306ATC AGC475ATC GAT1082AAT CTG119...</td>
      <td>5</td>
      <td>S98H V306I S475I D1082N L1191M</td>
      <td>5</td>
      <td>AACCCAGCACCGTTGA</td>
      <td>0.669</td>
      <td>0.669</td>
      <td>1350</td>
      <td>2994</td>
      <td>11107</td>
      <td>16475</td>
    </tr>
    <tr>
      <th>4</th>
      <td>lib1</td>
      <td>thaw-1_REGN10933_0.037_1</td>
      <td>thaw-1_no-antibody_control_1</td>
      <td></td>
      <td>0</td>
      <td></td>
      <td>0</td>
      <td>AATCACAACCTTTACC</td>
      <td>0.478</td>
      <td>0.478</td>
      <td>1318</td>
      <td>4087</td>
      <td>11107</td>
      <td>16475</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>First, we filter on pre-selection counts (counts in the no-antibody condition) and pre-selection fraction (fraction in no-antibody condition among all variants). This enables us to calculate a minimum threshold for each sample, which is the larger of this counts or fraction threshold for that sample:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">min_no_antibody_counts</span> <span class="o">=</span> <span class="mi">20</span>  <span class="c1"># pre-selection counts must be &gt;= this</span>
<span class="n">min_no_antibody_frac</span> <span class="o">=</span> <span class="mf">0.00001</span>  <span class="c1"># pre-selection counts must &gt;= this fraction of total</span>

<span class="n">min_no_antibody_count_threshold_df</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">prob_escape</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s2">&quot;library&quot;</span><span class="p">,</span> <span class="s2">&quot;no-antibody_sample&quot;</span><span class="p">],</span> <span class="n">as_index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="o">.</span><span class="n">aggregate</span><span class="p">(</span><span class="n">total_no_antibody_count</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">NamedAgg</span><span class="p">(</span><span class="s2">&quot;no-antibody_count&quot;</span><span class="p">,</span> <span class="s2">&quot;sum&quot;</span><span class="p">))</span>
    <span class="o">.</span><span class="n">assign</span><span class="p">(</span>
        <span class="n">threshold</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="s2">&quot;total_no_antibody_count&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="n">min_no_antibody_frac</span><span class="p">)</span>
        <span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="n">lower</span><span class="o">=</span><span class="n">min_no_antibody_counts</span><span class="p">)</span>
        <span class="o">.</span><span class="n">round</span><span class="p">()</span>
        <span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">),</span>
    <span class="p">)</span>
<span class="p">)</span>

<span class="n">min_no_antibody_count_threshold_df</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>library</th>
      <th>no-antibody_sample</th>
      <th>total_no_antibody_count</th>
      <th>threshold</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>lib1</td>
      <td>thaw-1_no-antibody_control_1</td>
      <td>5011041</td>
      <td>50</td>
    </tr>
    <tr>
      <th>1</th>
      <td>lib1</td>
      <td>thaw-1_no-antibody_control_2</td>
      <td>2186016</td>
      <td>22</td>
    </tr>
    <tr>
      <th>2</th>
      <td>lib1</td>
      <td>thaw-2_no-antibody_control_1</td>
      <td>2096481</td>
      <td>21</td>
    </tr>
    <tr>
      <th>3</th>
      <td>lib1</td>
      <td>thaw-2_no-antibody_control_2</td>
      <td>1812264</td>
      <td>20</td>
    </tr>
    <tr>
      <th>4</th>
      <td>lib2</td>
      <td>thaw-1_no-antibody_control_1</td>
      <td>3199962</td>
      <td>32</td>
    </tr>
    <tr>
      <th>5</th>
      <td>lib2</td>
      <td>thaw-1_no-antibody_control_2</td>
      <td>3668610</td>
      <td>37</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>Now draw a box plot on the pre-selection (no-antibody) counts with black line at median, boxes spanning 25th to 75th percentile, whiskers spanning minimum to maximum, and a red line indicating the threshold. You can mouseover bars for details:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">no_antibody_count_boxplot_df</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">prob_escape</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span>
        <span class="p">[</span><span class="s2">&quot;library&quot;</span><span class="p">,</span> <span class="s2">&quot;antibody_sample&quot;</span><span class="p">,</span> <span class="s2">&quot;no-antibody_sample&quot;</span><span class="p">],</span> <span class="n">as_index</span><span class="o">=</span><span class="kc">False</span>
    <span class="p">)</span>
    <span class="o">.</span><span class="n">aggregate</span><span class="p">(</span>
        <span class="n">median</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">NamedAgg</span><span class="p">(</span><span class="s2">&quot;no-antibody_count&quot;</span><span class="p">,</span> <span class="s2">&quot;median&quot;</span><span class="p">),</span>
        <span class="n">percentile_25</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">NamedAgg</span><span class="p">(</span><span class="s2">&quot;no-antibody_count&quot;</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">s</span><span class="p">:</span> <span class="n">s</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="mf">0.25</span><span class="p">)),</span>
        <span class="n">percentile_75</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">NamedAgg</span><span class="p">(</span><span class="s2">&quot;no-antibody_count&quot;</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">s</span><span class="p">:</span> <span class="n">s</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="mf">0.75</span><span class="p">)),</span>
        <span class="nb">min</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">NamedAgg</span><span class="p">(</span><span class="s2">&quot;no-antibody_count&quot;</span><span class="p">,</span> <span class="s2">&quot;min&quot;</span><span class="p">),</span>
        <span class="nb">max</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">NamedAgg</span><span class="p">(</span><span class="s2">&quot;no-antibody_count&quot;</span><span class="p">,</span> <span class="s2">&quot;max&quot;</span><span class="p">),</span>
    <span class="p">)</span>
    <span class="o">.</span><span class="n">merge</span><span class="p">(</span>
        <span class="n">min_no_antibody_count_threshold_df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="s2">&quot;total_no_antibody_count&quot;</span><span class="p">),</span>
        <span class="n">validate</span><span class="o">=</span><span class="s2">&quot;many_to_one&quot;</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">library_sample</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="s2">&quot;library&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span> <span class="o">+</span> <span class="n">x</span><span class="p">[</span><span class="s2">&quot;antibody_sample&quot;</span><span class="p">])</span>
<span class="p">)</span>
<span class="k">assert</span> <span class="p">(</span>
    <span class="nb">len</span><span class="p">(</span><span class="n">no_antibody_count_boxplot_df</span><span class="p">)</span>
    <span class="o">==</span> <span class="n">no_antibody_count_boxplot_df</span><span class="p">[</span><span class="s2">&quot;library_sample&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">nunique</span><span class="p">()</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># NBVAL_SKIP</span>

<span class="n">no_antibody_count_base</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">no_antibody_count_boxplot_df</span><span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
    <span class="n">y</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">Y</span><span class="p">(</span><span class="s2">&quot;library_sample&quot;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="kc">None</span><span class="p">),</span>
    <span class="n">tooltip</span><span class="o">=</span><span class="p">[</span>
        <span class="n">c</span> <span class="k">if</span> <span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;sample&quot;</span><span class="p">)</span> <span class="ow">or</span> <span class="n">c</span> <span class="o">==</span> <span class="s2">&quot;library&quot;</span><span class="p">)</span> <span class="k">else</span> <span class="n">alt</span><span class="o">.</span><span class="n">Tooltip</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s2">&quot;.3g&quot;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">no_antibody_count_boxplot_df</span><span class="o">.</span><span class="n">columns</span>
        <span class="k">if</span> <span class="n">c</span> <span class="o">!=</span> <span class="s2">&quot;library_sample&quot;</span>
    <span class="p">],</span>
<span class="p">)</span>

<span class="n">no_antibody_count_quartile_bars</span> <span class="o">=</span> <span class="n">no_antibody_count_base</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
    <span class="n">alt</span><span class="o">.</span><span class="n">X</span><span class="p">(</span>
        <span class="s2">&quot;percentile_25&quot;</span><span class="p">,</span>
        <span class="n">scale</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">Scale</span><span class="p">(</span><span class="nb">type</span><span class="o">=</span><span class="s2">&quot;symlog&quot;</span><span class="p">,</span> <span class="n">constant</span><span class="o">=</span><span class="mi">20</span><span class="p">),</span>
        <span class="n">title</span><span class="o">=</span><span class="s2">&quot;counts for variant&quot;</span><span class="p">,</span>
    <span class="p">),</span>
    <span class="n">alt</span><span class="o">.</span><span class="n">X2</span><span class="p">(</span><span class="s2">&quot;percentile_75&quot;</span><span class="p">),</span>
<span class="p">)</span><span class="o">.</span><span class="n">mark_bar</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;blue&quot;</span><span class="p">)</span>

<span class="n">no_antibody_count_range_lines</span> <span class="o">=</span> <span class="n">no_antibody_count_base</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
    <span class="n">alt</span><span class="o">.</span><span class="n">X</span><span class="p">(</span><span class="s2">&quot;min&quot;</span><span class="p">),</span>
    <span class="n">alt</span><span class="o">.</span><span class="n">X2</span><span class="p">(</span><span class="s2">&quot;max&quot;</span><span class="p">),</span>
<span class="p">)</span><span class="o">.</span><span class="n">mark_rule</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;blue&quot;</span><span class="p">,</span> <span class="n">opacity</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>

<span class="n">no_antibody_count_median_lines</span> <span class="o">=</span> <span class="n">no_antibody_count_base</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
    <span class="n">alt</span><span class="o">.</span><span class="n">X</span><span class="p">(</span><span class="s2">&quot;median&quot;</span><span class="p">),</span> <span class="n">alt</span><span class="o">.</span><span class="n">X2</span><span class="p">(</span><span class="s2">&quot;median&quot;</span><span class="p">)</span>
<span class="p">)</span><span class="o">.</span><span class="n">mark_bar</span><span class="p">(</span><span class="n">xOffset</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">x2Offset</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">)</span>

<span class="n">no_antibody_count_threshold</span> <span class="o">=</span> <span class="n">no_antibody_count_base</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
    <span class="n">alt</span><span class="o">.</span><span class="n">X</span><span class="p">(</span><span class="s2">&quot;threshold&quot;</span><span class="p">),</span> <span class="n">alt</span><span class="o">.</span><span class="n">X2</span><span class="p">(</span><span class="s2">&quot;threshold&quot;</span><span class="p">)</span>
<span class="p">)</span><span class="o">.</span><span class="n">mark_bar</span><span class="p">(</span><span class="n">xOffset</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">x2Offset</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">)</span>

<span class="n">no_antibody_count_chart</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">no_antibody_count_quartile_bars</span>
    <span class="o">+</span> <span class="n">no_antibody_count_range_lines</span>
    <span class="o">+</span> <span class="n">no_antibody_count_median_lines</span>
    <span class="o">+</span> <span class="n">no_antibody_count_threshold</span>
<span class="p">)</span><span class="o">.</span><span class="n">properties</span><span class="p">(</span><span class="n">width</span><span class="o">=</span><span class="mi">350</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">Step</span><span class="p">(</span><span class="mi">14</span><span class="p">))</span>

<span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">selections</span><span class="p">:</span>
    <span class="n">no_antibody_count_chart</span> <span class="o">=</span> <span class="n">no_antibody_count_chart</span><span class="o">.</span><span class="n">add_params</span><span class="p">(</span><span class="n">s</span><span class="p">)</span><span class="o">.</span><span class="n">transform_filter</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>

<span class="n">no_antibody_count_chart</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div id="altair-viz-60a39aee6e3549f48b57075033633c97"></div>
<script type="text/javascript">
  var VEGA_DEBUG = (typeof VEGA_DEBUG == "undefined") ? {} : VEGA_DEBUG;
  (function(spec, embedOpt){
    let outputDiv = document.currentScript.previousElementSibling;
    if (outputDiv.id !== "altair-viz-60a39aee6e3549f48b57075033633c97") {
      outputDiv = document.getElementById("altair-viz-60a39aee6e3549f48b57075033633c97");
    }
    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm/vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm/vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm/vega-lite@5.6.1?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm/vega-embed@6?noext",
    };

    function maybeLoadScript(lib, version) {
      var key = `${lib.replace("-", "")}_version`;
      return (VEGA_DEBUG[key] == version) ?
        Promise.resolve(paths[lib]) :
        new Promise(function(resolve, reject) {
          var s = document.createElement('script');
          document.getElementsByTagName("head")[0].appendChild(s);
          s.async = true;
          s.onload = () => {
            VEGA_DEBUG[key] = version;
            return resolve(paths[lib]);
          };
          s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
          s.src = paths[lib];
        });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      require(["vega-embed"], displayChart, err => showError(`Error loading script: ${err.message}`));
    } else {
      maybeLoadScript("vega", "5")
        .then(() => maybeLoadScript("vega-lite", "5.6.1"))
        .then(() => maybeLoadScript("vega-embed", "6"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"config": {"view": {"continuousWidth": 300, "continuousHeight": 300}}, "layer": [{"mark": {"type": "bar", "color": "blue"}, "encoding": {"tooltip": [{"field": "library", "type": "nominal"}, {"field": "antibody_sample", "type": "nominal"}, {"field": "no-antibody_sample", "type": "nominal"}, {"field": "median", "format": ".3g", "type": "quantitative"}, {"field": "percentile_25", "format": ".3g", "type": "quantitative"}, {"field": "percentile_75", "format": ".3g", "type": "quantitative"}, {"field": "min", "format": ".3g", "type": "quantitative"}, {"field": "max", "format": ".3g", "type": "quantitative"}, {"field": "threshold", "format": ".3g", "type": "quantitative"}], "x": {"field": "percentile_25", "scale": {"constant": 20, "type": "symlog"}, "title": "counts for variant", "type": "quantitative"}, "x2": {"field": "percentile_75"}, "y": {"field": "library_sample", "title": null, "type": "nominal"}}, "name": "view_1"}, {"mark": {"type": "rule", "color": "blue", "opacity": 0.5}, "encoding": {"tooltip": [{"field": "library", "type": "nominal"}, {"field": "antibody_sample", "type": "nominal"}, {"field": "no-antibody_sample", "type": "nominal"}, {"field": "median", "format": ".3g", "type": "quantitative"}, {"field": "percentile_25", "format": ".3g", "type": "quantitative"}, {"field": "percentile_75", "format": ".3g", "type": "quantitative"}, {"field": "min", "format": ".3g", "type": "quantitative"}, {"field": "max", "format": ".3g", "type": "quantitative"}, {"field": "threshold", "format": ".3g", "type": "quantitative"}], "x": {"field": "min", "type": "quantitative"}, "x2": {"field": "max"}, "y": {"field": "library_sample", "title": null, "type": "nominal"}}}, {"mark": {"type": "bar", "color": "black", "x2Offset": -1, "xOffset": 1}, "encoding": {"tooltip": [{"field": "library", "type": "nominal"}, {"field": "antibody_sample", "type": "nominal"}, {"field": "no-antibody_sample", "type": "nominal"}, {"field": "median", "format": ".3g", "type": "quantitative"}, {"field": "percentile_25", "format": ".3g", "type": "quantitative"}, {"field": "percentile_75", "format": ".3g", "type": "quantitative"}, {"field": "min", "format": ".3g", "type": "quantitative"}, {"field": "max", "format": ".3g", "type": "quantitative"}, {"field": "threshold", "format": ".3g", "type": "quantitative"}], "x": {"field": "median", "type": "quantitative"}, "x2": {"field": "median"}, "y": {"field": "library_sample", "title": null, "type": "nominal"}}}, {"mark": {"type": "bar", "color": "red", "x2Offset": -1, "xOffset": 1}, "encoding": {"tooltip": [{"field": "library", "type": "nominal"}, {"field": "antibody_sample", "type": "nominal"}, {"field": "no-antibody_sample", "type": "nominal"}, {"field": "median", "format": ".3g", "type": "quantitative"}, {"field": "percentile_25", "format": ".3g", "type": "quantitative"}, {"field": "percentile_75", "format": ".3g", "type": "quantitative"}, {"field": "min", "format": ".3g", "type": "quantitative"}, {"field": "max", "format": ".3g", "type": "quantitative"}, {"field": "threshold", "format": ".3g", "type": "quantitative"}], "x": {"field": "threshold", "type": "quantitative"}, "x2": {"field": "threshold"}, "y": {"field": "library_sample", "title": null, "type": "nominal"}}}], "data": {"name": "data-9a18a7758d6374d7e814398888cd78c8"}, "height": {"step": 14}, "params": [{"name": "param_1", "select": {"type": "point", "fields": ["library"]}, "bind": {"input": "select", "options": [null, "lib1", "lib2"], "labels": ["all", "lib1", "lib2"], "name": "library"}, "views": ["view_1"]}], "transform": [{"filter": {"param": "param_1"}}], "width": 350, "$schema": "https://vega.github.io/schema/vega-lite/v5.6.1.json", "datasets": {"data-9a18a7758d6374d7e814398888cd78c8": [{"library": "lib1", "antibody_sample": "thaw-1_REGN10933_0.037_1", "no-antibody_sample": "thaw-1_no-antibody_control_1", "median": 199.5, "percentile_25": 79.0, "percentile_75": 423.25, "min": 0, "max": 10696, "threshold": 50, "library_sample": "lib1 thaw-1_REGN10933_0.037_1"}, {"library": "lib1", "antibody_sample": "thaw-1_REGN10933_0.15_1", "no-antibody_sample": "thaw-1_no-antibody_control_1", "median": 199.5, "percentile_25": 79.0, "percentile_75": 423.25, "min": 0, "max": 10696, "threshold": 50, "library_sample": "lib1 thaw-1_REGN10933_0.15_1"}, {"library": "lib1", "antibody_sample": "thaw-1_REGN10933_0.59_1", "no-antibody_sample": "thaw-1_no-antibody_control_1", "median": 199.5, "percentile_25": 79.0, "percentile_75": 423.25, "min": 0, "max": 10696, "threshold": 50, "library_sample": "lib1 thaw-1_REGN10933_0.59_1"}, {"library": "lib1", "antibody_sample": "thaw-1_REGN10933_0.15_2", "no-antibody_sample": "thaw-1_no-antibody_control_2", "median": 135.0, "percentile_25": 56.0, "percentile_75": 279.0, "min": 0, "max": 3585, "threshold": 22, "library_sample": "lib1 thaw-1_REGN10933_0.15_2"}, {"library": "lib1", "antibody_sample": "thaw-1_REGN10933_0.59_2", "no-antibody_sample": "thaw-1_no-antibody_control_2", "median": 135.0, "percentile_25": 56.0, "percentile_75": 279.0, "min": 0, "max": 3585, "threshold": 22, "library_sample": "lib1 thaw-1_REGN10933_0.59_2"}, {"library": "lib1", "antibody_sample": "thaw-2_279C_0.00088_1", "no-antibody_sample": "thaw-2_no-antibody_control_1", "median": 58.0, "percentile_25": 11.0, "percentile_75": 165.0, "min": 0, "max": 4355, "threshold": 21, "library_sample": "lib1 thaw-2_279C_0.00088_1"}, {"library": "lib1", "antibody_sample": "thaw-2_279C_0.0035_1", "no-antibody_sample": "thaw-2_no-antibody_control_1", "median": 58.0, "percentile_25": 11.0, "percentile_75": 165.0, "min": 0, "max": 4355, "threshold": 21, "library_sample": "lib1 thaw-2_279C_0.0035_1"}, {"library": "lib1", "antibody_sample": "thaw-2_279C_0.014_1", "no-antibody_sample": "thaw-2_no-antibody_control_1", "median": 58.0, "percentile_25": 11.0, "percentile_75": 165.0, "min": 0, "max": 4355, "threshold": 21, "library_sample": "lib1 thaw-2_279C_0.014_1"}, {"library": "lib1", "antibody_sample": "thaw-2_279C_0.00088_2", "no-antibody_sample": "thaw-2_no-antibody_control_2", "median": 50.0, "percentile_25": 10.0, "percentile_75": 144.0, "min": 0, "max": 2977, "threshold": 20, "library_sample": "lib1 thaw-2_279C_0.00088_2"}, {"library": "lib1", "antibody_sample": "thaw-2_279C_0.0035_2", "no-antibody_sample": "thaw-2_no-antibody_control_2", "median": 50.0, "percentile_25": 10.0, "percentile_75": 144.0, "min": 0, "max": 2977, "threshold": 20, "library_sample": "lib1 thaw-2_279C_0.0035_2"}, {"library": "lib1", "antibody_sample": "thaw-2_279C_0.014_2", "no-antibody_sample": "thaw-2_no-antibody_control_2", "median": 50.0, "percentile_25": 10.0, "percentile_75": 144.0, "min": 0, "max": 2977, "threshold": 20, "library_sample": "lib1 thaw-2_279C_0.014_2"}, {"library": "lib2", "antibody_sample": "thaw-1_REGN10933_0.037_1", "no-antibody_sample": "thaw-1_no-antibody_control_1", "median": 116.5, "percentile_25": 39.0, "percentile_75": 281.0, "min": 0, "max": 5577, "threshold": 32, "library_sample": "lib2 thaw-1_REGN10933_0.037_1"}, {"library": "lib2", "antibody_sample": "thaw-1_REGN10933_0.15_1", "no-antibody_sample": "thaw-1_no-antibody_control_1", "median": 116.5, "percentile_25": 39.0, "percentile_75": 281.0, "min": 0, "max": 5577, "threshold": 32, "library_sample": "lib2 thaw-1_REGN10933_0.15_1"}, {"library": "lib2", "antibody_sample": "thaw-1_REGN10933_0.59_1", "no-antibody_sample": "thaw-1_no-antibody_control_1", "median": 116.5, "percentile_25": 39.0, "percentile_75": 281.0, "min": 0, "max": 5577, "threshold": 32, "library_sample": "lib2 thaw-1_REGN10933_0.59_1"}, {"library": "lib2", "antibody_sample": "thaw-1_REGN10933_0.037_2", "no-antibody_sample": "thaw-1_no-antibody_control_2", "median": 134.5, "percentile_25": 47.0, "percentile_75": 315.25, "min": 0, "max": 6512, "threshold": 37, "library_sample": "lib2 thaw-1_REGN10933_0.037_2"}, {"library": "lib2", "antibody_sample": "thaw-1_REGN10933_0.15_2", "no-antibody_sample": "thaw-1_no-antibody_control_2", "median": 134.5, "percentile_25": 47.0, "percentile_75": 315.25, "min": 0, "max": 6512, "threshold": 37, "library_sample": "lib2 thaw-1_REGN10933_0.15_2"}, {"library": "lib2", "antibody_sample": "thaw-1_REGN10933_0.59_2", "no-antibody_sample": "thaw-1_no-antibody_control_2", "median": 134.5, "percentile_25": 47.0, "percentile_75": 315.25, "min": 0, "max": 6512, "threshold": 37, "library_sample": "lib2 thaw-1_REGN10933_0.59_2"}]}}, {"mode": "vega-lite"});
</script></div>
</div>
<p>Now get just prob escape measurements for variants that exceed pre-selection (no-antibody) count threshold:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">prob_escape_filtered</span> <span class="o">=</span> <span class="n">prob_escape</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span>
    <span class="n">min_no_antibody_count_threshold_df</span><span class="p">,</span> <span class="n">validate</span><span class="o">=</span><span class="s2">&quot;many_to_one&quot;</span>
<span class="p">)</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s2">&quot;`no-antibody_count` &gt;= threshold&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>Plot distribution of prob escape values across non-filtered variants. The boxes span 25th to 75th percentile, the black vertical line is at the median, and the thin lines extend from the min to max:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">prob_escape_boxplot_df</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">prob_escape_filtered</span><span class="o">.</span><span class="n">melt</span><span class="p">(</span>
        <span class="n">id_vars</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;library&quot;</span><span class="p">,</span> <span class="s2">&quot;antibody_sample&quot;</span><span class="p">,</span> <span class="s2">&quot;no-antibody_sample&quot;</span><span class="p">],</span>
        <span class="n">value_vars</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;prob_escape&quot;</span><span class="p">,</span> <span class="s2">&quot;prob_escape_uncensored&quot;</span><span class="p">],</span>
        <span class="n">var_name</span><span class="o">=</span><span class="s2">&quot;censored&quot;</span><span class="p">,</span>
        <span class="n">value_name</span><span class="o">=</span><span class="s2">&quot;probability escape&quot;</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="o">.</span><span class="n">groupby</span><span class="p">(</span>
        <span class="p">[</span><span class="s2">&quot;library&quot;</span><span class="p">,</span> <span class="s2">&quot;antibody_sample&quot;</span><span class="p">,</span> <span class="s2">&quot;no-antibody_sample&quot;</span><span class="p">,</span> <span class="s2">&quot;censored&quot;</span><span class="p">],</span>
        <span class="n">as_index</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="o">.</span><span class="n">aggregate</span><span class="p">(</span>
        <span class="n">median</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">NamedAgg</span><span class="p">(</span><span class="s2">&quot;probability escape&quot;</span><span class="p">,</span> <span class="s2">&quot;median&quot;</span><span class="p">),</span>
        <span class="n">percentile_25</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">NamedAgg</span><span class="p">(</span><span class="s2">&quot;probability escape&quot;</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">s</span><span class="p">:</span> <span class="n">s</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="mf">0.25</span><span class="p">)),</span>
        <span class="n">percentile_75</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">NamedAgg</span><span class="p">(</span><span class="s2">&quot;probability escape&quot;</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">s</span><span class="p">:</span> <span class="n">s</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="mf">0.75</span><span class="p">)),</span>
        <span class="nb">min</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">NamedAgg</span><span class="p">(</span><span class="s2">&quot;probability escape&quot;</span><span class="p">,</span> <span class="s2">&quot;min&quot;</span><span class="p">),</span>
        <span class="nb">max</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">NamedAgg</span><span class="p">(</span><span class="s2">&quot;probability escape&quot;</span><span class="p">,</span> <span class="s2">&quot;max&quot;</span><span class="p">),</span>
    <span class="p">)</span>
    <span class="o">.</span><span class="n">assign</span><span class="p">(</span>
        <span class="n">library_sample</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="s2">&quot;library&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span> <span class="o">+</span> <span class="n">x</span><span class="p">[</span><span class="s2">&quot;antibody_sample&quot;</span><span class="p">],</span>
        <span class="n">censored</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="s2">&quot;censored&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;prob_escape&quot;</span><span class="p">,</span>
    <span class="p">)</span>
<span class="p">)</span>
<span class="k">assert</span> <span class="p">(</span>
    <span class="nb">len</span><span class="p">(</span><span class="n">prob_escape_boxplot_df</span><span class="p">)</span>
    <span class="o">==</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">prob_escape_boxplot_df</span><span class="p">[</span><span class="s2">&quot;library_sample&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">nunique</span><span class="p">()</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># NBVAL_SKIP</span>

<span class="n">prob_escape_base</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">prob_escape_boxplot_df</span><span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
    <span class="n">y</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">Y</span><span class="p">(</span><span class="s2">&quot;library_sample&quot;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="kc">None</span><span class="p">),</span>
    <span class="n">tooltip</span><span class="o">=</span><span class="p">[</span>
        <span class="n">c</span> <span class="k">if</span> <span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;sample&quot;</span><span class="p">)</span> <span class="ow">or</span> <span class="n">c</span> <span class="o">==</span> <span class="s2">&quot;library&quot;</span><span class="p">)</span> <span class="k">else</span> <span class="n">alt</span><span class="o">.</span><span class="n">Tooltip</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s2">&quot;.3g&quot;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">prob_escape_boxplot_df</span><span class="o">.</span><span class="n">columns</span>
        <span class="k">if</span> <span class="n">c</span> <span class="o">!=</span> <span class="s2">&quot;library_sample&quot;</span>
    <span class="p">],</span>
<span class="p">)</span>

<span class="n">prob_escape_quartile_bars</span> <span class="o">=</span> <span class="n">prob_escape_base</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
    <span class="n">alt</span><span class="o">.</span><span class="n">X</span><span class="p">(</span>
        <span class="s2">&quot;percentile_25&quot;</span><span class="p">,</span>
        <span class="n">scale</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">Scale</span><span class="p">(</span><span class="nb">type</span><span class="o">=</span><span class="s2">&quot;symlog&quot;</span><span class="p">,</span> <span class="n">constant</span><span class="o">=</span><span class="mi">20</span><span class="p">),</span>
        <span class="n">title</span><span class="o">=</span><span class="s2">&quot;probability escape&quot;</span><span class="p">,</span>
    <span class="p">),</span>
    <span class="n">alt</span><span class="o">.</span><span class="n">X2</span><span class="p">(</span><span class="s2">&quot;percentile_75&quot;</span><span class="p">),</span>
<span class="p">)</span><span class="o">.</span><span class="n">mark_bar</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;blue&quot;</span><span class="p">)</span>

<span class="n">prob_escape_range_lines</span> <span class="o">=</span> <span class="n">prob_escape_base</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
    <span class="n">alt</span><span class="o">.</span><span class="n">X</span><span class="p">(</span><span class="s2">&quot;min&quot;</span><span class="p">),</span>
    <span class="n">alt</span><span class="o">.</span><span class="n">X2</span><span class="p">(</span><span class="s2">&quot;max&quot;</span><span class="p">),</span>
<span class="p">)</span><span class="o">.</span><span class="n">mark_rule</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;blue&quot;</span><span class="p">,</span> <span class="n">opacity</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>

<span class="n">prob_escape_median_lines</span> <span class="o">=</span> <span class="n">prob_escape_base</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
    <span class="n">alt</span><span class="o">.</span><span class="n">X</span><span class="p">(</span><span class="s2">&quot;median&quot;</span><span class="p">),</span> <span class="n">alt</span><span class="o">.</span><span class="n">X2</span><span class="p">(</span><span class="s2">&quot;median&quot;</span><span class="p">)</span>
<span class="p">)</span><span class="o">.</span><span class="n">mark_bar</span><span class="p">(</span><span class="n">xOffset</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">x2Offset</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">)</span>

<span class="n">prob_escape_chart</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">prob_escape_quartile_bars</span> <span class="o">+</span> <span class="n">prob_escape_range_lines</span> <span class="o">+</span> <span class="n">prob_escape_median_lines</span>
<span class="p">)</span><span class="o">.</span><span class="n">properties</span><span class="p">(</span><span class="n">width</span><span class="o">=</span><span class="mi">350</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">Step</span><span class="p">(</span><span class="mi">14</span><span class="p">))</span>

<span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">selections</span> <span class="o">+</span> <span class="p">[</span><span class="n">censored_selection</span><span class="p">]:</span>
    <span class="n">prob_escape_chart</span> <span class="o">=</span> <span class="n">prob_escape_chart</span><span class="o">.</span><span class="n">add_params</span><span class="p">(</span><span class="n">s</span><span class="p">)</span><span class="o">.</span><span class="n">transform_filter</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>

<span class="n">prob_escape_chart</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div id="altair-viz-c86af17495d54c159519b9fef0fda0bb"></div>
<script type="text/javascript">
  var VEGA_DEBUG = (typeof VEGA_DEBUG == "undefined") ? {} : VEGA_DEBUG;
  (function(spec, embedOpt){
    let outputDiv = document.currentScript.previousElementSibling;
    if (outputDiv.id !== "altair-viz-c86af17495d54c159519b9fef0fda0bb") {
      outputDiv = document.getElementById("altair-viz-c86af17495d54c159519b9fef0fda0bb");
    }
    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm/vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm/vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm/vega-lite@5.6.1?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm/vega-embed@6?noext",
    };

    function maybeLoadScript(lib, version) {
      var key = `${lib.replace("-", "")}_version`;
      return (VEGA_DEBUG[key] == version) ?
        Promise.resolve(paths[lib]) :
        new Promise(function(resolve, reject) {
          var s = document.createElement('script');
          document.getElementsByTagName("head")[0].appendChild(s);
          s.async = true;
          s.onload = () => {
            VEGA_DEBUG[key] = version;
            return resolve(paths[lib]);
          };
          s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
          s.src = paths[lib];
        });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      require(["vega-embed"], displayChart, err => showError(`Error loading script: ${err.message}`));
    } else {
      maybeLoadScript("vega", "5")
        .then(() => maybeLoadScript("vega-lite", "5.6.1"))
        .then(() => maybeLoadScript("vega-embed", "6"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"config": {"view": {"continuousWidth": 300, "continuousHeight": 300}}, "layer": [{"mark": {"type": "bar", "color": "blue"}, "encoding": {"tooltip": [{"field": "library", "type": "nominal"}, {"field": "antibody_sample", "type": "nominal"}, {"field": "no-antibody_sample", "type": "nominal"}, {"field": "censored", "format": ".3g", "type": "nominal"}, {"field": "median", "format": ".3g", "type": "quantitative"}, {"field": "percentile_25", "format": ".3g", "type": "quantitative"}, {"field": "percentile_75", "format": ".3g", "type": "quantitative"}, {"field": "min", "format": ".3g", "type": "quantitative"}, {"field": "max", "format": ".3g", "type": "quantitative"}], "x": {"field": "percentile_25", "scale": {"constant": 20, "type": "symlog"}, "title": "probability escape", "type": "quantitative"}, "x2": {"field": "percentile_75"}, "y": {"field": "library_sample", "title": null, "type": "nominal"}}, "name": "view_2"}, {"mark": {"type": "rule", "color": "blue", "opacity": 0.5}, "encoding": {"tooltip": [{"field": "library", "type": "nominal"}, {"field": "antibody_sample", "type": "nominal"}, {"field": "no-antibody_sample", "type": "nominal"}, {"field": "censored", "format": ".3g", "type": "nominal"}, {"field": "median", "format": ".3g", "type": "quantitative"}, {"field": "percentile_25", "format": ".3g", "type": "quantitative"}, {"field": "percentile_75", "format": ".3g", "type": "quantitative"}, {"field": "min", "format": ".3g", "type": "quantitative"}, {"field": "max", "format": ".3g", "type": "quantitative"}], "x": {"field": "min", "type": "quantitative"}, "x2": {"field": "max"}, "y": {"field": "library_sample", "title": null, "type": "nominal"}}}, {"mark": {"type": "bar", "color": "black", "x2Offset": -1, "xOffset": 1}, "encoding": {"tooltip": [{"field": "library", "type": "nominal"}, {"field": "antibody_sample", "type": "nominal"}, {"field": "no-antibody_sample", "type": "nominal"}, {"field": "censored", "format": ".3g", "type": "nominal"}, {"field": "median", "format": ".3g", "type": "quantitative"}, {"field": "percentile_25", "format": ".3g", "type": "quantitative"}, {"field": "percentile_75", "format": ".3g", "type": "quantitative"}, {"field": "min", "format": ".3g", "type": "quantitative"}, {"field": "max", "format": ".3g", "type": "quantitative"}], "x": {"field": "median", "type": "quantitative"}, "x2": {"field": "median"}, "y": {"field": "library_sample", "title": null, "type": "nominal"}}}], "data": {"name": "data-f18a803c80b1acbbd4fd6c24ed9581bf"}, "height": {"step": 14}, "params": [{"name": "param_1", "select": {"type": "point", "fields": ["library"]}, "bind": {"input": "select", "options": [null, "lib1", "lib2"], "labels": ["all", "lib1", "lib2"], "name": "library"}, "views": ["view_2"]}, {"name": "param_2", "select": {"type": "point", "fields": ["censored"]}, "bind": {"input": "select", "options": [true, false], "name": "censored to be between 0 and 1"}, "value": [{"censored": true}], "views": ["view_2"]}], "transform": [{"filter": {"param": "param_1"}}, {"filter": {"param": "param_2"}}], "width": 350, "$schema": "https://vega.github.io/schema/vega-lite/v5.6.1.json", "datasets": {"data-f18a803c80b1acbbd4fd6c24ed9581bf": [{"library": "lib1", "antibody_sample": "thaw-1_REGN10933_0.037_1", "no-antibody_sample": "thaw-1_no-antibody_control_1", "censored": true, "median": 0.41372518608430287, "percentile_25": 0.23391423197617786, "percentile_75": 0.6535478001584241, "min": 0.0, "max": 1.0, "library_sample": "lib1 thaw-1_REGN10933_0.037_1"}, {"library": "lib1", "antibody_sample": "thaw-1_REGN10933_0.037_1", "no-antibody_sample": "thaw-1_no-antibody_control_1", "censored": false, "median": 0.41372518608430287, "percentile_25": 0.23391423197617786, "percentile_75": 0.6535478001584241, "min": 0.0, "max": 10.871906127994631, "library_sample": "lib1 thaw-1_REGN10933_0.037_1"}, {"library": "lib1", "antibody_sample": "thaw-1_REGN10933_0.15_1", "no-antibody_sample": "thaw-1_no-antibody_control_1", "censored": true, "median": 0.407465103365301, "percentile_25": 0.25678427472466747, "percentile_75": 0.6160948402796893, "min": 0.0, "max": 1.0, "library_sample": "lib1 thaw-1_REGN10933_0.15_1"}, {"library": "lib1", "antibody_sample": "thaw-1_REGN10933_0.15_1", "no-antibody_sample": "thaw-1_no-antibody_control_1", "censored": false, "median": 0.407465103365301, "percentile_25": 0.25678427472466747, "percentile_75": 0.6160948402796893, "min": 0.0, "max": 7.039380008029812, "library_sample": "lib1 thaw-1_REGN10933_0.15_1"}, {"library": "lib1", "antibody_sample": "thaw-1_REGN10933_0.15_2", "no-antibody_sample": "thaw-1_no-antibody_control_2", "censored": true, "median": 0.21921465904968224, "percentile_25": 0.0873576979626129, "percentile_75": 0.41109504923582546, "min": 0.0, "max": 1.0, "library_sample": "lib1 thaw-1_REGN10933_0.15_2"}, {"library": "lib1", "antibody_sample": "thaw-1_REGN10933_0.15_2", "no-antibody_sample": "thaw-1_no-antibody_control_2", "censored": false, "median": 0.21921465904968224, "percentile_25": 0.0873576979626129, "percentile_75": 0.41109504923582546, "min": 0.0, "max": 7.559235143566167, "library_sample": "lib1 thaw-1_REGN10933_0.15_2"}, {"library": "lib1", "antibody_sample": "thaw-1_REGN10933_0.59_1", "no-antibody_sample": "thaw-1_no-antibody_control_1", "censored": true, "median": 0.08459548128531531, "percentile_25": 0.0, "percentile_75": 0.21643199262178045, "min": 0.0, "max": 1.0, "library_sample": "lib1 thaw-1_REGN10933_0.59_1"}, {"library": "lib1", "antibody_sample": "thaw-1_REGN10933_0.59_1", "no-antibody_sample": "thaw-1_no-antibody_control_1", "censored": false, "median": 0.08459548128531531, "percentile_25": 0.0, "percentile_75": 0.21643199262178045, "min": 0.0, "max": 14.174157002871077, "library_sample": "lib1 thaw-1_REGN10933_0.59_1"}, {"library": "lib1", "antibody_sample": "thaw-1_REGN10933_0.59_2", "no-antibody_sample": "thaw-1_no-antibody_control_2", "censored": true, "median": 0.12124302487474924, "percentile_25": 0.0, "percentile_75": 0.3171287033558455, "min": 0.0, "max": 1.0, "library_sample": "lib1 thaw-1_REGN10933_0.59_2"}, {"library": "lib1", "antibody_sample": "thaw-1_REGN10933_0.59_2", "no-antibody_sample": "thaw-1_no-antibody_control_2", "censored": false, "median": 0.12124302487474924, "percentile_25": 0.0, "percentile_75": 0.3171287033558455, "min": 0.0, "max": 16.016284184356476, "library_sample": "lib1 thaw-1_REGN10933_0.59_2"}, {"library": "lib1", "antibody_sample": "thaw-2_279C_0.00088_1", "no-antibody_sample": "thaw-2_no-antibody_control_1", "censored": true, "median": 0.9287132554938827, "percentile_25": 0.5872275054400885, "percentile_75": 1.0, "min": 0.0, "max": 1.0, "library_sample": "lib1 thaw-2_279C_0.00088_1"}, {"library": "lib1", "antibody_sample": "thaw-2_279C_0.00088_1", "no-antibody_sample": "thaw-2_no-antibody_control_1", "censored": false, "median": 0.9287132554938827, "percentile_25": 0.5872275054400885, "percentile_75": 1.3391878774199295, "min": 0.0, "max": 8.198127551790533, "library_sample": "lib1 thaw-2_279C_0.00088_1"}, {"library": "lib1", "antibody_sample": "thaw-2_279C_0.00088_2", "no-antibody_sample": "thaw-2_no-antibody_control_2", "censored": true, "median": 0.7711911929782914, "percentile_25": 0.5031544969922237, "percentile_75": 1.0, "min": 0.0, "max": 1.0, "library_sample": "lib1 thaw-2_279C_0.00088_2"}, {"library": "lib1", "antibody_sample": "thaw-2_279C_0.00088_2", "no-antibody_sample": "thaw-2_no-antibody_control_2", "censored": false, "median": 0.7711911929782914, "percentile_25": 0.5031544969922237, "percentile_75": 1.1029676210382169, "min": 0.0, "max": 8.0225189242649, "library_sample": "lib1 thaw-2_279C_0.00088_2"}, {"library": "lib1", "antibody_sample": "thaw-2_279C_0.0035_1", "no-antibody_sample": "thaw-2_no-antibody_control_1", "censored": true, "median": 0.7043893057330481, "percentile_25": 0.4351581526460449, "percentile_75": 1.0, "min": 0.0, "max": 1.0, "library_sample": "lib1 thaw-2_279C_0.0035_1"}, {"library": "lib1", "antibody_sample": "thaw-2_279C_0.0035_1", "no-antibody_sample": "thaw-2_no-antibody_control_1", "censored": false, "median": 0.7043893057330481, "percentile_25": 0.4351581526460449, "percentile_75": 1.080902595984099, "min": 0.0, "max": 7.9511464831146474, "library_sample": "lib1 thaw-2_279C_0.0035_1"}, {"library": "lib1", "antibody_sample": "thaw-2_279C_0.0035_2", "no-antibody_sample": "thaw-2_no-antibody_control_2", "censored": true, "median": 0.5788490075978923, "percentile_25": 0.3505870379121079, "percentile_75": 0.8727113050883544, "min": 0.0, "max": 1.0, "library_sample": "lib1 thaw-2_279C_0.0035_2"}, {"library": "lib1", "antibody_sample": "thaw-2_279C_0.0035_2", "no-antibody_sample": "thaw-2_no-antibody_control_2", "censored": false, "median": 0.5788490075978923, "percentile_25": 0.3505870379121079, "percentile_75": 0.8727113050883544, "min": 0.0, "max": 7.927516596667117, "library_sample": "lib1 thaw-2_279C_0.0035_2"}, {"library": "lib1", "antibody_sample": "thaw-2_279C_0.014_1", "no-antibody_sample": "thaw-2_no-antibody_control_1", "censored": true, "median": 0.0014866300502868572, "percentile_25": 0.0, "percentile_75": 0.13799287061587767, "min": 0.0, "max": 1.0, "library_sample": "lib1 thaw-2_279C_0.014_1"}, {"library": "lib1", "antibody_sample": "thaw-2_279C_0.014_1", "no-antibody_sample": "thaw-2_no-antibody_control_1", "censored": false, "median": 0.0014866300502868572, "percentile_25": 0.0, "percentile_75": 0.13799287061587767, "min": 0.0, "max": 7.217018409909195, "library_sample": "lib1 thaw-2_279C_0.014_1"}, {"library": "lib1", "antibody_sample": "thaw-2_279C_0.014_2", "no-antibody_sample": "thaw-2_no-antibody_control_2", "censored": true, "median": 0.0003206559305228861, "percentile_25": 0.0, "percentile_75": 0.10574588950380373, "min": 0.0, "max": 1.0, "library_sample": "lib1 thaw-2_279C_0.014_2"}, {"library": "lib1", "antibody_sample": "thaw-2_279C_0.014_2", "no-antibody_sample": "thaw-2_no-antibody_control_2", "censored": false, "median": 0.0003206559305228861, "percentile_25": 0.0, "percentile_75": 0.10574588950380373, "min": 0.0, "max": 12.628606282403172, "library_sample": "lib1 thaw-2_279C_0.014_2"}, {"library": "lib2", "antibody_sample": "thaw-1_REGN10933_0.037_1", "no-antibody_sample": "thaw-1_no-antibody_control_1", "censored": true, "median": 0.634768740031898, "percentile_25": 0.39123538794600365, "percentile_75": 0.9278592769876093, "min": 0.0, "max": 1.0, "library_sample": "lib2 thaw-1_REGN10933_0.037_1"}, {"library": "lib2", "antibody_sample": "thaw-1_REGN10933_0.037_1", "no-antibody_sample": "thaw-1_no-antibody_control_1", "censored": false, "median": 0.634768740031898, "percentile_25": 0.39123538794600365, "percentile_75": 0.9278592769876093, "min": 0.0, "max": 6.654018583319447, "library_sample": "lib2 thaw-1_REGN10933_0.037_1"}, {"library": "lib2", "antibody_sample": "thaw-1_REGN10933_0.037_2", "no-antibody_sample": "thaw-1_no-antibody_control_2", "censored": true, "median": 0.0031816652772293156, "percentile_25": 0.0, "percentile_75": 0.528914214343192, "min": 0.0, "max": 1.0, "library_sample": "lib2 thaw-1_REGN10933_0.037_2"}, {"library": "lib2", "antibody_sample": "thaw-1_REGN10933_0.037_2", "no-antibody_sample": "thaw-1_no-antibody_control_2", "censored": false, "median": 0.0031816652772293156, "percentile_25": 0.0, "percentile_75": 0.528914214343192, "min": 0.0, "max": 8.859130032721582, "library_sample": "lib2 thaw-1_REGN10933_0.037_2"}, {"library": "lib2", "antibody_sample": "thaw-1_REGN10933_0.15_1", "no-antibody_sample": "thaw-1_no-antibody_control_1", "censored": true, "median": 0.34424427682084724, "percentile_25": 0.17634303153609854, "percentile_75": 0.5670966221609797, "min": 0.0, "max": 1.0, "library_sample": "lib2 thaw-1_REGN10933_0.15_1"}, {"library": "lib2", "antibody_sample": "thaw-1_REGN10933_0.15_1", "no-antibody_sample": "thaw-1_no-antibody_control_1", "censored": false, "median": 0.34424427682084724, "percentile_25": 0.17634303153609854, "percentile_75": 0.5670966221609797, "min": 0.0, "max": 4.176747235456095, "library_sample": "lib2 thaw-1_REGN10933_0.15_1"}, {"library": "lib2", "antibody_sample": "thaw-1_REGN10933_0.15_2", "no-antibody_sample": "thaw-1_no-antibody_control_2", "censored": true, "median": 0.303408710529252, "percentile_25": 0.18211176331547432, "percentile_75": 0.46258335601524225, "min": 0.0, "max": 1.0, "library_sample": "lib2 thaw-1_REGN10933_0.15_2"}, {"library": "lib2", "antibody_sample": "thaw-1_REGN10933_0.15_2", "no-antibody_sample": "thaw-1_no-antibody_control_2", "censored": false, "median": 0.303408710529252, "percentile_25": 0.18211176331547432, "percentile_75": 0.46258335601524225, "min": 0.0, "max": 4.824573076070082, "library_sample": "lib2 thaw-1_REGN10933_0.15_2"}, {"library": "lib2", "antibody_sample": "thaw-1_REGN10933_0.59_1", "no-antibody_sample": "thaw-1_no-antibody_control_1", "censored": true, "median": 0.08876356370605121, "percentile_25": 0.00043402525333455434, "percentile_75": 0.20228926510260703, "min": 0.0, "max": 1.0, "library_sample": "lib2 thaw-1_REGN10933_0.59_1"}, {"library": "lib2", "antibody_sample": "thaw-1_REGN10933_0.59_1", "no-antibody_sample": "thaw-1_no-antibody_control_1", "censored": false, "median": 0.08876356370605121, "percentile_25": 0.00043402525333455434, "percentile_75": 0.20228926510260703, "min": 0.0, "max": 4.555283749686662, "library_sample": "lib2 thaw-1_REGN10933_0.59_1"}, {"library": "lib2", "antibody_sample": "thaw-1_REGN10933_0.59_2", "no-antibody_sample": "thaw-1_no-antibody_control_2", "censored": true, "median": 0.061318840102064356, "percentile_25": 0.0, "percentile_75": 0.18980216909961797, "min": 0.0, "max": 1.0, "library_sample": "lib2 thaw-1_REGN10933_0.59_2"}, {"library": "lib2", "antibody_sample": "thaw-1_REGN10933_0.59_2", "no-antibody_sample": "thaw-1_no-antibody_control_2", "censored": false, "median": 0.061318840102064356, "percentile_25": 0.0, "percentile_75": 0.18980216909961797, "min": 0.0, "max": 2.7363441687202874, "library_sample": "lib2 thaw-1_REGN10933_0.59_2"}]}}, {"mode": "vega-lite"});
</script></div>
</div>
</section>
<section id="Correlations-in-variant-level-escape-probabilitites">
<h2>Correlations in variant-level escape probabilitites<a class="headerlink" href="#Correlations-in-variant-level-escape-probabilitites" title="Link to this heading">¶</a></h2>
<p>Analyze correlations between escape probabilities of different variants.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">assert</span> <span class="nb">len</span><span class="p">(</span>
    <span class="n">prob_escape_filtered</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s2">&quot;library&quot;</span><span class="p">,</span> <span class="s2">&quot;antibody_sample&quot;</span><span class="p">,</span> <span class="s2">&quot;no-antibody_sample&quot;</span><span class="p">])</span>
<span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">prob_escape_filtered</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s2">&quot;library&quot;</span><span class="p">,</span> <span class="s2">&quot;antibody_sample&quot;</span><span class="p">]))</span>

<span class="n">corrs</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">dms_variants</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">tidy_to_corr</span><span class="p">(</span>
        <span class="n">df</span><span class="o">=</span><span class="n">prob_escape_filtered</span><span class="p">,</span>
        <span class="n">sample_col</span><span class="o">=</span><span class="s2">&quot;antibody_sample&quot;</span><span class="p">,</span>
        <span class="n">label_col</span><span class="o">=</span><span class="s2">&quot;barcode&quot;</span><span class="p">,</span>
        <span class="n">value_col</span><span class="o">=</span><span class="s2">&quot;prob_escape&quot;</span><span class="p">,</span>
        <span class="n">group_cols</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;library&quot;</span><span class="p">],</span>
    <span class="p">)</span>
    <span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">r2</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="s2">&quot;correlation&quot;</span><span class="p">]</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>
    <span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="s2">&quot;correlation&quot;</span><span class="p">)</span>
<span class="p">)</span>

<span class="c1"># add other properties</span>
<span class="n">suffixes</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;_1&quot;</span><span class="p">,</span> <span class="s2">&quot;_2&quot;</span><span class="p">]</span>
<span class="k">for</span> <span class="n">suffix</span> <span class="ow">in</span> <span class="n">suffixes</span><span class="p">:</span>
    <span class="n">corrs</span> <span class="o">=</span> <span class="n">corrs</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span>
        <span class="n">selections_df</span><span class="p">,</span>
        <span class="n">left_on</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;library&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;antibody_sample</span><span class="si">{</span><span class="n">suffix</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">],</span>
        <span class="n">right_on</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;library&quot;</span><span class="p">,</span> <span class="s2">&quot;antibody_sample&quot;</span><span class="p">],</span>
        <span class="n">validate</span><span class="o">=</span><span class="s2">&quot;many_to_one&quot;</span><span class="p">,</span>
        <span class="n">suffixes</span><span class="o">=</span><span class="n">suffixes</span><span class="p">,</span>
    <span class="p">)</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="s2">&quot;antibody_sample&quot;</span><span class="p">)</span>

<span class="n">corrs</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>library</th>
      <th>antibody_sample_1</th>
      <th>antibody_sample_2</th>
      <th>r2</th>
      <th>no-antibody_sample_1</th>
      <th>antibody_concentration_1</th>
      <th>no-antibody_sample_2</th>
      <th>antibody_concentration_2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>lib1</td>
      <td>thaw-1_REGN10933_0.037_1</td>
      <td>thaw-1_REGN10933_0.037_1</td>
      <td>1.000</td>
      <td>thaw-1_no-antibody_control_1</td>
      <td>0.037</td>
      <td>thaw-1_no-antibody_control_1</td>
      <td>0.037</td>
    </tr>
    <tr>
      <th>1</th>
      <td>lib1</td>
      <td>thaw-1_REGN10933_0.15_1</td>
      <td>thaw-1_REGN10933_0.037_1</td>
      <td>0.100</td>
      <td>thaw-1_no-antibody_control_1</td>
      <td>0.150</td>
      <td>thaw-1_no-antibody_control_1</td>
      <td>0.037</td>
    </tr>
    <tr>
      <th>2</th>
      <td>lib1</td>
      <td>thaw-1_REGN10933_0.15_2</td>
      <td>thaw-1_REGN10933_0.037_1</td>
      <td>0.001</td>
      <td>thaw-1_no-antibody_control_2</td>
      <td>0.150</td>
      <td>thaw-1_no-antibody_control_1</td>
      <td>0.037</td>
    </tr>
    <tr>
      <th>3</th>
      <td>lib1</td>
      <td>thaw-1_REGN10933_0.59_1</td>
      <td>thaw-1_REGN10933_0.037_1</td>
      <td>0.020</td>
      <td>thaw-1_no-antibody_control_1</td>
      <td>0.590</td>
      <td>thaw-1_no-antibody_control_1</td>
      <td>0.037</td>
    </tr>
    <tr>
      <th>4</th>
      <td>lib1</td>
      <td>thaw-1_REGN10933_0.59_2</td>
      <td>thaw-1_REGN10933_0.037_1</td>
      <td>0.000</td>
      <td>thaw-1_no-antibody_control_2</td>
      <td>0.590</td>
      <td>thaw-1_no-antibody_control_1</td>
      <td>0.037</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[19]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># NBVAL_SKIP</span>

<span class="k">for</span> <span class="n">library</span><span class="p">,</span> <span class="n">library_corr</span> <span class="ow">in</span> <span class="n">corrs</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;library&quot;</span><span class="p">):</span>
    <span class="n">corr_chart</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">library_corr</span><span class="p">)</span>
        <span class="o">.</span><span class="n">encode</span><span class="p">(</span>
            <span class="n">alt</span><span class="o">.</span><span class="n">X</span><span class="p">(</span><span class="s2">&quot;antibody_sample_1&quot;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="kc">None</span><span class="p">),</span>
            <span class="n">alt</span><span class="o">.</span><span class="n">Y</span><span class="p">(</span><span class="s2">&quot;antibody_sample_2&quot;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="kc">None</span><span class="p">),</span>
            <span class="n">color</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">Color</span><span class="p">(</span><span class="s2">&quot;r2&quot;</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">Scale</span><span class="p">(</span><span class="n">zero</span><span class="o">=</span><span class="kc">True</span><span class="p">)),</span>
            <span class="n">tooltip</span><span class="o">=</span><span class="p">[</span>
                <span class="p">(</span>
                    <span class="n">alt</span><span class="o">.</span><span class="n">Tooltip</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s2">&quot;.3g&quot;</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">c</span> <span class="o">==</span> <span class="s2">&quot;r2&quot;</span> <span class="ow">or</span> <span class="n">c</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;antibody_concentration&quot;</span><span class="p">)</span>
                    <span class="k">else</span> <span class="n">c</span>
                <span class="p">)</span>
                <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">library_corr</span><span class="o">.</span><span class="n">columns</span>
            <span class="p">],</span>
        <span class="p">)</span>
        <span class="o">.</span><span class="n">mark_rect</span><span class="p">(</span><span class="n">stroke</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">)</span>
        <span class="o">.</span><span class="n">properties</span><span class="p">(</span><span class="n">width</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">Step</span><span class="p">(</span><span class="mi">15</span><span class="p">),</span> <span class="n">height</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">Step</span><span class="p">(</span><span class="mi">15</span><span class="p">),</span> <span class="n">title</span><span class="o">=</span><span class="n">library</span><span class="p">)</span>
        <span class="o">.</span><span class="n">configure_axis</span><span class="p">(</span><span class="n">labelLimit</span><span class="o">=</span><span class="mi">500</span><span class="p">)</span>
    <span class="p">)</span>
    <span class="n">display</span><span class="p">(</span><span class="n">corr_chart</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<div id="altair-viz-9755a84300774c1d8d4f0f9d2baff3a2"></div>
<script type="text/javascript">
  var VEGA_DEBUG = (typeof VEGA_DEBUG == "undefined") ? {} : VEGA_DEBUG;
  (function(spec, embedOpt){
    let outputDiv = document.currentScript.previousElementSibling;
    if (outputDiv.id !== "altair-viz-9755a84300774c1d8d4f0f9d2baff3a2") {
      outputDiv = document.getElementById("altair-viz-9755a84300774c1d8d4f0f9d2baff3a2");
    }
    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm/vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm/vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm/vega-lite@5.6.1?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm/vega-embed@6?noext",
    };

    function maybeLoadScript(lib, version) {
      var key = `${lib.replace("-", "")}_version`;
      return (VEGA_DEBUG[key] == version) ?
        Promise.resolve(paths[lib]) :
        new Promise(function(resolve, reject) {
          var s = document.createElement('script');
          document.getElementsByTagName("head")[0].appendChild(s);
          s.async = true;
          s.onload = () => {
            VEGA_DEBUG[key] = version;
            return resolve(paths[lib]);
          };
          s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
          s.src = paths[lib];
        });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      require(["vega-embed"], displayChart, err => showError(`Error loading script: ${err.message}`));
    } else {
      maybeLoadScript("vega", "5")
        .then(() => maybeLoadScript("vega-lite", "5.6.1"))
        .then(() => maybeLoadScript("vega-embed", "6"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"config": {"view": {"continuousWidth": 300, "continuousHeight": 300}, "axis": {"labelLimit": 500}}, "data": {"name": "data-19305ba02a993cc3cfb36cbddeefd736"}, "mark": {"type": "rect", "stroke": "black"}, "encoding": {"color": {"field": "r2", "scale": {"zero": true}, "type": "quantitative"}, "tooltip": [{"field": "library", "type": "nominal"}, {"field": "antibody_sample_1", "type": "nominal"}, {"field": "antibody_sample_2", "type": "nominal"}, {"field": "r2", "format": ".3g", "type": "quantitative"}, {"field": "no-antibody_sample_1", "type": "nominal"}, {"field": "antibody_concentration_1", "format": ".3g", "type": "quantitative"}, {"field": "no-antibody_sample_2", "type": "nominal"}, {"field": "antibody_concentration_2", "format": ".3g", "type": "quantitative"}], "x": {"field": "antibody_sample_1", "title": null, "type": "nominal"}, "y": {"field": "antibody_sample_2", "title": null, "type": "nominal"}}, "height": {"step": 15}, "title": "lib1", "width": {"step": 15}, "$schema": "https://vega.github.io/schema/vega-lite/v5.6.1.json", "datasets": {"data-19305ba02a993cc3cfb36cbddeefd736": [{"library": "lib1", "antibody_sample_1": "thaw-1_REGN10933_0.037_1", "antibody_sample_2": "thaw-1_REGN10933_0.037_1", "r2": 1.0, "no-antibody_sample_1": "thaw-1_no-antibody_control_1", "antibody_concentration_1": 0.037, "no-antibody_sample_2": "thaw-1_no-antibody_control_1", "antibody_concentration_2": 0.037}, {"library": "lib1", "antibody_sample_1": "thaw-1_REGN10933_0.15_1", "antibody_sample_2": "thaw-1_REGN10933_0.037_1", "r2": 0.09986393113508024, "no-antibody_sample_1": "thaw-1_no-antibody_control_1", "antibody_concentration_1": 0.15, "no-antibody_sample_2": "thaw-1_no-antibody_control_1", "antibody_concentration_2": 0.037}, {"library": "lib1", "antibody_sample_1": "thaw-1_REGN10933_0.15_2", "antibody_sample_2": "thaw-1_REGN10933_0.037_1", "r2": 0.0008576098468454957, "no-antibody_sample_1": "thaw-1_no-antibody_control_2", "antibody_concentration_1": 0.15, "no-antibody_sample_2": "thaw-1_no-antibody_control_1", "antibody_concentration_2": 0.037}, {"library": "lib1", "antibody_sample_1": "thaw-1_REGN10933_0.59_1", "antibody_sample_2": "thaw-1_REGN10933_0.037_1", "r2": 0.020396664497535813, "no-antibody_sample_1": "thaw-1_no-antibody_control_1", "antibody_concentration_1": 0.59, "no-antibody_sample_2": "thaw-1_no-antibody_control_1", "antibody_concentration_2": 0.037}, {"library": "lib1", "antibody_sample_1": "thaw-1_REGN10933_0.59_2", "antibody_sample_2": "thaw-1_REGN10933_0.037_1", "r2": 0.00014986461902863086, "no-antibody_sample_1": "thaw-1_no-antibody_control_2", "antibody_concentration_1": 0.59, "no-antibody_sample_2": "thaw-1_no-antibody_control_1", "antibody_concentration_2": 0.037}, {"library": "lib1", "antibody_sample_1": "thaw-2_279C_0.00088_1", "antibody_sample_2": "thaw-1_REGN10933_0.037_1", "r2": 0.0024848217335301835, "no-antibody_sample_1": "thaw-2_no-antibody_control_1", "antibody_concentration_1": 0.00088, "no-antibody_sample_2": "thaw-1_no-antibody_control_1", "antibody_concentration_2": 0.037}, {"library": "lib1", "antibody_sample_1": "thaw-2_279C_0.00088_2", "antibody_sample_2": "thaw-1_REGN10933_0.037_1", "r2": 0.0028008613379884874, "no-antibody_sample_1": "thaw-2_no-antibody_control_2", "antibody_concentration_1": 0.00088, "no-antibody_sample_2": "thaw-1_no-antibody_control_1", "antibody_concentration_2": 0.037}, {"library": "lib1", "antibody_sample_1": "thaw-2_279C_0.0035_1", "antibody_sample_2": "thaw-1_REGN10933_0.037_1", "r2": 0.004982529901616488, "no-antibody_sample_1": "thaw-2_no-antibody_control_1", "antibody_concentration_1": 0.0035, "no-antibody_sample_2": "thaw-1_no-antibody_control_1", "antibody_concentration_2": 0.037}, {"library": "lib1", "antibody_sample_1": "thaw-2_279C_0.0035_2", "antibody_sample_2": "thaw-1_REGN10933_0.037_1", "r2": 0.0008119386229944919, "no-antibody_sample_1": "thaw-2_no-antibody_control_2", "antibody_concentration_1": 0.0035, "no-antibody_sample_2": "thaw-1_no-antibody_control_1", "antibody_concentration_2": 0.037}, {"library": "lib1", "antibody_sample_1": "thaw-2_279C_0.014_1", "antibody_sample_2": "thaw-1_REGN10933_0.037_1", "r2": 3.0161103905594318e-05, "no-antibody_sample_1": "thaw-2_no-antibody_control_1", "antibody_concentration_1": 0.014, "no-antibody_sample_2": "thaw-1_no-antibody_control_1", "antibody_concentration_2": 0.037}, {"library": "lib1", "antibody_sample_1": "thaw-2_279C_0.014_2", "antibody_sample_2": "thaw-1_REGN10933_0.037_1", "r2": 0.00026754114194578547, "no-antibody_sample_1": "thaw-2_no-antibody_control_2", "antibody_concentration_1": 0.014, "no-antibody_sample_2": "thaw-1_no-antibody_control_1", "antibody_concentration_2": 0.037}, {"library": "lib1", "antibody_sample_1": "thaw-1_REGN10933_0.037_1", "antibody_sample_2": "thaw-1_REGN10933_0.15_1", "r2": 0.09986393113508024, "no-antibody_sample_1": "thaw-1_no-antibody_control_1", "antibody_concentration_1": 0.037, "no-antibody_sample_2": "thaw-1_no-antibody_control_1", "antibody_concentration_2": 0.15}, {"library": "lib1", "antibody_sample_1": "thaw-1_REGN10933_0.15_1", "antibody_sample_2": "thaw-1_REGN10933_0.15_1", "r2": 1.0, "no-antibody_sample_1": "thaw-1_no-antibody_control_1", "antibody_concentration_1": 0.15, "no-antibody_sample_2": "thaw-1_no-antibody_control_1", "antibody_concentration_2": 0.15}, {"library": "lib1", "antibody_sample_1": "thaw-1_REGN10933_0.15_2", "antibody_sample_2": "thaw-1_REGN10933_0.15_1", "r2": 0.009941988357145585, "no-antibody_sample_1": "thaw-1_no-antibody_control_2", "antibody_concentration_1": 0.15, "no-antibody_sample_2": "thaw-1_no-antibody_control_1", "antibody_concentration_2": 0.15}, {"library": "lib1", "antibody_sample_1": "thaw-1_REGN10933_0.59_1", "antibody_sample_2": "thaw-1_REGN10933_0.15_1", "r2": 0.05367565933400398, "no-antibody_sample_1": "thaw-1_no-antibody_control_1", "antibody_concentration_1": 0.59, "no-antibody_sample_2": "thaw-1_no-antibody_control_1", "antibody_concentration_2": 0.15}, {"library": "lib1", "antibody_sample_1": "thaw-1_REGN10933_0.59_2", "antibody_sample_2": "thaw-1_REGN10933_0.15_1", "r2": 0.00718077513903643, "no-antibody_sample_1": "thaw-1_no-antibody_control_2", "antibody_concentration_1": 0.59, "no-antibody_sample_2": "thaw-1_no-antibody_control_1", "antibody_concentration_2": 0.15}, {"library": "lib1", "antibody_sample_1": "thaw-2_279C_0.00088_1", "antibody_sample_2": "thaw-1_REGN10933_0.15_1", "r2": 0.00015667853367472536, "no-antibody_sample_1": "thaw-2_no-antibody_control_1", "antibody_concentration_1": 0.00088, "no-antibody_sample_2": "thaw-1_no-antibody_control_1", "antibody_concentration_2": 0.15}, {"library": "lib1", "antibody_sample_1": "thaw-2_279C_0.00088_2", "antibody_sample_2": "thaw-1_REGN10933_0.15_1", "r2": 0.00036092966703404536, "no-antibody_sample_1": "thaw-2_no-antibody_control_2", "antibody_concentration_1": 0.00088, "no-antibody_sample_2": "thaw-1_no-antibody_control_1", "antibody_concentration_2": 0.15}, {"library": "lib1", "antibody_sample_1": "thaw-2_279C_0.0035_1", "antibody_sample_2": "thaw-1_REGN10933_0.15_1", "r2": 0.0015017840366661082, "no-antibody_sample_1": "thaw-2_no-antibody_control_1", "antibody_concentration_1": 0.0035, "no-antibody_sample_2": "thaw-1_no-antibody_control_1", "antibody_concentration_2": 0.15}, {"library": "lib1", "antibody_sample_1": "thaw-2_279C_0.0035_2", "antibody_sample_2": "thaw-1_REGN10933_0.15_1", "r2": 0.00028912556957744347, "no-antibody_sample_1": "thaw-2_no-antibody_control_2", "antibody_concentration_1": 0.0035, "no-antibody_sample_2": "thaw-1_no-antibody_control_1", "antibody_concentration_2": 0.15}, {"library": "lib1", "antibody_sample_1": "thaw-2_279C_0.014_1", "antibody_sample_2": "thaw-1_REGN10933_0.15_1", "r2": 0.008513267778456122, "no-antibody_sample_1": "thaw-2_no-antibody_control_1", "antibody_concentration_1": 0.014, "no-antibody_sample_2": "thaw-1_no-antibody_control_1", "antibody_concentration_2": 0.15}, {"library": "lib1", "antibody_sample_1": "thaw-2_279C_0.014_2", "antibody_sample_2": "thaw-1_REGN10933_0.15_1", "r2": 0.007630502561114511, "no-antibody_sample_1": "thaw-2_no-antibody_control_2", "antibody_concentration_1": 0.014, "no-antibody_sample_2": "thaw-1_no-antibody_control_1", "antibody_concentration_2": 0.15}, {"library": "lib1", "antibody_sample_1": "thaw-1_REGN10933_0.037_1", "antibody_sample_2": "thaw-1_REGN10933_0.15_2", "r2": 0.0008576098468454957, "no-antibody_sample_1": "thaw-1_no-antibody_control_1", "antibody_concentration_1": 0.037, "no-antibody_sample_2": "thaw-1_no-antibody_control_2", "antibody_concentration_2": 0.15}, {"library": "lib1", "antibody_sample_1": "thaw-1_REGN10933_0.15_1", "antibody_sample_2": "thaw-1_REGN10933_0.15_2", "r2": 0.009941988357145585, "no-antibody_sample_1": "thaw-1_no-antibody_control_1", "antibody_concentration_1": 0.15, "no-antibody_sample_2": "thaw-1_no-antibody_control_2", "antibody_concentration_2": 0.15}, {"library": "lib1", "antibody_sample_1": "thaw-1_REGN10933_0.15_2", "antibody_sample_2": "thaw-1_REGN10933_0.15_2", "r2": 1.0, "no-antibody_sample_1": "thaw-1_no-antibody_control_2", "antibody_concentration_1": 0.15, "no-antibody_sample_2": "thaw-1_no-antibody_control_2", "antibody_concentration_2": 0.15}, {"library": "lib1", "antibody_sample_1": "thaw-1_REGN10933_0.59_1", "antibody_sample_2": "thaw-1_REGN10933_0.15_2", "r2": 0.012760361467111193, "no-antibody_sample_1": "thaw-1_no-antibody_control_1", "antibody_concentration_1": 0.59, "no-antibody_sample_2": "thaw-1_no-antibody_control_2", "antibody_concentration_2": 0.15}, {"library": "lib1", "antibody_sample_1": "thaw-1_REGN10933_0.59_2", "antibody_sample_2": "thaw-1_REGN10933_0.15_2", "r2": 0.032635759296141785, "no-antibody_sample_1": "thaw-1_no-antibody_control_2", "antibody_concentration_1": 0.59, "no-antibody_sample_2": "thaw-1_no-antibody_control_2", "antibody_concentration_2": 0.15}, {"library": "lib1", "antibody_sample_1": "thaw-2_279C_0.00088_1", "antibody_sample_2": "thaw-1_REGN10933_0.15_2", "r2": 0.0006903147116824683, "no-antibody_sample_1": "thaw-2_no-antibody_control_1", "antibody_concentration_1": 0.00088, "no-antibody_sample_2": "thaw-1_no-antibody_control_2", "antibody_concentration_2": 0.15}, {"library": "lib1", "antibody_sample_1": "thaw-2_279C_0.00088_2", "antibody_sample_2": "thaw-1_REGN10933_0.15_2", "r2": 8.867159497075221e-05, "no-antibody_sample_1": "thaw-2_no-antibody_control_2", "antibody_concentration_1": 0.00088, "no-antibody_sample_2": "thaw-1_no-antibody_control_2", "antibody_concentration_2": 0.15}, {"library": "lib1", "antibody_sample_1": "thaw-2_279C_0.0035_1", "antibody_sample_2": "thaw-1_REGN10933_0.15_2", "r2": 0.0006745083621130504, "no-antibody_sample_1": "thaw-2_no-antibody_control_1", "antibody_concentration_1": 0.0035, "no-antibody_sample_2": "thaw-1_no-antibody_control_2", "antibody_concentration_2": 0.15}, {"library": "lib1", "antibody_sample_1": "thaw-2_279C_0.0035_2", "antibody_sample_2": "thaw-1_REGN10933_0.15_2", "r2": 0.00010460763766107928, "no-antibody_sample_1": "thaw-2_no-antibody_control_2", "antibody_concentration_1": 0.0035, "no-antibody_sample_2": "thaw-1_no-antibody_control_2", "antibody_concentration_2": 0.15}, {"library": "lib1", "antibody_sample_1": "thaw-2_279C_0.014_1", "antibody_sample_2": "thaw-1_REGN10933_0.15_2", "r2": 0.01236525394897094, "no-antibody_sample_1": "thaw-2_no-antibody_control_1", "antibody_concentration_1": 0.014, "no-antibody_sample_2": "thaw-1_no-antibody_control_2", "antibody_concentration_2": 0.15}, {"library": "lib1", "antibody_sample_1": "thaw-2_279C_0.014_2", "antibody_sample_2": "thaw-1_REGN10933_0.15_2", "r2": 0.0038098053213595348, "no-antibody_sample_1": "thaw-2_no-antibody_control_2", "antibody_concentration_1": 0.014, "no-antibody_sample_2": "thaw-1_no-antibody_control_2", "antibody_concentration_2": 0.15}, {"library": "lib1", "antibody_sample_1": "thaw-1_REGN10933_0.037_1", "antibody_sample_2": "thaw-1_REGN10933_0.59_1", "r2": 0.020396664497535813, "no-antibody_sample_1": "thaw-1_no-antibody_control_1", "antibody_concentration_1": 0.037, "no-antibody_sample_2": "thaw-1_no-antibody_control_1", "antibody_concentration_2": 0.59}, {"library": "lib1", "antibody_sample_1": "thaw-1_REGN10933_0.15_1", "antibody_sample_2": "thaw-1_REGN10933_0.59_1", "r2": 0.05367565933400398, "no-antibody_sample_1": "thaw-1_no-antibody_control_1", "antibody_concentration_1": 0.15, "no-antibody_sample_2": "thaw-1_no-antibody_control_1", "antibody_concentration_2": 0.59}, {"library": "lib1", "antibody_sample_1": "thaw-1_REGN10933_0.15_2", "antibody_sample_2": "thaw-1_REGN10933_0.59_1", "r2": 0.012760361467111193, "no-antibody_sample_1": "thaw-1_no-antibody_control_2", "antibody_concentration_1": 0.15, "no-antibody_sample_2": "thaw-1_no-antibody_control_1", "antibody_concentration_2": 0.59}, {"library": "lib1", "antibody_sample_1": "thaw-1_REGN10933_0.59_1", "antibody_sample_2": "thaw-1_REGN10933_0.59_1", "r2": 1.0, "no-antibody_sample_1": "thaw-1_no-antibody_control_1", "antibody_concentration_1": 0.59, "no-antibody_sample_2": "thaw-1_no-antibody_control_1", "antibody_concentration_2": 0.59}, {"library": "lib1", "antibody_sample_1": "thaw-1_REGN10933_0.59_2", "antibody_sample_2": "thaw-1_REGN10933_0.59_1", "r2": 0.03097281612524894, "no-antibody_sample_1": "thaw-1_no-antibody_control_2", "antibody_concentration_1": 0.59, "no-antibody_sample_2": "thaw-1_no-antibody_control_1", "antibody_concentration_2": 0.59}, {"library": "lib1", "antibody_sample_1": "thaw-2_279C_0.00088_1", "antibody_sample_2": "thaw-1_REGN10933_0.59_1", "r2": 2.560426621896335e-05, "no-antibody_sample_1": "thaw-2_no-antibody_control_1", "antibody_concentration_1": 0.00088, "no-antibody_sample_2": "thaw-1_no-antibody_control_1", "antibody_concentration_2": 0.59}, {"library": "lib1", "antibody_sample_1": "thaw-2_279C_0.00088_2", "antibody_sample_2": "thaw-1_REGN10933_0.59_1", "r2": 1.3657455655159854e-05, "no-antibody_sample_1": "thaw-2_no-antibody_control_2", "antibody_concentration_1": 0.00088, "no-antibody_sample_2": "thaw-1_no-antibody_control_1", "antibody_concentration_2": 0.59}, {"library": "lib1", "antibody_sample_1": "thaw-2_279C_0.0035_1", "antibody_sample_2": "thaw-1_REGN10933_0.59_1", "r2": 4.20577983526092e-05, "no-antibody_sample_1": "thaw-2_no-antibody_control_1", "antibody_concentration_1": 0.0035, "no-antibody_sample_2": "thaw-1_no-antibody_control_1", "antibody_concentration_2": 0.59}, {"library": "lib1", "antibody_sample_1": "thaw-2_279C_0.0035_2", "antibody_sample_2": "thaw-1_REGN10933_0.59_1", "r2": 0.0003425950781871228, "no-antibody_sample_1": "thaw-2_no-antibody_control_2", "antibody_concentration_1": 0.0035, "no-antibody_sample_2": "thaw-1_no-antibody_control_1", "antibody_concentration_2": 0.59}, {"library": "lib1", "antibody_sample_1": "thaw-2_279C_0.014_1", "antibody_sample_2": "thaw-1_REGN10933_0.59_1", "r2": 0.021028091257975192, "no-antibody_sample_1": "thaw-2_no-antibody_control_1", "antibody_concentration_1": 0.014, "no-antibody_sample_2": "thaw-1_no-antibody_control_1", "antibody_concentration_2": 0.59}, {"library": "lib1", "antibody_sample_1": "thaw-2_279C_0.014_2", "antibody_sample_2": "thaw-1_REGN10933_0.59_1", "r2": 0.0216975347191963, "no-antibody_sample_1": "thaw-2_no-antibody_control_2", "antibody_concentration_1": 0.014, "no-antibody_sample_2": "thaw-1_no-antibody_control_1", "antibody_concentration_2": 0.59}, {"library": "lib1", "antibody_sample_1": "thaw-1_REGN10933_0.037_1", "antibody_sample_2": "thaw-1_REGN10933_0.59_2", "r2": 0.00014986461902863086, "no-antibody_sample_1": "thaw-1_no-antibody_control_1", "antibody_concentration_1": 0.037, "no-antibody_sample_2": "thaw-1_no-antibody_control_2", "antibody_concentration_2": 0.59}, {"library": "lib1", "antibody_sample_1": "thaw-1_REGN10933_0.15_1", "antibody_sample_2": "thaw-1_REGN10933_0.59_2", "r2": 0.00718077513903643, "no-antibody_sample_1": "thaw-1_no-antibody_control_1", "antibody_concentration_1": 0.15, "no-antibody_sample_2": "thaw-1_no-antibody_control_2", "antibody_concentration_2": 0.59}, {"library": "lib1", "antibody_sample_1": "thaw-1_REGN10933_0.15_2", "antibody_sample_2": "thaw-1_REGN10933_0.59_2", "r2": 0.032635759296141785, "no-antibody_sample_1": "thaw-1_no-antibody_control_2", "antibody_concentration_1": 0.15, "no-antibody_sample_2": "thaw-1_no-antibody_control_2", "antibody_concentration_2": 0.59}, {"library": "lib1", "antibody_sample_1": "thaw-1_REGN10933_0.59_1", "antibody_sample_2": "thaw-1_REGN10933_0.59_2", "r2": 0.03097281612524894, "no-antibody_sample_1": "thaw-1_no-antibody_control_1", "antibody_concentration_1": 0.59, "no-antibody_sample_2": "thaw-1_no-antibody_control_2", "antibody_concentration_2": 0.59}, {"library": "lib1", "antibody_sample_1": "thaw-1_REGN10933_0.59_2", "antibody_sample_2": "thaw-1_REGN10933_0.59_2", "r2": 1.0, "no-antibody_sample_1": "thaw-1_no-antibody_control_2", "antibody_concentration_1": 0.59, "no-antibody_sample_2": "thaw-1_no-antibody_control_2", "antibody_concentration_2": 0.59}, {"library": "lib1", "antibody_sample_1": "thaw-2_279C_0.00088_1", "antibody_sample_2": "thaw-1_REGN10933_0.59_2", "r2": 0.003476243557214972, "no-antibody_sample_1": "thaw-2_no-antibody_control_1", "antibody_concentration_1": 0.00088, "no-antibody_sample_2": "thaw-1_no-antibody_control_2", "antibody_concentration_2": 0.59}, {"library": "lib1", "antibody_sample_1": "thaw-2_279C_0.00088_2", "antibody_sample_2": "thaw-1_REGN10933_0.59_2", "r2": 0.0008876850825589033, "no-antibody_sample_1": "thaw-2_no-antibody_control_2", "antibody_concentration_1": 0.00088, "no-antibody_sample_2": "thaw-1_no-antibody_control_2", "antibody_concentration_2": 0.59}, {"library": "lib1", "antibody_sample_1": "thaw-2_279C_0.0035_1", "antibody_sample_2": "thaw-1_REGN10933_0.59_2", "r2": 0.0001938837890007351, "no-antibody_sample_1": "thaw-2_no-antibody_control_1", "antibody_concentration_1": 0.0035, "no-antibody_sample_2": "thaw-1_no-antibody_control_2", "antibody_concentration_2": 0.59}, {"library": "lib1", "antibody_sample_1": "thaw-2_279C_0.0035_2", "antibody_sample_2": "thaw-1_REGN10933_0.59_2", "r2": 0.00017538237121351262, "no-antibody_sample_1": "thaw-2_no-antibody_control_2", "antibody_concentration_1": 0.0035, "no-antibody_sample_2": "thaw-1_no-antibody_control_2", "antibody_concentration_2": 0.59}, {"library": "lib1", "antibody_sample_1": "thaw-2_279C_0.014_1", "antibody_sample_2": "thaw-1_REGN10933_0.59_2", "r2": 0.022157761046978402, "no-antibody_sample_1": "thaw-2_no-antibody_control_1", "antibody_concentration_1": 0.014, "no-antibody_sample_2": "thaw-1_no-antibody_control_2", "antibody_concentration_2": 0.59}, {"library": "lib1", "antibody_sample_1": "thaw-2_279C_0.014_2", "antibody_sample_2": "thaw-1_REGN10933_0.59_2", "r2": 0.022050984965314994, "no-antibody_sample_1": "thaw-2_no-antibody_control_2", "antibody_concentration_1": 0.014, "no-antibody_sample_2": "thaw-1_no-antibody_control_2", "antibody_concentration_2": 0.59}, {"library": "lib1", "antibody_sample_1": "thaw-1_REGN10933_0.037_1", "antibody_sample_2": "thaw-2_279C_0.00088_1", "r2": 0.0024848217335301835, "no-antibody_sample_1": "thaw-1_no-antibody_control_1", "antibody_concentration_1": 0.037, "no-antibody_sample_2": "thaw-2_no-antibody_control_1", "antibody_concentration_2": 0.00088}, {"library": "lib1", "antibody_sample_1": "thaw-1_REGN10933_0.15_1", "antibody_sample_2": "thaw-2_279C_0.00088_1", "r2": 0.00015667853367472536, "no-antibody_sample_1": "thaw-1_no-antibody_control_1", "antibody_concentration_1": 0.15, "no-antibody_sample_2": "thaw-2_no-antibody_control_1", "antibody_concentration_2": 0.00088}, {"library": "lib1", "antibody_sample_1": "thaw-1_REGN10933_0.15_2", "antibody_sample_2": "thaw-2_279C_0.00088_1", "r2": 0.0006903147116824683, "no-antibody_sample_1": "thaw-1_no-antibody_control_2", "antibody_concentration_1": 0.15, "no-antibody_sample_2": "thaw-2_no-antibody_control_1", "antibody_concentration_2": 0.00088}, {"library": "lib1", "antibody_sample_1": "thaw-1_REGN10933_0.59_1", "antibody_sample_2": "thaw-2_279C_0.00088_1", "r2": 2.560426621896335e-05, "no-antibody_sample_1": "thaw-1_no-antibody_control_1", "antibody_concentration_1": 0.59, "no-antibody_sample_2": "thaw-2_no-antibody_control_1", "antibody_concentration_2": 0.00088}, {"library": "lib1", "antibody_sample_1": "thaw-1_REGN10933_0.59_2", "antibody_sample_2": "thaw-2_279C_0.00088_1", "r2": 0.003476243557214972, "no-antibody_sample_1": "thaw-1_no-antibody_control_2", "antibody_concentration_1": 0.59, "no-antibody_sample_2": "thaw-2_no-antibody_control_1", "antibody_concentration_2": 0.00088}, {"library": "lib1", "antibody_sample_1": "thaw-2_279C_0.00088_1", "antibody_sample_2": "thaw-2_279C_0.00088_1", "r2": 1.0, "no-antibody_sample_1": "thaw-2_no-antibody_control_1", "antibody_concentration_1": 0.00088, "no-antibody_sample_2": "thaw-2_no-antibody_control_1", "antibody_concentration_2": 0.00088}, {"library": "lib1", "antibody_sample_1": "thaw-2_279C_0.00088_2", "antibody_sample_2": "thaw-2_279C_0.00088_1", "r2": 0.012202050082894957, "no-antibody_sample_1": "thaw-2_no-antibody_control_2", "antibody_concentration_1": 0.00088, "no-antibody_sample_2": "thaw-2_no-antibody_control_1", "antibody_concentration_2": 0.00088}, {"library": "lib1", "antibody_sample_1": "thaw-2_279C_0.0035_1", "antibody_sample_2": "thaw-2_279C_0.00088_1", "r2": 0.14399260145534495, "no-antibody_sample_1": "thaw-2_no-antibody_control_1", "antibody_concentration_1": 0.0035, "no-antibody_sample_2": "thaw-2_no-antibody_control_1", "antibody_concentration_2": 0.00088}, {"library": "lib1", "antibody_sample_1": "thaw-2_279C_0.0035_2", "antibody_sample_2": "thaw-2_279C_0.00088_1", "r2": 0.015083327762681883, "no-antibody_sample_1": "thaw-2_no-antibody_control_2", "antibody_concentration_1": 0.0035, "no-antibody_sample_2": "thaw-2_no-antibody_control_1", "antibody_concentration_2": 0.00088}, {"library": "lib1", "antibody_sample_1": "thaw-2_279C_0.014_1", "antibody_sample_2": "thaw-2_279C_0.00088_1", "r2": 0.003865173205946342, "no-antibody_sample_1": "thaw-2_no-antibody_control_1", "antibody_concentration_1": 0.014, "no-antibody_sample_2": "thaw-2_no-antibody_control_1", "antibody_concentration_2": 0.00088}, {"library": "lib1", "antibody_sample_1": "thaw-2_279C_0.014_2", "antibody_sample_2": "thaw-2_279C_0.00088_1", "r2": 2.3945995436614e-06, "no-antibody_sample_1": "thaw-2_no-antibody_control_2", "antibody_concentration_1": 0.014, "no-antibody_sample_2": "thaw-2_no-antibody_control_1", "antibody_concentration_2": 0.00088}, {"library": "lib1", "antibody_sample_1": "thaw-1_REGN10933_0.037_1", "antibody_sample_2": "thaw-2_279C_0.00088_2", "r2": 0.0028008613379884874, "no-antibody_sample_1": "thaw-1_no-antibody_control_1", "antibody_concentration_1": 0.037, "no-antibody_sample_2": "thaw-2_no-antibody_control_2", "antibody_concentration_2": 0.00088}, {"library": "lib1", "antibody_sample_1": "thaw-1_REGN10933_0.15_1", "antibody_sample_2": "thaw-2_279C_0.00088_2", "r2": 0.00036092966703404536, "no-antibody_sample_1": "thaw-1_no-antibody_control_1", "antibody_concentration_1": 0.15, "no-antibody_sample_2": "thaw-2_no-antibody_control_2", "antibody_concentration_2": 0.00088}, {"library": "lib1", "antibody_sample_1": "thaw-1_REGN10933_0.15_2", "antibody_sample_2": "thaw-2_279C_0.00088_2", "r2": 8.867159497075221e-05, "no-antibody_sample_1": "thaw-1_no-antibody_control_2", "antibody_concentration_1": 0.15, "no-antibody_sample_2": "thaw-2_no-antibody_control_2", "antibody_concentration_2": 0.00088}, {"library": "lib1", "antibody_sample_1": "thaw-1_REGN10933_0.59_1", "antibody_sample_2": "thaw-2_279C_0.00088_2", "r2": 1.3657455655159854e-05, "no-antibody_sample_1": "thaw-1_no-antibody_control_1", "antibody_concentration_1": 0.59, "no-antibody_sample_2": "thaw-2_no-antibody_control_2", "antibody_concentration_2": 0.00088}, {"library": "lib1", "antibody_sample_1": "thaw-1_REGN10933_0.59_2", "antibody_sample_2": "thaw-2_279C_0.00088_2", "r2": 0.0008876850825589033, "no-antibody_sample_1": "thaw-1_no-antibody_control_2", "antibody_concentration_1": 0.59, "no-antibody_sample_2": "thaw-2_no-antibody_control_2", "antibody_concentration_2": 0.00088}, {"library": "lib1", "antibody_sample_1": "thaw-2_279C_0.00088_1", "antibody_sample_2": "thaw-2_279C_0.00088_2", "r2": 0.012202050082894957, "no-antibody_sample_1": "thaw-2_no-antibody_control_1", "antibody_concentration_1": 0.00088, "no-antibody_sample_2": "thaw-2_no-antibody_control_2", "antibody_concentration_2": 0.00088}, {"library": "lib1", "antibody_sample_1": "thaw-2_279C_0.00088_2", "antibody_sample_2": "thaw-2_279C_0.00088_2", "r2": 1.0, "no-antibody_sample_1": "thaw-2_no-antibody_control_2", "antibody_concentration_1": 0.00088, "no-antibody_sample_2": "thaw-2_no-antibody_control_2", "antibody_concentration_2": 0.00088}, {"library": "lib1", "antibody_sample_1": "thaw-2_279C_0.0035_1", "antibody_sample_2": "thaw-2_279C_0.00088_2", "r2": 0.009535307128808899, "no-antibody_sample_1": "thaw-2_no-antibody_control_1", "antibody_concentration_1": 0.0035, "no-antibody_sample_2": "thaw-2_no-antibody_control_2", "antibody_concentration_2": 0.00088}, {"library": "lib1", "antibody_sample_1": "thaw-2_279C_0.0035_2", "antibody_sample_2": "thaw-2_279C_0.00088_2", "r2": 0.14111160753954377, "no-antibody_sample_1": "thaw-2_no-antibody_control_2", "antibody_concentration_1": 0.0035, "no-antibody_sample_2": "thaw-2_no-antibody_control_2", "antibody_concentration_2": 0.00088}, {"library": "lib1", "antibody_sample_1": "thaw-2_279C_0.014_1", "antibody_sample_2": "thaw-2_279C_0.00088_2", "r2": 0.0004925019828934249, "no-antibody_sample_1": "thaw-2_no-antibody_control_1", "antibody_concentration_1": 0.014, "no-antibody_sample_2": "thaw-2_no-antibody_control_2", "antibody_concentration_2": 0.00088}, {"library": "lib1", "antibody_sample_1": "thaw-2_279C_0.014_2", "antibody_sample_2": "thaw-2_279C_0.00088_2", "r2": 0.002642037186319544, "no-antibody_sample_1": "thaw-2_no-antibody_control_2", "antibody_concentration_1": 0.014, "no-antibody_sample_2": "thaw-2_no-antibody_control_2", "antibody_concentration_2": 0.00088}, {"library": "lib1", "antibody_sample_1": "thaw-1_REGN10933_0.037_1", "antibody_sample_2": "thaw-2_279C_0.0035_1", "r2": 0.004982529901616488, "no-antibody_sample_1": "thaw-1_no-antibody_control_1", "antibody_concentration_1": 0.037, "no-antibody_sample_2": "thaw-2_no-antibody_control_1", "antibody_concentration_2": 0.0035}, {"library": "lib1", "antibody_sample_1": "thaw-1_REGN10933_0.15_1", "antibody_sample_2": "thaw-2_279C_0.0035_1", "r2": 0.0015017840366661082, "no-antibody_sample_1": "thaw-1_no-antibody_control_1", "antibody_concentration_1": 0.15, "no-antibody_sample_2": "thaw-2_no-antibody_control_1", "antibody_concentration_2": 0.0035}, {"library": "lib1", "antibody_sample_1": "thaw-1_REGN10933_0.15_2", "antibody_sample_2": "thaw-2_279C_0.0035_1", "r2": 0.0006745083621130504, "no-antibody_sample_1": "thaw-1_no-antibody_control_2", "antibody_concentration_1": 0.15, "no-antibody_sample_2": "thaw-2_no-antibody_control_1", "antibody_concentration_2": 0.0035}, {"library": "lib1", "antibody_sample_1": "thaw-1_REGN10933_0.59_1", "antibody_sample_2": "thaw-2_279C_0.0035_1", "r2": 4.20577983526092e-05, "no-antibody_sample_1": "thaw-1_no-antibody_control_1", "antibody_concentration_1": 0.59, "no-antibody_sample_2": "thaw-2_no-antibody_control_1", "antibody_concentration_2": 0.0035}, {"library": "lib1", "antibody_sample_1": "thaw-1_REGN10933_0.59_2", "antibody_sample_2": "thaw-2_279C_0.0035_1", "r2": 0.0001938837890007351, "no-antibody_sample_1": "thaw-1_no-antibody_control_2", "antibody_concentration_1": 0.59, "no-antibody_sample_2": "thaw-2_no-antibody_control_1", "antibody_concentration_2": 0.0035}, {"library": "lib1", "antibody_sample_1": "thaw-2_279C_0.00088_1", "antibody_sample_2": "thaw-2_279C_0.0035_1", "r2": 0.14399260145534495, "no-antibody_sample_1": "thaw-2_no-antibody_control_1", "antibody_concentration_1": 0.00088, "no-antibody_sample_2": "thaw-2_no-antibody_control_1", "antibody_concentration_2": 0.0035}, {"library": "lib1", "antibody_sample_1": "thaw-2_279C_0.00088_2", "antibody_sample_2": "thaw-2_279C_0.0035_1", "r2": 0.009535307128808899, "no-antibody_sample_1": "thaw-2_no-antibody_control_2", "antibody_concentration_1": 0.00088, "no-antibody_sample_2": "thaw-2_no-antibody_control_1", "antibody_concentration_2": 0.0035}, {"library": "lib1", "antibody_sample_1": "thaw-2_279C_0.0035_1", "antibody_sample_2": "thaw-2_279C_0.0035_1", "r2": 1.0, "no-antibody_sample_1": "thaw-2_no-antibody_control_1", "antibody_concentration_1": 0.0035, "no-antibody_sample_2": "thaw-2_no-antibody_control_1", "antibody_concentration_2": 0.0035}, {"library": "lib1", "antibody_sample_1": "thaw-2_279C_0.0035_2", "antibody_sample_2": "thaw-2_279C_0.0035_1", "r2": 0.00927713788839691, "no-antibody_sample_1": "thaw-2_no-antibody_control_2", "antibody_concentration_1": 0.0035, "no-antibody_sample_2": "thaw-2_no-antibody_control_1", "antibody_concentration_2": 0.0035}, {"library": "lib1", "antibody_sample_1": "thaw-2_279C_0.014_1", "antibody_sample_2": "thaw-2_279C_0.0035_1", "r2": 0.013539891824003026, "no-antibody_sample_1": "thaw-2_no-antibody_control_1", "antibody_concentration_1": 0.014, "no-antibody_sample_2": "thaw-2_no-antibody_control_1", "antibody_concentration_2": 0.0035}, {"library": "lib1", "antibody_sample_1": "thaw-2_279C_0.014_2", "antibody_sample_2": "thaw-2_279C_0.0035_1", "r2": 0.00030461903413371534, "no-antibody_sample_1": "thaw-2_no-antibody_control_2", "antibody_concentration_1": 0.014, "no-antibody_sample_2": "thaw-2_no-antibody_control_1", "antibody_concentration_2": 0.0035}, {"library": "lib1", "antibody_sample_1": "thaw-1_REGN10933_0.037_1", "antibody_sample_2": "thaw-2_279C_0.0035_2", "r2": 0.0008119386229944919, "no-antibody_sample_1": "thaw-1_no-antibody_control_1", "antibody_concentration_1": 0.037, "no-antibody_sample_2": "thaw-2_no-antibody_control_2", "antibody_concentration_2": 0.0035}, {"library": "lib1", "antibody_sample_1": "thaw-1_REGN10933_0.15_1", "antibody_sample_2": "thaw-2_279C_0.0035_2", "r2": 0.00028912556957744347, "no-antibody_sample_1": "thaw-1_no-antibody_control_1", "antibody_concentration_1": 0.15, "no-antibody_sample_2": "thaw-2_no-antibody_control_2", "antibody_concentration_2": 0.0035}, {"library": "lib1", "antibody_sample_1": "thaw-1_REGN10933_0.15_2", "antibody_sample_2": "thaw-2_279C_0.0035_2", "r2": 0.00010460763766107928, "no-antibody_sample_1": "thaw-1_no-antibody_control_2", "antibody_concentration_1": 0.15, "no-antibody_sample_2": "thaw-2_no-antibody_control_2", "antibody_concentration_2": 0.0035}, {"library": "lib1", "antibody_sample_1": "thaw-1_REGN10933_0.59_1", "antibody_sample_2": "thaw-2_279C_0.0035_2", "r2": 0.0003425950781871228, "no-antibody_sample_1": "thaw-1_no-antibody_control_1", "antibody_concentration_1": 0.59, "no-antibody_sample_2": "thaw-2_no-antibody_control_2", "antibody_concentration_2": 0.0035}, {"library": "lib1", "antibody_sample_1": "thaw-1_REGN10933_0.59_2", "antibody_sample_2": "thaw-2_279C_0.0035_2", "r2": 0.00017538237121351262, "no-antibody_sample_1": "thaw-1_no-antibody_control_2", "antibody_concentration_1": 0.59, "no-antibody_sample_2": "thaw-2_no-antibody_control_2", "antibody_concentration_2": 0.0035}, {"library": "lib1", "antibody_sample_1": "thaw-2_279C_0.00088_1", "antibody_sample_2": "thaw-2_279C_0.0035_2", "r2": 0.015083327762681883, "no-antibody_sample_1": "thaw-2_no-antibody_control_1", "antibody_concentration_1": 0.00088, "no-antibody_sample_2": "thaw-2_no-antibody_control_2", "antibody_concentration_2": 0.0035}, {"library": "lib1", "antibody_sample_1": "thaw-2_279C_0.00088_2", "antibody_sample_2": "thaw-2_279C_0.0035_2", "r2": 0.14111160753954377, "no-antibody_sample_1": "thaw-2_no-antibody_control_2", "antibody_concentration_1": 0.00088, "no-antibody_sample_2": "thaw-2_no-antibody_control_2", "antibody_concentration_2": 0.0035}, {"library": "lib1", "antibody_sample_1": "thaw-2_279C_0.0035_1", "antibody_sample_2": "thaw-2_279C_0.0035_2", "r2": 0.00927713788839691, "no-antibody_sample_1": "thaw-2_no-antibody_control_1", "antibody_concentration_1": 0.0035, "no-antibody_sample_2": "thaw-2_no-antibody_control_2", "antibody_concentration_2": 0.0035}, {"library": "lib1", "antibody_sample_1": "thaw-2_279C_0.0035_2", "antibody_sample_2": "thaw-2_279C_0.0035_2", "r2": 1.0, "no-antibody_sample_1": "thaw-2_no-antibody_control_2", "antibody_concentration_1": 0.0035, "no-antibody_sample_2": "thaw-2_no-antibody_control_2", "antibody_concentration_2": 0.0035}, {"library": "lib1", "antibody_sample_1": "thaw-2_279C_0.014_1", "antibody_sample_2": "thaw-2_279C_0.0035_2", "r2": 0.00033976672289941527, "no-antibody_sample_1": "thaw-2_no-antibody_control_1", "antibody_concentration_1": 0.014, "no-antibody_sample_2": "thaw-2_no-antibody_control_2", "antibody_concentration_2": 0.0035}, {"library": "lib1", "antibody_sample_1": "thaw-2_279C_0.014_2", "antibody_sample_2": "thaw-2_279C_0.0035_2", "r2": 0.010471809521823465, "no-antibody_sample_1": "thaw-2_no-antibody_control_2", "antibody_concentration_1": 0.014, "no-antibody_sample_2": "thaw-2_no-antibody_control_2", "antibody_concentration_2": 0.0035}, {"library": "lib1", "antibody_sample_1": "thaw-1_REGN10933_0.037_1", "antibody_sample_2": "thaw-2_279C_0.014_1", "r2": 3.0161103905594318e-05, "no-antibody_sample_1": "thaw-1_no-antibody_control_1", "antibody_concentration_1": 0.037, "no-antibody_sample_2": "thaw-2_no-antibody_control_1", "antibody_concentration_2": 0.014}, {"library": "lib1", "antibody_sample_1": "thaw-1_REGN10933_0.15_1", "antibody_sample_2": "thaw-2_279C_0.014_1", "r2": 0.008513267778456122, "no-antibody_sample_1": "thaw-1_no-antibody_control_1", "antibody_concentration_1": 0.15, "no-antibody_sample_2": "thaw-2_no-antibody_control_1", "antibody_concentration_2": 0.014}, {"library": "lib1", "antibody_sample_1": "thaw-1_REGN10933_0.15_2", "antibody_sample_2": "thaw-2_279C_0.014_1", "r2": 0.01236525394897094, "no-antibody_sample_1": "thaw-1_no-antibody_control_2", "antibody_concentration_1": 0.15, "no-antibody_sample_2": "thaw-2_no-antibody_control_1", "antibody_concentration_2": 0.014}, {"library": "lib1", "antibody_sample_1": "thaw-1_REGN10933_0.59_1", "antibody_sample_2": "thaw-2_279C_0.014_1", "r2": 0.021028091257975192, "no-antibody_sample_1": "thaw-1_no-antibody_control_1", "antibody_concentration_1": 0.59, "no-antibody_sample_2": "thaw-2_no-antibody_control_1", "antibody_concentration_2": 0.014}, {"library": "lib1", "antibody_sample_1": "thaw-1_REGN10933_0.59_2", "antibody_sample_2": "thaw-2_279C_0.014_1", "r2": 0.022157761046978402, "no-antibody_sample_1": "thaw-1_no-antibody_control_2", "antibody_concentration_1": 0.59, "no-antibody_sample_2": "thaw-2_no-antibody_control_1", "antibody_concentration_2": 0.014}, {"library": "lib1", "antibody_sample_1": "thaw-2_279C_0.00088_1", "antibody_sample_2": "thaw-2_279C_0.014_1", "r2": 0.003865173205946342, "no-antibody_sample_1": "thaw-2_no-antibody_control_1", "antibody_concentration_1": 0.00088, "no-antibody_sample_2": "thaw-2_no-antibody_control_1", "antibody_concentration_2": 0.014}, {"library": "lib1", "antibody_sample_1": "thaw-2_279C_0.00088_2", "antibody_sample_2": "thaw-2_279C_0.014_1", "r2": 0.0004925019828934249, "no-antibody_sample_1": "thaw-2_no-antibody_control_2", "antibody_concentration_1": 0.00088, "no-antibody_sample_2": "thaw-2_no-antibody_control_1", "antibody_concentration_2": 0.014}, {"library": "lib1", "antibody_sample_1": "thaw-2_279C_0.0035_1", "antibody_sample_2": "thaw-2_279C_0.014_1", "r2": 0.013539891824003026, "no-antibody_sample_1": "thaw-2_no-antibody_control_1", "antibody_concentration_1": 0.0035, "no-antibody_sample_2": "thaw-2_no-antibody_control_1", "antibody_concentration_2": 0.014}, {"library": "lib1", "antibody_sample_1": "thaw-2_279C_0.0035_2", "antibody_sample_2": "thaw-2_279C_0.014_1", "r2": 0.00033976672289941527, "no-antibody_sample_1": "thaw-2_no-antibody_control_2", "antibody_concentration_1": 0.0035, "no-antibody_sample_2": "thaw-2_no-antibody_control_1", "antibody_concentration_2": 0.014}, {"library": "lib1", "antibody_sample_1": "thaw-2_279C_0.014_1", "antibody_sample_2": "thaw-2_279C_0.014_1", "r2": 1.0, "no-antibody_sample_1": "thaw-2_no-antibody_control_1", "antibody_concentration_1": 0.014, "no-antibody_sample_2": "thaw-2_no-antibody_control_1", "antibody_concentration_2": 0.014}, {"library": "lib1", "antibody_sample_1": "thaw-2_279C_0.014_2", "antibody_sample_2": "thaw-2_279C_0.014_1", "r2": 0.04076725177696074, "no-antibody_sample_1": "thaw-2_no-antibody_control_2", "antibody_concentration_1": 0.014, "no-antibody_sample_2": "thaw-2_no-antibody_control_1", "antibody_concentration_2": 0.014}, {"library": "lib1", "antibody_sample_1": "thaw-1_REGN10933_0.037_1", "antibody_sample_2": "thaw-2_279C_0.014_2", "r2": 0.00026754114194578547, "no-antibody_sample_1": "thaw-1_no-antibody_control_1", "antibody_concentration_1": 0.037, "no-antibody_sample_2": "thaw-2_no-antibody_control_2", "antibody_concentration_2": 0.014}, {"library": "lib1", "antibody_sample_1": "thaw-1_REGN10933_0.15_1", "antibody_sample_2": "thaw-2_279C_0.014_2", "r2": 0.007630502561114511, "no-antibody_sample_1": "thaw-1_no-antibody_control_1", "antibody_concentration_1": 0.15, "no-antibody_sample_2": "thaw-2_no-antibody_control_2", "antibody_concentration_2": 0.014}, {"library": "lib1", "antibody_sample_1": "thaw-1_REGN10933_0.15_2", "antibody_sample_2": "thaw-2_279C_0.014_2", "r2": 0.0038098053213595348, "no-antibody_sample_1": "thaw-1_no-antibody_control_2", "antibody_concentration_1": 0.15, "no-antibody_sample_2": "thaw-2_no-antibody_control_2", "antibody_concentration_2": 0.014}, {"library": "lib1", "antibody_sample_1": "thaw-1_REGN10933_0.59_1", "antibody_sample_2": "thaw-2_279C_0.014_2", "r2": 0.0216975347191963, "no-antibody_sample_1": "thaw-1_no-antibody_control_1", "antibody_concentration_1": 0.59, "no-antibody_sample_2": "thaw-2_no-antibody_control_2", "antibody_concentration_2": 0.014}, {"library": "lib1", "antibody_sample_1": "thaw-1_REGN10933_0.59_2", "antibody_sample_2": "thaw-2_279C_0.014_2", "r2": 0.022050984965314994, "no-antibody_sample_1": "thaw-1_no-antibody_control_2", "antibody_concentration_1": 0.59, "no-antibody_sample_2": "thaw-2_no-antibody_control_2", "antibody_concentration_2": 0.014}, {"library": "lib1", "antibody_sample_1": "thaw-2_279C_0.00088_1", "antibody_sample_2": "thaw-2_279C_0.014_2", "r2": 2.3945995436614e-06, "no-antibody_sample_1": "thaw-2_no-antibody_control_1", "antibody_concentration_1": 0.00088, "no-antibody_sample_2": "thaw-2_no-antibody_control_2", "antibody_concentration_2": 0.014}, {"library": "lib1", "antibody_sample_1": "thaw-2_279C_0.00088_2", "antibody_sample_2": "thaw-2_279C_0.014_2", "r2": 0.002642037186319544, "no-antibody_sample_1": "thaw-2_no-antibody_control_2", "antibody_concentration_1": 0.00088, "no-antibody_sample_2": "thaw-2_no-antibody_control_2", "antibody_concentration_2": 0.014}, {"library": "lib1", "antibody_sample_1": "thaw-2_279C_0.0035_1", "antibody_sample_2": "thaw-2_279C_0.014_2", "r2": 0.00030461903413371534, "no-antibody_sample_1": "thaw-2_no-antibody_control_1", "antibody_concentration_1": 0.0035, "no-antibody_sample_2": "thaw-2_no-antibody_control_2", "antibody_concentration_2": 0.014}, {"library": "lib1", "antibody_sample_1": "thaw-2_279C_0.0035_2", "antibody_sample_2": "thaw-2_279C_0.014_2", "r2": 0.010471809521823465, "no-antibody_sample_1": "thaw-2_no-antibody_control_2", "antibody_concentration_1": 0.0035, "no-antibody_sample_2": "thaw-2_no-antibody_control_2", "antibody_concentration_2": 0.014}, {"library": "lib1", "antibody_sample_1": "thaw-2_279C_0.014_1", "antibody_sample_2": "thaw-2_279C_0.014_2", "r2": 0.04076725177696074, "no-antibody_sample_1": "thaw-2_no-antibody_control_1", "antibody_concentration_1": 0.014, "no-antibody_sample_2": "thaw-2_no-antibody_control_2", "antibody_concentration_2": 0.014}, {"library": "lib1", "antibody_sample_1": "thaw-2_279C_0.014_2", "antibody_sample_2": "thaw-2_279C_0.014_2", "r2": 1.0, "no-antibody_sample_1": "thaw-2_no-antibody_control_2", "antibody_concentration_1": 0.014, "no-antibody_sample_2": "thaw-2_no-antibody_control_2", "antibody_concentration_2": 0.014}]}}, {"mode": "vega-lite"});
</script></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<div id="altair-viz-0824c22158084cdf91edda03aebe17f7"></div>
<script type="text/javascript">
  var VEGA_DEBUG = (typeof VEGA_DEBUG == "undefined") ? {} : VEGA_DEBUG;
  (function(spec, embedOpt){
    let outputDiv = document.currentScript.previousElementSibling;
    if (outputDiv.id !== "altair-viz-0824c22158084cdf91edda03aebe17f7") {
      outputDiv = document.getElementById("altair-viz-0824c22158084cdf91edda03aebe17f7");
    }
    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm/vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm/vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm/vega-lite@5.6.1?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm/vega-embed@6?noext",
    };

    function maybeLoadScript(lib, version) {
      var key = `${lib.replace("-", "")}_version`;
      return (VEGA_DEBUG[key] == version) ?
        Promise.resolve(paths[lib]) :
        new Promise(function(resolve, reject) {
          var s = document.createElement('script');
          document.getElementsByTagName("head")[0].appendChild(s);
          s.async = true;
          s.onload = () => {
            VEGA_DEBUG[key] = version;
            return resolve(paths[lib]);
          };
          s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
          s.src = paths[lib];
        });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      require(["vega-embed"], displayChart, err => showError(`Error loading script: ${err.message}`));
    } else {
      maybeLoadScript("vega", "5")
        .then(() => maybeLoadScript("vega-lite", "5.6.1"))
        .then(() => maybeLoadScript("vega-embed", "6"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"config": {"view": {"continuousWidth": 300, "continuousHeight": 300}, "axis": {"labelLimit": 500}}, "data": {"name": "data-7b42723832ad1522ab406a4dcdc5ff11"}, "mark": {"type": "rect", "stroke": "black"}, "encoding": {"color": {"field": "r2", "scale": {"zero": true}, "type": "quantitative"}, "tooltip": [{"field": "library", "type": "nominal"}, {"field": "antibody_sample_1", "type": "nominal"}, {"field": "antibody_sample_2", "type": "nominal"}, {"field": "r2", "format": ".3g", "type": "quantitative"}, {"field": "no-antibody_sample_1", "type": "nominal"}, {"field": "antibody_concentration_1", "format": ".3g", "type": "quantitative"}, {"field": "no-antibody_sample_2", "type": "nominal"}, {"field": "antibody_concentration_2", "format": ".3g", "type": "quantitative"}], "x": {"field": "antibody_sample_1", "title": null, "type": "nominal"}, "y": {"field": "antibody_sample_2", "title": null, "type": "nominal"}}, "height": {"step": 15}, "title": "lib2", "width": {"step": 15}, "$schema": "https://vega.github.io/schema/vega-lite/v5.6.1.json", "datasets": {"data-7b42723832ad1522ab406a4dcdc5ff11": [{"library": "lib2", "antibody_sample_1": "thaw-1_REGN10933_0.037_1", "antibody_sample_2": "thaw-1_REGN10933_0.037_1", "r2": 1.0, "no-antibody_sample_1": "thaw-1_no-antibody_control_1", "antibody_concentration_1": 0.037, "no-antibody_sample_2": "thaw-1_no-antibody_control_1", "antibody_concentration_2": 0.037}, {"library": "lib2", "antibody_sample_1": "thaw-1_REGN10933_0.037_2", "antibody_sample_2": "thaw-1_REGN10933_0.037_1", "r2": 0.0016704228973551426, "no-antibody_sample_1": "thaw-1_no-antibody_control_2", "antibody_concentration_1": 0.037, "no-antibody_sample_2": "thaw-1_no-antibody_control_1", "antibody_concentration_2": 0.037}, {"library": "lib2", "antibody_sample_1": "thaw-1_REGN10933_0.15_1", "antibody_sample_2": "thaw-1_REGN10933_0.037_1", "r2": 0.09758399679523468, "no-antibody_sample_1": "thaw-1_no-antibody_control_1", "antibody_concentration_1": 0.15, "no-antibody_sample_2": "thaw-1_no-antibody_control_1", "antibody_concentration_2": 0.037}, {"library": "lib2", "antibody_sample_1": "thaw-1_REGN10933_0.15_2", "antibody_sample_2": "thaw-1_REGN10933_0.037_1", "r2": 0.0035660060127626516, "no-antibody_sample_1": "thaw-1_no-antibody_control_2", "antibody_concentration_1": 0.15, "no-antibody_sample_2": "thaw-1_no-antibody_control_1", "antibody_concentration_2": 0.037}, {"library": "lib2", "antibody_sample_1": "thaw-1_REGN10933_0.59_1", "antibody_sample_2": "thaw-1_REGN10933_0.037_1", "r2": 0.03324097724378673, "no-antibody_sample_1": "thaw-1_no-antibody_control_1", "antibody_concentration_1": 0.59, "no-antibody_sample_2": "thaw-1_no-antibody_control_1", "antibody_concentration_2": 0.037}, {"library": "lib2", "antibody_sample_1": "thaw-1_REGN10933_0.59_2", "antibody_sample_2": "thaw-1_REGN10933_0.037_1", "r2": 0.0009316475807050236, "no-antibody_sample_1": "thaw-1_no-antibody_control_2", "antibody_concentration_1": 0.59, "no-antibody_sample_2": "thaw-1_no-antibody_control_1", "antibody_concentration_2": 0.037}, {"library": "lib2", "antibody_sample_1": "thaw-1_REGN10933_0.037_1", "antibody_sample_2": "thaw-1_REGN10933_0.037_2", "r2": 0.0016704228973551426, "no-antibody_sample_1": "thaw-1_no-antibody_control_1", "antibody_concentration_1": 0.037, "no-antibody_sample_2": "thaw-1_no-antibody_control_2", "antibody_concentration_2": 0.037}, {"library": "lib2", "antibody_sample_1": "thaw-1_REGN10933_0.037_2", "antibody_sample_2": "thaw-1_REGN10933_0.037_2", "r2": 1.0, "no-antibody_sample_1": "thaw-1_no-antibody_control_2", "antibody_concentration_1": 0.037, "no-antibody_sample_2": "thaw-1_no-antibody_control_2", "antibody_concentration_2": 0.037}, {"library": "lib2", "antibody_sample_1": "thaw-1_REGN10933_0.15_1", "antibody_sample_2": "thaw-1_REGN10933_0.037_2", "r2": 0.001129041335630099, "no-antibody_sample_1": "thaw-1_no-antibody_control_1", "antibody_concentration_1": 0.15, "no-antibody_sample_2": "thaw-1_no-antibody_control_2", "antibody_concentration_2": 0.037}, {"library": "lib2", "antibody_sample_1": "thaw-1_REGN10933_0.15_2", "antibody_sample_2": "thaw-1_REGN10933_0.037_2", "r2": 0.012907111959176194, "no-antibody_sample_1": "thaw-1_no-antibody_control_2", "antibody_concentration_1": 0.15, "no-antibody_sample_2": "thaw-1_no-antibody_control_2", "antibody_concentration_2": 0.037}, {"library": "lib2", "antibody_sample_1": "thaw-1_REGN10933_0.59_1", "antibody_sample_2": "thaw-1_REGN10933_0.037_2", "r2": 0.0035651215846707962, "no-antibody_sample_1": "thaw-1_no-antibody_control_1", "antibody_concentration_1": 0.59, "no-antibody_sample_2": "thaw-1_no-antibody_control_2", "antibody_concentration_2": 0.037}, {"library": "lib2", "antibody_sample_1": "thaw-1_REGN10933_0.59_2", "antibody_sample_2": "thaw-1_REGN10933_0.037_2", "r2": 0.00472318566166516, "no-antibody_sample_1": "thaw-1_no-antibody_control_2", "antibody_concentration_1": 0.59, "no-antibody_sample_2": "thaw-1_no-antibody_control_2", "antibody_concentration_2": 0.037}, {"library": "lib2", "antibody_sample_1": "thaw-1_REGN10933_0.037_1", "antibody_sample_2": "thaw-1_REGN10933_0.15_1", "r2": 0.09758399679523468, "no-antibody_sample_1": "thaw-1_no-antibody_control_1", "antibody_concentration_1": 0.037, "no-antibody_sample_2": "thaw-1_no-antibody_control_1", "antibody_concentration_2": 0.15}, {"library": "lib2", "antibody_sample_1": "thaw-1_REGN10933_0.037_2", "antibody_sample_2": "thaw-1_REGN10933_0.15_1", "r2": 0.001129041335630099, "no-antibody_sample_1": "thaw-1_no-antibody_control_2", "antibody_concentration_1": 0.037, "no-antibody_sample_2": "thaw-1_no-antibody_control_1", "antibody_concentration_2": 0.15}, {"library": "lib2", "antibody_sample_1": "thaw-1_REGN10933_0.15_1", "antibody_sample_2": "thaw-1_REGN10933_0.15_1", "r2": 1.0, "no-antibody_sample_1": "thaw-1_no-antibody_control_1", "antibody_concentration_1": 0.15, "no-antibody_sample_2": "thaw-1_no-antibody_control_1", "antibody_concentration_2": 0.15}, {"library": "lib2", "antibody_sample_1": "thaw-1_REGN10933_0.15_2", "antibody_sample_2": "thaw-1_REGN10933_0.15_1", "r2": 0.019030508968818523, "no-antibody_sample_1": "thaw-1_no-antibody_control_2", "antibody_concentration_1": 0.15, "no-antibody_sample_2": "thaw-1_no-antibody_control_1", "antibody_concentration_2": 0.15}, {"library": "lib2", "antibody_sample_1": "thaw-1_REGN10933_0.59_1", "antibody_sample_2": "thaw-1_REGN10933_0.15_1", "r2": 0.07044554757985061, "no-antibody_sample_1": "thaw-1_no-antibody_control_1", "antibody_concentration_1": 0.59, "no-antibody_sample_2": "thaw-1_no-antibody_control_1", "antibody_concentration_2": 0.15}, {"library": "lib2", "antibody_sample_1": "thaw-1_REGN10933_0.59_2", "antibody_sample_2": "thaw-1_REGN10933_0.15_1", "r2": 0.019062445655725062, "no-antibody_sample_1": "thaw-1_no-antibody_control_2", "antibody_concentration_1": 0.59, "no-antibody_sample_2": "thaw-1_no-antibody_control_1", "antibody_concentration_2": 0.15}, {"library": "lib2", "antibody_sample_1": "thaw-1_REGN10933_0.037_1", "antibody_sample_2": "thaw-1_REGN10933_0.15_2", "r2": 0.0035660060127626516, "no-antibody_sample_1": "thaw-1_no-antibody_control_1", "antibody_concentration_1": 0.037, "no-antibody_sample_2": "thaw-1_no-antibody_control_2", "antibody_concentration_2": 0.15}, {"library": "lib2", "antibody_sample_1": "thaw-1_REGN10933_0.037_2", "antibody_sample_2": "thaw-1_REGN10933_0.15_2", "r2": 0.012907111959176194, "no-antibody_sample_1": "thaw-1_no-antibody_control_2", "antibody_concentration_1": 0.037, "no-antibody_sample_2": "thaw-1_no-antibody_control_2", "antibody_concentration_2": 0.15}, {"library": "lib2", "antibody_sample_1": "thaw-1_REGN10933_0.15_1", "antibody_sample_2": "thaw-1_REGN10933_0.15_2", "r2": 0.019030508968818523, "no-antibody_sample_1": "thaw-1_no-antibody_control_1", "antibody_concentration_1": 0.15, "no-antibody_sample_2": "thaw-1_no-antibody_control_2", "antibody_concentration_2": 0.15}, {"library": "lib2", "antibody_sample_1": "thaw-1_REGN10933_0.15_2", "antibody_sample_2": "thaw-1_REGN10933_0.15_2", "r2": 1.0, "no-antibody_sample_1": "thaw-1_no-antibody_control_2", "antibody_concentration_1": 0.15, "no-antibody_sample_2": "thaw-1_no-antibody_control_2", "antibody_concentration_2": 0.15}, {"library": "lib2", "antibody_sample_1": "thaw-1_REGN10933_0.59_1", "antibody_sample_2": "thaw-1_REGN10933_0.15_2", "r2": 0.033758356850870676, "no-antibody_sample_1": "thaw-1_no-antibody_control_1", "antibody_concentration_1": 0.59, "no-antibody_sample_2": "thaw-1_no-antibody_control_2", "antibody_concentration_2": 0.15}, {"library": "lib2", "antibody_sample_1": "thaw-1_REGN10933_0.59_2", "antibody_sample_2": "thaw-1_REGN10933_0.15_2", "r2": 0.07806292912782932, "no-antibody_sample_1": "thaw-1_no-antibody_control_2", "antibody_concentration_1": 0.59, "no-antibody_sample_2": "thaw-1_no-antibody_control_2", "antibody_concentration_2": 0.15}, {"library": "lib2", "antibody_sample_1": "thaw-1_REGN10933_0.037_1", "antibody_sample_2": "thaw-1_REGN10933_0.59_1", "r2": 0.03324097724378673, "no-antibody_sample_1": "thaw-1_no-antibody_control_1", "antibody_concentration_1": 0.037, "no-antibody_sample_2": "thaw-1_no-antibody_control_1", "antibody_concentration_2": 0.59}, {"library": "lib2", "antibody_sample_1": "thaw-1_REGN10933_0.037_2", "antibody_sample_2": "thaw-1_REGN10933_0.59_1", "r2": 0.0035651215846707962, "no-antibody_sample_1": "thaw-1_no-antibody_control_2", "antibody_concentration_1": 0.037, "no-antibody_sample_2": "thaw-1_no-antibody_control_1", "antibody_concentration_2": 0.59}, {"library": "lib2", "antibody_sample_1": "thaw-1_REGN10933_0.15_1", "antibody_sample_2": "thaw-1_REGN10933_0.59_1", "r2": 0.07044554757985061, "no-antibody_sample_1": "thaw-1_no-antibody_control_1", "antibody_concentration_1": 0.15, "no-antibody_sample_2": "thaw-1_no-antibody_control_1", "antibody_concentration_2": 0.59}, {"library": "lib2", "antibody_sample_1": "thaw-1_REGN10933_0.15_2", "antibody_sample_2": "thaw-1_REGN10933_0.59_1", "r2": 0.033758356850870676, "no-antibody_sample_1": "thaw-1_no-antibody_control_2", "antibody_concentration_1": 0.15, "no-antibody_sample_2": "thaw-1_no-antibody_control_1", "antibody_concentration_2": 0.59}, {"library": "lib2", "antibody_sample_1": "thaw-1_REGN10933_0.59_1", "antibody_sample_2": "thaw-1_REGN10933_0.59_1", "r2": 1.0, "no-antibody_sample_1": "thaw-1_no-antibody_control_1", "antibody_concentration_1": 0.59, "no-antibody_sample_2": "thaw-1_no-antibody_control_1", "antibody_concentration_2": 0.59}, {"library": "lib2", "antibody_sample_1": "thaw-1_REGN10933_0.59_2", "antibody_sample_2": "thaw-1_REGN10933_0.59_1", "r2": 0.08667426819195391, "no-antibody_sample_1": "thaw-1_no-antibody_control_2", "antibody_concentration_1": 0.59, "no-antibody_sample_2": "thaw-1_no-antibody_control_1", "antibody_concentration_2": 0.59}, {"library": "lib2", "antibody_sample_1": "thaw-1_REGN10933_0.037_1", "antibody_sample_2": "thaw-1_REGN10933_0.59_2", "r2": 0.0009316475807050236, "no-antibody_sample_1": "thaw-1_no-antibody_control_1", "antibody_concentration_1": 0.037, "no-antibody_sample_2": "thaw-1_no-antibody_control_2", "antibody_concentration_2": 0.59}, {"library": "lib2", "antibody_sample_1": "thaw-1_REGN10933_0.037_2", "antibody_sample_2": "thaw-1_REGN10933_0.59_2", "r2": 0.00472318566166516, "no-antibody_sample_1": "thaw-1_no-antibody_control_2", "antibody_concentration_1": 0.037, "no-antibody_sample_2": "thaw-1_no-antibody_control_2", "antibody_concentration_2": 0.59}, {"library": "lib2", "antibody_sample_1": "thaw-1_REGN10933_0.15_1", "antibody_sample_2": "thaw-1_REGN10933_0.59_2", "r2": 0.019062445655725062, "no-antibody_sample_1": "thaw-1_no-antibody_control_1", "antibody_concentration_1": 0.15, "no-antibody_sample_2": "thaw-1_no-antibody_control_2", "antibody_concentration_2": 0.59}, {"library": "lib2", "antibody_sample_1": "thaw-1_REGN10933_0.15_2", "antibody_sample_2": "thaw-1_REGN10933_0.59_2", "r2": 0.07806292912782932, "no-antibody_sample_1": "thaw-1_no-antibody_control_2", "antibody_concentration_1": 0.15, "no-antibody_sample_2": "thaw-1_no-antibody_control_2", "antibody_concentration_2": 0.59}, {"library": "lib2", "antibody_sample_1": "thaw-1_REGN10933_0.59_1", "antibody_sample_2": "thaw-1_REGN10933_0.59_2", "r2": 0.08667426819195391, "no-antibody_sample_1": "thaw-1_no-antibody_control_1", "antibody_concentration_1": 0.59, "no-antibody_sample_2": "thaw-1_no-antibody_control_2", "antibody_concentration_2": 0.59}, {"library": "lib2", "antibody_sample_1": "thaw-1_REGN10933_0.59_2", "antibody_sample_2": "thaw-1_REGN10933_0.59_2", "r2": 1.0, "no-antibody_sample_1": "thaw-1_no-antibody_control_2", "antibody_concentration_1": 0.59, "no-antibody_sample_2": "thaw-1_no-antibody_control_2", "antibody_concentration_2": 0.59}]}}, {"mode": "vega-lite"});
</script></div>
</div>
</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<p class="logo">
  <a href="index.html">
    <img class="logo" src="_static/BloomLogo.jpg" alt="Logo" />
    
    <h1 class="logo logo-name">dms_variants</h1>
    
  </a>
</p>



<p class="blurb">Analyze deep mutational scanning of barcoded variants</p>




<p>
<iframe src="https://ghbtns.com/github-btn.html?user=jbloomlab&repo=dms_variants&type=watch&count=true&size=large&v=2"
  allowtransparency="true" frameborder="0" scrolling="0" width="200px" height="35px"></iframe>
</p>





<h3>Navigation</h3>
<ul>
<li class="toctree-l1"><a class="reference internal" href="index.html">dms_variants documentation</a></li>
</ul>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="examples.html">Examples</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="codonvariant_sim_data.html">Analyze simulated library of codon variants</a></li>
<li class="toctree-l2"><a class="reference internal" href="codonvariant_sim_data_w_gaps.html">Variants with deletion mutations</a></li>
<li class="toctree-l2"><a class="reference internal" href="codonvariant_sim_data_multi_targets.html">Libraries with secondary target genes</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Compute probabilities of escape</a></li>
<li class="toctree-l2"><a class="reference internal" href="parsebarcodes_sim_data.html">Parse barcodes</a></li>
<li class="toctree-l2"><a class="reference internal" href="narrow_bottleneck.html">Fitting gobal epistasis models with experimental “noise”</a></li>
<li class="toctree-l2"><a class="reference internal" href="codonvariant_plot_formatting.html">Formatting <code class="docutils literal notranslate"><span class="pre">CodonVariantTable</span></code> plots</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="dms_variants.html">dms_variants package</a></li>
<li class="toctree-l1"><a class="reference internal" href="package_index.html">package index</a></li>
<li class="toctree-l1"><a class="reference internal" href="acknowledgments.html">Acknowledgements</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
  <li><a href="examples.html">Examples</a><ul>
      <li>Previous: <a href="codonvariant_sim_data_multi_targets.html" title="previous chapter">Libraries with secondary target genes</a></li>
      <li>Next: <a href="parsebarcodes_sim_data.html" title="next chapter">Parse barcodes</a></li>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &#169;2019--2024.
      
      |
      Powered by <a href="https://www.sphinx-doc.org/">Sphinx 7.2.6</a>
      &amp; <a href="https://alabaster.readthedocs.io">Alabaster 0.7.16</a>
      
      |
      <a href="_sources/prob_escape.nblink.txt"
          rel="nofollow">Page source</a>
    </div>

    
    <a href="https://github.com/jbloomlab/dms_variants" class="github">
        <img style="position: absolute; top: 0; right: 0; border: 0;" src="https://github.blog/wp-content/uploads/2008/12/forkme_right_darkblue_121621.png" alt="Fork me on GitHub"  class="github"/>
    </a>
    

    
  </body>
</html>